
> enhanced-ado-mcp-server@2.1.0 pretest
> npm run generate-openapi


> enhanced-ado-mcp-server@2.1.0 generate-openapi
> tsx scripts/generate-openapi.ts

â‰¡Æ’ÃœÃ‡ Generating OpenAPI specification...

â‰¡Æ’Ã´Ã¼ Creating output directory: C:\Users\ameliapayne\ADO-Work-Item-MSP\docs\api
â‰¡Æ’Ã´Â¥ Generating OpenAPI 3.0 specification...
Î“Â£Ã´ Generated OpenAPI spec: C:\Users\ameliapayne\ADO-Work-Item-MSP\docs\api\openapi.json

â‰¡Æ’Ã´Âª Generating individual JSON schemas...
Î“Â£Ã´ Generated schema: create-workitem.json
Î“Â£Ã´ Generated schema: assign-copilot.json
Î“Â£Ã´ Generated schema: get-context.json
Î“Â£Ã´ Generated schema: extract-security-links.json
Î“Â£Ã´ Generated schema: query-wiql.json
Î“Â£Ã´ Generated schema: query-odata.json
Î“Â£Ã´ Generated schema: execute-bulk-operations.json
Î“Â£Ã´ Generated schema: link-workitems.json
Î“Â£Ã´ Generated schema: undo-bulk.json
Î“Â£Ã´ Generated schema: undo-forensic.json
Î“Â£Ã´ Generated schema: export-work-items.json
Î“Â£Ã´ Generated schema: analyze-workload.json
Î“Â£Ã´ Generated schema: discover-tools.json
Î“Â£Ã´ Generated schema: analyze-query-handle.json
Î“Â£Ã´ Generated schema: analyze-bulk.json
Î“Â£Ã´ Generated schema: list-handles.json
Î“Â£Ã´ Generated schema: inspect-handle.json
Î“Â£Ã´ Generated schema: get-context-bulk.json
Î“Â£Ã´ Generated schema: get-config.json
Î“Â£Ã´ Generated schema: get-team-members.json
Î“Â£Ã´ Generated schema: get-prompts.json
Î“Â£Ã´ Generated schema: list-agents.json
Î“Â£Ã´ Generated schema: discover-custom-fields.json
Î“Â£Ã´ Generated schema: export-field-schema.json
Î“Â£Ã´ Generated schema: get-pr-diff.json
Î“Â£Ã´ Generated schema: get-pr-comments.json
Î“Â£Ã´ Generated schema: add-pr-comment.json
Î“Â£Ã´ Generated schema index: index.json (27 schemas)

Î“Â£Ã  OpenAPI generation complete!

Generated files:
  - docs/api/openapi.json (27 endpoints)
  - docs/api/schemas/*.json (27 schemas)

Output directory: C:\Users\ameliapayne\ADO-Work-Item-MSP\docs\api

You can now use these files to:
  - Generate API clients
  - Create API documentation
  - Validate requests/responses
  - Import into tools like Swagger UI, Postman, etc.

> enhanced-ado-mcp-server@2.1.0 test
> jest

  console.error
    [2025-12-06T00:27:03.939Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:03.939Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at Object.<anonymous> (test/unit/selection-integration.test.ts:9:1)

  console.error
    [2025-12-06T00:27:04.110Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at Object.<anonymous> (test/unit/selection-integration.test.ts:9:1)

  console.error
    [2025-12-06T00:27:03.914Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:03.914Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at Object.<anonymous> (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:16:1)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:7:1)

  console.error
    [2025-12-06T00:27:04.168Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at Object.<anonymous> (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:16:1)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:7:1)

  console.error
    [2025-12-06T00:27:04.387Z] [INFO] Unified bulk operations on 3 items from query handle qh_b667c58188af08da17fc48c815553ff6

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:92:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:93:55)

  console.error
    [2025-12-06T00:27:04.404Z] [INFO] Actions to perform: comment, assign

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:93:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:93:55)

  console.error
    [2025-12-06T00:27:04.165Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:04.165Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at Object.<anonymous> (src/services/handlers/bulk-operations/bulk-undo-by-query-handle.handler.ts:16:1)
      at Object.<anonymous> (test/integration/bulk-undo-real.test.ts:6:1)

  console.error
    [2025-12-06T00:27:04.443Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at Object.<anonymous> (src/services/handlers/bulk-operations/bulk-undo-by-query-handle.handler.ts:16:1)
      at Object.<anonymous> (test/integration/bulk-undo-real.test.ts:6:1)

  console.error
    [2025-12-06T00:27:04.440Z] [INFO] Unified bulk operations on 2 items from query handle qh_3ed42d9b11c7b26f22b13f6c58561642

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:92:12)
      at Object.<anonymous> (test/unit/selection-integration.test.ts:152:62)

  console.error
    [2025-12-06T00:27:04.553Z] [INFO] Actions to perform: comment

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:93:12)
      at Object.<anonymous> (test/unit/selection-integration.test.ts:152:62)

  console.error
    [2025-12-06T00:27:04.554Z] [ERROR] Unified bulk operations error: {"message":"Cannot read properties of undefined (reading 'enabled')","name":"TypeError","stack":"TypeError: Cannot read properties of undefined (reading 'enabled')\n    at new BatchEnabledWorkItemOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:67:44)\n    at createBatchEnabledOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:377:10)\n    at handleUnifiedBulkOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\unified-bulk-operations.handler.ts:124:57)\n    at Object.<anonymous> (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\test\\unit\\unified-bulk-operations.test.ts:93:55)\n    at Promise.then.completed (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:93:55)

  console.error
    [2025-12-06T00:27:04.566Z] [INFO] Unified bulk operations on 2 items from query handle qh_797980af5ec0957d372934d0f1e8d2ad

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:92:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:125:55)

  console.error
    [2025-12-06T00:27:04.570Z] [INFO] Actions to perform: comment

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:93:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:125:55)

  console.error
    [2025-12-06T00:27:04.573Z] [INFO] [OPTIMIZATION] Pre-fetching 2 work items to cache for all actions

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:106:14)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:125:55)

  console.error
    [2025-12-06T00:27:04.577Z] [INFO] [OPTIMIZATION] Cached 0 work items for reuse across actions (saves 0 fetch operations)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:116:16)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:125:22)

  console.error
    [2025-12-06T00:27:04.581Z] [ERROR] Unified bulk operations error: {"message":"Cannot read properties of undefined (reading 'enabled')","name":"TypeError","stack":"TypeError: Cannot read properties of undefined (reading 'enabled')\n    at new BatchEnabledWorkItemOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:67:44)\n    at createBatchEnabledOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:377:10)\n    at handleUnifiedBulkOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\unified-bulk-operations.handler.ts:124:57)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\test\\unit\\unified-bulk-operations.test.ts:125:22)"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:125:22)

  console.error
    [2025-12-06T00:27:04.587Z] [INFO] Unified bulk operations on 2 items from query handle qh_d615fcb29f4a614d573521e46ec48b8d

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:92:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:159:55)

  console.error
    [2025-12-06T00:27:04.358Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:04.357Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at Object.<anonymous> (src/services/handlers/bulk-operations/bulk-undo-by-query-handle.handler.ts:16:1)
      at Object.<anonymous> (test/unit/bulk-undo.test.ts:6:1)

  console.error
    [2025-12-06T00:27:04.592Z] [INFO] Actions to perform: comment

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:93:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:159:55)

  console.error
    [2025-12-06T00:27:04.594Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at Object.<anonymous> (src/services/handlers/bulk-operations/bulk-undo-by-query-handle.handler.ts:16:1)
      at Object.<anonymous> (test/unit/bulk-undo.test.ts:6:1)

  console.error
    [2025-12-06T00:27:04.597Z] [INFO] [OPTIMIZATION] Pre-fetching 2 work items to cache for all actions

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:106:14)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:159:55)

  console.error
    [2025-12-06T00:27:04.601Z] [INFO] [OPTIMIZATION] Cached 0 work items for reuse across actions (saves 0 fetch operations)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:116:16)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:159:22)

  console.error
    [2025-12-06T00:27:04.604Z] [ERROR] Unified bulk operations error: {"message":"Cannot read properties of undefined (reading 'enabled')","name":"TypeError","stack":"TypeError: Cannot read properties of undefined (reading 'enabled')\n    at new BatchEnabledWorkItemOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:67:44)\n    at createBatchEnabledOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:377:10)\n    at handleUnifiedBulkOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\unified-bulk-operations.handler.ts:124:57)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\test\\unit\\unified-bulk-operations.test.ts:159:22)"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:159:22)

  console.error
    [2025-12-06T00:27:04.609Z] [INFO] Unified bulk operations on 1 items from query handle qh_8239b5a1860a4ca2dc250243ff2682ac

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:92:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:188:55)

  console.error
    [2025-12-06T00:27:04.611Z] [ERROR] Unified bulk operations error: {"message":"Cannot read properties of undefined (reading 'enabled')","name":"TypeError","stack":"TypeError: Cannot read properties of undefined (reading 'enabled')\n    at new BatchEnabledWorkItemOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:67:44)\n    at createBatchEnabledOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:377:10)\n    at handleUnifiedBulkOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\unified-bulk-operations.handler.ts:124:57)\n    at Object.<anonymous> (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\test\\unit\\selection-integration.test.ts:152:62)\n    at Promise.then.completed (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:12)
      at Object.<anonymous> (test/unit/selection-integration.test.ts:152:62)

  console.error
    [2025-12-06T00:27:04.612Z] [INFO] Actions to perform: update

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:93:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:188:55)

  console.error
    [2025-12-06T00:27:04.617Z] [INFO] [OPTIMIZATION] Pre-fetching 1 work items to cache for all actions

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:106:14)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:188:55)

  console.error
    [2025-12-06T00:27:04.621Z] [INFO] [OPTIMIZATION] Cached 0 work items for reuse across actions (saves 0 fetch operations)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:116:16)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:188:22)

  console.error
    [2025-12-06T00:27:04.622Z] [INFO] Unified bulk operations on 1 items from query handle qh_c29ff5009f4b915263b8e03523e50aa7

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:92:12)
      at Object.<anonymous> (test/unit/selection-integration.test.ts:188:61)

  console.error
    [2025-12-06T00:27:04.624Z] [ERROR] Unified bulk operations error: {"message":"Cannot read properties of undefined (reading 'enabled')","name":"TypeError","stack":"TypeError: Cannot read properties of undefined (reading 'enabled')\n    at new BatchEnabledWorkItemOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:67:44)\n    at createBatchEnabledOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:377:10)\n    at handleUnifiedBulkOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\unified-bulk-operations.handler.ts:124:57)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\test\\unit\\unified-bulk-operations.test.ts:188:22)"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:188:22)

  console.error
    [2025-12-06T00:27:04.625Z] [INFO] Actions to perform: update

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:93:12)
      at Object.<anonymous> (test/unit/selection-integration.test.ts:188:61)

  console.error
    [2025-12-06T00:27:04.628Z] [INFO] Unified bulk operations on 2 items from query handle qh_79fec43265c57b7e7283a915b9977daa

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:92:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:229:55)

  console.error
    [2025-12-06T00:27:04.630Z] [ERROR] Unified bulk operations error: {"message":"Cannot read properties of undefined (reading 'enabled')","name":"TypeError","stack":"TypeError: Cannot read properties of undefined (reading 'enabled')\n    at new BatchEnabledWorkItemOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:67:44)\n    at createBatchEnabledOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:377:10)\n    at handleUnifiedBulkOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\unified-bulk-operations.handler.ts:124:57)\n    at Object.<anonymous> (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\test\\unit\\selection-integration.test.ts:188:61)\n    at Promise.then.completed (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:12)
      at Object.<anonymous> (test/unit/selection-integration.test.ts:188:61)

  console.error
    [2025-12-06T00:27:04.633Z] [INFO] Actions to perform: assign

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:93:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:229:55)

  console.error
    [2025-12-06T00:27:04.636Z] [INFO] [OPTIMIZATION] Pre-fetching 2 work items to cache for all actions

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:106:14)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:229:55)

  console.error
    [2025-12-06T00:27:04.637Z] [INFO] Unified bulk operations on 4 items from query handle qh_9df3af08bc0ea6cf40d220a3e1edd1f7

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:92:12)
      at Object.<anonymous> (test/unit/selection-integration.test.ts:231:61)

  console.error
    [2025-12-06T00:27:04.640Z] [INFO] [OPTIMIZATION] Cached 0 work items for reuse across actions (saves 0 fetch operations)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:116:16)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:229:22)

  console.error
    [2025-12-06T00:27:04.640Z] [INFO] Actions to perform: assign

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:93:12)
      at Object.<anonymous> (test/unit/selection-integration.test.ts:231:61)

  console.error
    [2025-12-06T00:27:04.643Z] [ERROR] Unified bulk operations error: {"message":"Cannot read properties of undefined (reading 'enabled')","name":"TypeError","stack":"TypeError: Cannot read properties of undefined (reading 'enabled')\n    at new BatchEnabledWorkItemOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:67:44)\n    at createBatchEnabledOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:377:10)\n    at handleUnifiedBulkOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\unified-bulk-operations.handler.ts:124:57)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\test\\unit\\unified-bulk-operations.test.ts:229:22)"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:229:22)

  console.error
    [2025-12-06T00:27:04.644Z] [ERROR] Unified bulk operations error: {"message":"Cannot read properties of undefined (reading 'enabled')","name":"TypeError","stack":"TypeError: Cannot read properties of undefined (reading 'enabled')\n    at new BatchEnabledWorkItemOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:67:44)\n    at createBatchEnabledOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:377:10)\n    at handleUnifiedBulkOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\unified-bulk-operations.handler.ts:124:57)\n    at Object.<anonymous> (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\test\\unit\\selection-integration.test.ts:231:61)\n    at Promise.then.completed (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:12)
      at Object.<anonymous> (test/unit/selection-integration.test.ts:231:61)

  console.error
    [2025-12-06T00:27:04.649Z] [INFO] Unified bulk operations on 1 items from query handle qh_44e276c09f59ec71def4be65c77878dd

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:92:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:268:55)

  console.error
    [2025-12-06T00:27:04.651Z] [INFO] Unified bulk operations on 2 items from query handle qh_2e371de3ab07bf1ebf19e1928fb6a5e3

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:92:12)
      at Object.<anonymous> (test/unit/selection-integration.test.ts:287:62)

  console.error
    [2025-12-06T00:27:04.653Z] [INFO] Actions to perform: assign

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:93:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:268:55)

  console.error
    [2025-12-06T00:27:04.655Z] [INFO] Actions to perform: comment

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:93:12)
      at Object.<anonymous> (test/unit/selection-integration.test.ts:287:62)

  console.error
    [2025-12-06T00:27:04.657Z] [INFO] [OPTIMIZATION] Pre-fetching 1 work items to cache for all actions

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:106:14)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:268:55)

  console.error
    [2025-12-06T00:27:04.659Z] [ERROR] Unified bulk operations error: {"message":"Cannot read properties of undefined (reading 'enabled')","name":"TypeError","stack":"TypeError: Cannot read properties of undefined (reading 'enabled')\n    at new BatchEnabledWorkItemOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:67:44)\n    at createBatchEnabledOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:377:10)\n    at handleUnifiedBulkOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\unified-bulk-operations.handler.ts:124:57)\n    at Object.<anonymous> (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\test\\unit\\selection-integration.test.ts:287:62)\n    at Promise.then.completed (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:12)
      at Object.<anonymous> (test/unit/selection-integration.test.ts:287:62)

  console.error
    [2025-12-06T00:27:04.661Z] [INFO] [OPTIMIZATION] Cached 0 work items for reuse across actions (saves 0 fetch operations)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:116:16)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:268:22)

  console.error
    [2025-12-06T00:27:04.664Z] [INFO] Unified bulk operations on 2 items from query handle qh_5e4103839b1ec53c6d68006fcc143a4c

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:92:12)
      at Object.<anonymous> (test/unit/selection-integration.test.ts:341:55)

  console.error
    [2025-12-06T00:27:04.666Z] [ERROR] Unified bulk operations error: {"message":"Cannot read properties of undefined (reading 'enabled')","name":"TypeError","stack":"TypeError: Cannot read properties of undefined (reading 'enabled')\n    at new BatchEnabledWorkItemOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:67:44)\n    at createBatchEnabledOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:377:10)\n    at handleUnifiedBulkOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\unified-bulk-operations.handler.ts:124:57)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\test\\unit\\unified-bulk-operations.test.ts:268:22)"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:268:22)

  console.error
    [2025-12-06T00:27:04.667Z] [INFO] Actions to perform: comment

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:93:12)
      at Object.<anonymous> (test/unit/selection-integration.test.ts:341:55)

  console.error
    [2025-12-06T00:27:04.670Z] [INFO] Unified bulk operations on 1 items from query handle qh_f37f3e7a9aaa7aa4065fa2f22fba1460

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:92:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:300:55)

  console.error
    [2025-12-06T00:27:04.670Z] [ERROR] Unified bulk operations error: {"message":"Cannot read properties of undefined (reading 'enabled')","name":"TypeError","stack":"TypeError: Cannot read properties of undefined (reading 'enabled')\n    at new BatchEnabledWorkItemOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:67:44)\n    at createBatchEnabledOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:377:10)\n    at handleUnifiedBulkOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\unified-bulk-operations.handler.ts:124:57)\n    at Object.<anonymous> (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\test\\unit\\selection-integration.test.ts:341:55)\n    at Promise.then.completed (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:12)
      at Object.<anonymous> (test/unit/selection-integration.test.ts:341:55)

  console.error
    [2025-12-06T00:27:04.672Z] [INFO] Actions to perform: remove

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:93:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:300:55)

  console.error
    [2025-12-06T00:27:04.675Z] [INFO] [OPTIMIZATION] Pre-fetching 1 work items to cache for all actions

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:106:14)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:300:55)

  console.error
    [2025-12-06T00:27:04.680Z] [INFO] [OPTIMIZATION] Cached 0 work items for reuse across actions (saves 0 fetch operations)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:116:16)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:300:22)

  console.error
    [2025-12-06T00:27:04.685Z] [ERROR] Unified bulk operations error: {"message":"Cannot read properties of undefined (reading 'enabled')","name":"TypeError","stack":"TypeError: Cannot read properties of undefined (reading 'enabled')\n    at new BatchEnabledWorkItemOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:67:44)\n    at createBatchEnabledOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:377:10)\n    at handleUnifiedBulkOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\unified-bulk-operations.handler.ts:124:57)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\test\\unit\\unified-bulk-operations.test.ts:300:22)"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:300:22)

  console.error
    [2025-12-06T00:27:04.691Z] [INFO] Unified bulk operations on 2 items from query handle qh_24dd816ce99cfa54a11e7d1c3802f637

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:92:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:345:55)

  console.error
    [2025-12-06T00:27:04.694Z] [INFO] Actions to perform: transition-state

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:93:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:345:55)

  console.error
    [2025-12-06T00:27:04.698Z] [INFO] [OPTIMIZATION] Pre-fetching 2 work items to cache for all actions

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:106:14)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:345:55)

  console.error
    [2025-12-06T00:27:04.696Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

  console.error
    [2025-12-06T00:27:04.701Z] [INFO] [OPTIMIZATION] Cached 0 work items for reuse across actions (saves 0 fetch operations)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:116:16)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:345:22)

  console.error
    [2025-12-06T00:27:04.704Z] [ERROR] Unified bulk operations error: {"message":"Cannot read properties of undefined (reading 'enabled')","name":"TypeError","stack":"TypeError: Cannot read properties of undefined (reading 'enabled')\n    at new BatchEnabledWorkItemOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:67:44)\n    at createBatchEnabledOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:377:10)\n    at handleUnifiedBulkOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\unified-bulk-operations.handler.ts:124:57)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\test\\unit\\unified-bulk-operations.test.ts:345:22)"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:345:22)

  console.error
    [2025-12-06T00:27:04.708Z] [INFO] Unified bulk operations on 1 items from query handle qh_f3de063dc5dba6a17b6f002657aeca9a

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:92:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:390:55)

  console.error
    [2025-12-06T00:27:04.712Z] [INFO] Actions to perform: move-iteration

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:93:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:390:55)

  console.error
    [2025-12-06T00:27:04.715Z] [INFO] [OPTIMIZATION] Pre-fetching 1 work items to cache for all actions

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:106:14)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:390:55)

  console.error
    [2025-12-06T00:27:04.718Z] [INFO] [OPTIMIZATION] Cached 0 work items for reuse across actions (saves 0 fetch operations)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:116:16)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:390:22)

  console.error
    [2025-12-06T00:27:04.732Z] [ERROR] Unified bulk operations error: {"message":"Cannot read properties of undefined (reading 'enabled')","name":"TypeError","stack":"TypeError: Cannot read properties of undefined (reading 'enabled')\n    at new BatchEnabledWorkItemOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:67:44)\n    at createBatchEnabledOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:377:10)\n    at handleUnifiedBulkOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\unified-bulk-operations.handler.ts:124:57)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\test\\unit\\unified-bulk-operations.test.ts:390:22)"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:390:22)

  console.error
    [2025-12-06T00:27:04.736Z] [INFO] Unified bulk operations on 1 items from query handle qh_87ab5b7331ba218cbaa5a022790edfc9

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:92:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:441:55)

  console.error
    [2025-12-06T00:27:04.739Z] [INFO] Actions to perform: add-tag

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:93:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:441:55)

  console.error
    [2025-12-06T00:27:04.743Z] [INFO] [OPTIMIZATION] Pre-fetching 1 work items to cache for all actions

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:106:14)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:441:55)

  console.error
    [2025-12-06T00:27:04.747Z] [INFO] [OPTIMIZATION] Cached 1 work items for reuse across actions (saves 0 fetch operations)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:116:16)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:441:22)

  console.error
    [2025-12-06T00:27:04.750Z] [ERROR] Unified bulk operations error: {"message":"Cannot read properties of undefined (reading 'enabled')","name":"TypeError","stack":"TypeError: Cannot read properties of undefined (reading 'enabled')\n    at new BatchEnabledWorkItemOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:67:44)\n    at createBatchEnabledOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:377:10)\n    at handleUnifiedBulkOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\unified-bulk-operations.handler.ts:124:57)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\test\\unit\\unified-bulk-operations.test.ts:441:22)"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:441:22)

  console.error
    [2025-12-06T00:27:04.755Z] [INFO] Unified bulk operations on 1 items from query handle qh_519fb1f8498a0deb83b401e59a1304b6

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:92:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:490:55)

  console.error
    [2025-12-06T00:27:04.757Z] [INFO] Actions to perform: remove-tag

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:93:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:490:55)

  console.error
    [2025-12-06T00:27:04.760Z] [INFO] [OPTIMIZATION] Pre-fetching 1 work items to cache for all actions

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:106:14)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:490:55)

  console.error
    [2025-12-06T00:27:04.762Z] [INFO] [OPTIMIZATION] Cached 0 work items for reuse across actions (saves 0 fetch operations)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:116:16)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:490:22)

  console.error
    [2025-12-06T00:27:04.764Z] [ERROR] Unified bulk operations error: {"message":"Cannot read properties of undefined (reading 'enabled')","name":"TypeError","stack":"TypeError: Cannot read properties of undefined (reading 'enabled')\n    at new BatchEnabledWorkItemOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:67:44)\n    at createBatchEnabledOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:377:10)\n    at handleUnifiedBulkOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\unified-bulk-operations.handler.ts:124:57)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\test\\unit\\unified-bulk-operations.test.ts:490:22)"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:490:22)

  console.error
    [2025-12-06T00:27:04.767Z] [INFO] Unified bulk operations on 1 items from query handle qh_b749a5ef76281c504393d7e7fd6b2883

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:92:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:530:55)

  console.error
    [2025-12-06T00:27:04.770Z] [INFO] Actions to perform: comment, assign, update

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:93:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:530:55)

  console.error
    [2025-12-06T00:27:04.773Z] [INFO] [OPTIMIZATION] Pre-fetching 1 work items to cache for all actions

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:106:14)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:530:55)

  console.error
    [2025-12-06T00:27:04.776Z] [INFO] [OPTIMIZATION] Cached 0 work items for reuse across actions (saves 2 fetch operations)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:116:16)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:530:22)

  console.error
    [2025-12-06T00:27:04.778Z] [ERROR] Unified bulk operations error: {"message":"Cannot read properties of undefined (reading 'enabled')","name":"TypeError","stack":"TypeError: Cannot read properties of undefined (reading 'enabled')\n    at new BatchEnabledWorkItemOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:67:44)\n    at createBatchEnabledOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:377:10)\n    at handleUnifiedBulkOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\unified-bulk-operations.handler.ts:124:57)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\test\\unit\\unified-bulk-operations.test.ts:530:22)"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:530:22)

  console.error
    [2025-12-06T00:27:04.781Z] [INFO] Unified bulk operations on 1 items from query handle qh_34ad70a00f3ebe2828be8eed1921b8f8

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:92:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:565:55)

  console.error
    [2025-12-06T00:27:04.783Z] [INFO] Actions to perform: comment, assign

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:93:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:565:55)

  console.error
    [2025-12-06T00:27:04.786Z] [INFO] [OPTIMIZATION] Pre-fetching 1 work items to cache for all actions

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:106:14)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:565:55)

  console.error
    [2025-12-06T00:27:04.788Z] [INFO] [OPTIMIZATION] Cached 0 work items for reuse across actions (saves 1 fetch operations)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:116:16)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:565:22)

  console.error
    [2025-12-06T00:27:04.791Z] [ERROR] Unified bulk operations error: {"message":"Cannot read properties of undefined (reading 'enabled')","name":"TypeError","stack":"TypeError: Cannot read properties of undefined (reading 'enabled')\n    at new BatchEnabledWorkItemOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:67:44)\n    at createBatchEnabledOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:377:10)\n    at handleUnifiedBulkOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\unified-bulk-operations.handler.ts:124:57)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\test\\unit\\unified-bulk-operations.test.ts:565:22)"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:565:22)

  console.error
    [2025-12-06T00:27:04.794Z] [INFO] Unified bulk operations on 1 items from query handle qh_608dfc3b8d11afc2b951e993053bcd1b

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:92:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:595:55)

  console.error
    [2025-12-06T00:27:04.797Z] [INFO] Actions to perform: comment, assign

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:93:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:595:55)

  console.error
    [2025-12-06T00:27:04.799Z] [INFO] [OPTIMIZATION] Pre-fetching 1 work items to cache for all actions

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:106:14)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:595:55)

  console.error
    [2025-12-06T00:27:04.803Z] [INFO] [OPTIMIZATION] Cached 0 work items for reuse across actions (saves 1 fetch operations)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:116:16)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:595:22)

  console.error
    [2025-12-06T00:27:04.806Z] [ERROR] Unified bulk operations error: {"message":"Cannot read properties of undefined (reading 'enabled')","name":"TypeError","stack":"TypeError: Cannot read properties of undefined (reading 'enabled')\n    at new BatchEnabledWorkItemOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:67:44)\n    at createBatchEnabledOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:377:10)\n    at handleUnifiedBulkOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\unified-bulk-operations.handler.ts:124:57)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\test\\unit\\unified-bulk-operations.test.ts:595:22)"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:595:22)

  console.error
    [2025-12-06T00:27:04.815Z] [INFO] Unified bulk operations on 2 items from query handle qh_210d76f1525305526a4222cf94af4898

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:92:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:663:55)

  console.error
    [2025-12-06T00:27:04.818Z] [INFO] Actions to perform: comment

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:93:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:663:55)

  console.error
    [2025-12-06T00:27:04.821Z] [INFO] [OPTIMIZATION] Pre-fetching 2 work items to cache for all actions

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:106:14)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:663:55)

  console.error
    [2025-12-06T00:27:04.829Z] [INFO] [OPTIMIZATION] Cached 0 work items for reuse across actions (saves 0 fetch operations)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:116:16)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:663:22)

  console.error
    [2025-12-06T00:27:04.834Z] [ERROR] Unified bulk operations error: {"message":"Cannot read properties of undefined (reading 'enabled')","name":"TypeError","stack":"TypeError: Cannot read properties of undefined (reading 'enabled')\n    at new BatchEnabledWorkItemOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:67:44)\n    at createBatchEnabledOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\batch-enabled-operations.ts:377:10)\n    at handleUnifiedBulkOperations (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\unified-bulk-operations.handler.ts:124:57)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\test\\unit\\unified-bulk-operations.test.ts:663:22)"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:12)
      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:663:22)

FAIL test/unit/selection-integration.test.ts (6.771 s)
  Selection Integration Tests
    Scenario 1: Full Workflow - Query to Bulk Comment
      â”œÃ¹ should complete full workflow: query Î“Ã¥Ã† select Î“Ã¥Ã† bulk comment (198 ms)
    Scenario 2: Single Item Selection (Index-Based)
      â”œÃ¹ should select and update a single item by index (15 ms)
    Scenario 3: Multiple Item Selection (Index Array)
      â”œÃ¹ should select and assign multiple items by indices (14 ms)
    Scenario 4: Criteria-Based Selection (States + Tags)
      â”œÃ¹ should select items matching multiple criteria (13 ms)
    Scenario 5: Selection by Staleness
      â”œÃ¹ should select stale items for followup (12 ms)
    Scenario 6: Error Cases
      Error Handling
        Î“ÃªÃœ should handle invalid query handle gracefully (1 ms)
        Î“ÃªÃœ should handle expired query handle (17 ms)
        Î“ÃªÃœ should handle empty selection gracefully (2 ms)
        Î“ÃªÃœ should validate indices are within bounds

  Î“Ã¹Ã… Selection Integration Tests Î“Ã‡â•‘ Scenario 1: Full Workflow - Query to Bulk Comment Î“Ã‡â•‘ should complete full workflow: query Î“Ã¥Ã† select Î“Ã¥Ã† bulk comment

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      162 |       });
      163 |       
    > 164 |       expect(commentResult.success).toBe(true);
          |                                     ^
      165 |       const data = commentResult.data as any;
      166 |       expect(data.items_selected).toBe(2);
      167 |     });

      at Object.<anonymous> (test/unit/selection-integration.test.ts:164:37)

  Î“Ã¹Ã… Selection Integration Tests Î“Ã‡â•‘ Scenario 2: Single Item Selection (Index-Based) Î“Ã‡â•‘ should select and update a single item by index

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      204 |       });
      205 |       
    > 206 |       expect(updateResult.success).toBe(true);
          |                                    ^
      207 |       const data = updateResult.data as any;
      208 |       expect(data.items_selected).toBe(1);
      209 |     });

      at Object.<anonymous> (test/unit/selection-integration.test.ts:206:36)

  Î“Ã¹Ã… Selection Integration Tests Î“Ã‡â•‘ Scenario 3: Multiple Item Selection (Index Array) Î“Ã‡â•‘ should select and assign multiple items by indices

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      241 |       });
      242 |       
    > 243 |       expect(assignResult.success).toBe(true);
          |                                    ^
      244 |       const data = assignResult.data as any;
      245 |       expect(data.items_selected).toBe(4);
      246 |     });

      at Object.<anonymous> (test/unit/selection-integration.test.ts:243:36)

  Î“Ã¹Ã… Selection Integration Tests Î“Ã‡â•‘ Scenario 4: Criteria-Based Selection (States + Tags) Î“Ã‡â•‘ should select items matching multiple criteria

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      297 |       });
      298 |       
    > 299 |       expect(commentResult.success).toBe(true);
          |                                     ^
      300 |       const data = commentResult.data as any;
      301 |       expect(data.items_selected).toBe(2);
      302 |     });

      at Object.<anonymous> (test/unit/selection-integration.test.ts:299:37)

  Î“Ã¹Ã… Selection Integration Tests Î“Ã‡â•‘ Scenario 5: Selection by Staleness Î“Ã‡â•‘ should select stale items for followup

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      351 |       });
      352 |       
    > 353 |       expect(result.success).toBe(true);
          |                              ^
      354 |       const data = result.data as any;
      355 |       expect(data.items_selected).toBe(2);
      356 |     });

      at Object.<anonymous> (test/unit/selection-integration.test.ts:353:30)

  console.error
    [2025-12-06T00:27:04.840Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

FAIL test/unit/unified-bulk-operations.test.ts (7.002 s)
  Unified Bulk Operations Handler
    Dry Run Mode
      â”œÃ¹ should preview operations without executing in dry-run mode (206 ms)
    Comment Action
      â”œÃ¹ should add comments to all work items (20 ms)
      â”œÃ¹ should handle comment failures gracefully (22 ms)
    Update Action
      â”œÃ¹ should update work item fields (19 ms)
    Assign Action
      â”œÃ¹ should assign work items to user (20 ms)
      â”œÃ¹ should add comment when assigning with comment (21 ms)
    Remove Action
      â”œÃ¹ should move work items to Removed state (21 ms)
    Transition State Action
      â”œÃ¹ should transition work items to new state (16 ms)
    Move Iteration Action
      â”œÃ¹ should move work items to new iteration (28 ms)
    Add Tag Action
      â”œÃ¹ should add tags to work items (18 ms)
    Remove Tag Action
      â”œÃ¹ should remove tags from work items (12 ms)
    Sequential Execution
      â”œÃ¹ should execute multiple actions sequentially (13 ms)
      â”œÃ¹ should stop on error when stopOnError is true (13 ms)
      â”œÃ¹ should continue on error when stopOnError is false (16 ms)
    Error Handling
      Î“ÃªÃœ should return error for invalid query handle (1 ms)
      Î“ÃªÃœ should return error for empty work item selection (1 ms)
    Item Selector Support
      â”œÃ¹ should support itemSelector with indices (26 ms)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Dry Run Mode Î“Ã‡â•‘ should preview operations without executing in dry-run mode

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      101 |
      102 |       // Assert
    > 103 |       expect(result.success).toBe(true);
          |                              ^
      104 |       expect((result.data as any).dry_run).toBe(true);
      105 |       expect((result.data as any).actions_completed).toBe(2);
      106 |       expect((result.data as any).actions_failed).toBe(0);

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:103:30)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Comment Action Î“Ã‡â•‘ should add comments to all work items

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      132 |
      133 |       // Assert
    > 134 |       expect(result.success).toBe(true);
          |                              ^
      135 |       expect(mockPostFn).toHaveBeenCalledTimes(2);
      136 |       expect(mockPostFn).toHaveBeenCalledWith(
      137 |         expect.stringContaining('wit/workItems/101/comments'),

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:134:30)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Comment Action Î“Ã‡â•‘ should handle comment failures gracefully

    TypeError: Cannot read properties of null (reading 'action_results')

      168 |       // Assert
      169 |       expect(result.success).toBe(false);
    > 170 |       expect((result.data as any).action_results[0].items_succeeded).toBe(1);
          |                                   ^
      171 |       expect((result.data as any).action_results[0].items_failed).toBe(1);
      172 |     });
      173 |   });

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:170:35)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Update Action Î“Ã‡â•‘ should update work item fields

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      200 |
      201 |       // Assert
    > 202 |       expect(result.success).toBe(true);
          |                              ^
      203 |       expect(mockPatchFn).toHaveBeenCalledWith(
      204 |         expect.stringContaining('wit/workItems/101'),
      205 |         expect.arrayContaining([

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:202:30)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Assign Action Î“Ã‡â•‘ should assign work items to user

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      239 |
      240 |       // Assert
    > 241 |       expect(result.success).toBe(true);
          |                              ^
      242 |       expect(mockPatchFn).toHaveBeenCalledTimes(2);
      243 |       expect(mockPatchFn).toHaveBeenCalledWith(
      244 |         expect.stringContaining('wit/workItems/101'),

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:241:30)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Assign Action Î“Ã‡â•‘ should add comment when assigning with comment

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      279 |
      280 |       // Assert
    > 281 |       expect(result.success).toBe(true);
          |                              ^
      282 |       expect(mockPatchFn).toHaveBeenCalledTimes(1); // Assignment
      283 |       expect(mockPostFn).toHaveBeenCalledTimes(1); // Comment
      284 |     });

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:281:30)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Remove Action Î“Ã‡â•‘ should move work items to Removed state

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      310 |
      311 |       // Assert
    > 312 |       expect(result.success).toBe(true);
          |                              ^
      313 |       expect(mockPostFn).toHaveBeenCalledWith(
      314 |         expect.stringContaining('wit/workItems/101/comments'),
      315 |         expect.objectContaining({

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:312:30)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Transition State Action Î“Ã‡â•‘ should transition work items to new state

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      356 |
      357 |       // Assert
    > 358 |       expect(result.success).toBe(true);
          |                              ^
      359 |       expect(mockPatchFn).toHaveBeenCalledWith(
      360 |         expect.stringContaining('wit/workItems/101'),
      361 |         expect.arrayContaining([

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:358:30)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Move Iteration Action Î“Ã‡â•‘ should move work items to new iteration

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      400 |
      401 |       // Assert
    > 402 |       expect(result.success).toBe(true);
          |                              ^
      403 |       expect(mockPatchFn).toHaveBeenCalledWith(
      404 |         expect.stringContaining('wit/workItems/101'),
      405 |         expect.arrayContaining([

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:402:30)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Add Tag Action Î“Ã‡â•‘ should add tags to work items

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      451 |
      452 |       // Assert
    > 453 |       expect(result.success).toBe(true);
          |                              ^
      454 |       expect(mockGetFn).toHaveBeenCalledWith(
      455 |         expect.stringContaining('wit/workitems?ids=101&fields=System.Tags')
      456 |       );

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:453:30)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Remove Tag Action Î“Ã‡â•‘ should remove tags from work items

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      500 |
      501 |       // Assert
    > 502 |       expect(result.success).toBe(true);
          |                              ^
      503 |       expect(mockPatchFn).toHaveBeenCalledWith(
      504 |         expect.stringContaining('wit/workItems/101'),
      505 |         expect.arrayContaining([

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:502:30)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Sequential Execution Î“Ã‡â•‘ should execute multiple actions sequentially

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      544 |
      545 |       // Assert
    > 546 |       expect(result.success).toBe(true);
          |                              ^
      547 |       expect((result.data as any).actions_completed).toBe(3);
      548 |       expect((result.data as any).actions_failed).toBe(0);
      549 |       expect(mockPostFn).toHaveBeenCalledTimes(1); // Comment

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:546:30)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Sequential Execution Î“Ã‡â•‘ should stop on error when stopOnError is true

    TypeError: Cannot read properties of null (reading 'actions_completed')

      575 |       // Assert
      576 |       expect(result.success).toBe(false);
    > 577 |       expect((result.data as any).actions_completed).toBe(0);
          |                                   ^
      578 |       expect((result.data as any).actions_failed).toBe(1);
      579 |       expect(mockPatchFn).not.toHaveBeenCalled(); // Second action not executed
      580 |     });

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:577:35)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Sequential Execution Î“Ã‡â•‘ should continue on error when stopOnError is false

    TypeError: Cannot read properties of null (reading 'actions_completed')

      605 |       // Assert
      606 |       expect(result.success).toBe(false);
    > 607 |       expect((result.data as any).actions_completed).toBe(1);
          |                                   ^
      608 |       expect((result.data as any).actions_failed).toBe(1);
      609 |       expect(mockPatchFn).toHaveBeenCalled(); // Second action executed
      610 |     });

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:607:35)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Item Selector Support Î“Ã‡â•‘ should support itemSelector with indices

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      671 |
      672 |       // Assert
    > 673 |       expect(result.success).toBe(true);
          |                              ^
      674 |       expect((result.data as any).items_selected).toBe(2);
      675 |       expect(mockPostFn).toHaveBeenCalledTimes(2);
      676 |     });

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:673:30)

  console.error
    [2025-12-06T00:27:05.750Z] [ERROR] Azure CLI authentication required - user not logged in

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at AzureCliTokenProvider.createDetailedError (src/utils/azure-cli-token.ts:151:14)
      at AzureCliTokenProvider.getToken (src/utils/azure-cli-token.ts:84:18)
      at Object.<anonymous> (test/unit/azure-cli-token.test.ts:152:9)

  console.error
    [2025-12-06T00:27:05.757Z] [ERROR] Azure CLI token expired or invalid

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at AzureCliTokenProvider.createDetailedError (src/utils/azure-cli-token.ts:176:14)
      at AzureCliTokenProvider.getToken (src/utils/azure-cli-token.ts:84:18)
      at Object.<anonymous> (test/unit/azure-cli-token.test.ts:170:9)

  console.error
    [2025-12-06T00:27:05.761Z] [ERROR] Azure CLI not found or not available

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at AzureCliTokenProvider.createDetailedError (src/utils/azure-cli-token.ts:205:14)
      at AzureCliTokenProvider.getToken (src/utils/azure-cli-token.ts:84:18)
      at Object.<anonymous> (test/unit/azure-cli-token.test.ts:188:9)

  console.error
    [2025-12-06T00:27:05.765Z] [ERROR] Insufficient permissions for Azure CLI authentication

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at AzureCliTokenProvider.createDetailedError (src/utils/azure-cli-token.ts:233:14)
      at AzureCliTokenProvider.getToken (src/utils/azure-cli-token.ts:84:18)
      at Object.<anonymous> (test/unit/azure-cli-token.test.ts:206:9)

PASS test/integration/error-recovery.test.ts
  Error Recovery Integration Tests
    Network Failure Recovery
      Î“ÃªÃœ should handle network connection failure with retry (45 ms)
      Î“ÃªÃœ should handle DNS resolution failure (13 ms)
      Î“ÃªÃœ should handle socket hang up error (16 ms)
      Î“ÃªÃœ should eventually fail after max retries for persistent network errors (68 ms)
    API Timeout Recovery
      Î“ÃªÃœ should handle request timeout with AbortError (597 ms)
      Î“ÃªÃœ should handle timeout and retry successfully (25 ms)
      Î“ÃªÃœ should handle TimeoutError gracefully (1 ms)
    Authentication Error Recovery
      Î“ÃªÃœ should handle 401 Unauthorized error (1 ms)
      Î“ÃªÃœ should handle token refresh and retry (13 ms)
      Î“ÃªÃœ should not retry non-retryable auth errors (1 ms)
      Î“ÃªÃœ should handle non-JSON auth error response (HTML page) (1 ms)
    Rate Limiting Recovery
      Î“ÃªÃœ should handle 429 rate limit error with retry (60 ms)
      Î“ÃªÃœ should respect rate limiter throttling (218 ms)
      Î“ÃªÃœ should handle rate limiter stats correctly (1 ms)
    500 Internal Server Error Recovery
      Î“ÃªÃœ should retry on 500 Internal Server Error (15 ms)
      Î“ÃªÃœ should handle 503 Service Unavailable with retry
      Î“ÃªÃœ should handle 502 Bad Gateway with retry (1 ms)
      Î“ÃªÃœ should handle 504 Gateway Timeout with retry
    Permission Denied Errors
      Î“ÃªÃœ should handle 403 Forbidden error with helpful message (1 ms)
      Î“ÃªÃœ should not retry permission denied errors (1 ms)
    Error Message Quality
      Î“ÃªÃœ should provide helpful error messages for network failures
      Î“ÃªÃœ should provide helpful error messages for DNS failures
      Î“ÃªÃœ should categorize errors correctly for user guidance (2 ms)
    Cleanup After Failures
      Î“ÃªÃœ should properly clean up rate limiter state (1 ms)
      Î“ÃªÃœ should not leak resources on repeated failures
      Î“ÃªÃœ should handle concurrent operations without state corruption (22 ms)
    Exponential Backoff
      Î“ÃªÃœ should apply exponential backoff on retries (720 ms)
      Î“ÃªÃœ should respect max delay cap (720 ms)
    Bulk Operations Error Recovery
      Î“ÃªÃœ should handle partial failures in bulk operations (14 ms)
      Î“ÃªÃœ should recover from transient failures in sequence (62 ms)
    Error Classification
      Î“ÃªÃœ should correctly identify transient errors (1 ms)
      Î“ÃªÃœ should correctly identify non-transient errors (1 ms)
      Î“ÃªÃœ should identify retryable auth errors
      Î“ÃªÃœ should identify non-retryable auth errors (1 ms)

  console.error
    [2025-12-06T00:27:08.773Z] [ERROR] Network error during Azure CLI token acquisition (retries exhausted)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at AzureCliTokenProvider.createDetailedError (src/utils/azure-cli-token.ts:267:14)
      at AzureCliTokenProvider.getToken (src/utils/azure-cli-token.ts:84:18)
      at Object.<anonymous> (test/unit/azure-cli-token.test.ts:224:9)

  console.error
    [2025-12-06T00:27:08.778Z] [ERROR] Unknown error during Azure CLI token acquisition: Azure CLI credential returned null token

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at AzureCliTokenProvider.createDetailedError (src/utils/azure-cli-token.ts:292:12)
      at AzureCliTokenProvider.getToken (src/utils/azure-cli-token.ts:84:18)
      at Object.<anonymous> (test/unit/azure-cli-token.test.ts:239:7)

  console.error
    [2025-12-06T00:27:09.461Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:09.461Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:09.464Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:09.466Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/rate-limiter.test.ts
  RateLimiter
    Basic Throttling
      Î“ÃªÃœ should allow requests within capacity (2 ms)
      Î“ÃªÃœ should throttle when capacity exhausted (110 ms)
      Î“ÃªÃœ should refill tokens over time (201 ms)
    Multiple Keys
      Î“ÃªÃœ should handle separate buckets for different keys
      Î“ÃªÃœ should track stats per key (1 ms)
    Reset Operations
      Î“ÃªÃœ should reset specific key (1 ms)
      Î“ÃªÃœ should reset all keys
    Statistics
      Î“ÃªÃœ should return null for non-existent key (1 ms)
      Î“ÃªÃœ should report remaining tokens
    Configuration Support
      Î“ÃªÃœ should support custom capacity and refill rate (199 ms)
      Î“ÃªÃœ should support different configurations per key (376 ms)
      Î“ÃªÃœ should validate min/max bounds for capacity (1 ms)
      Î“ÃªÃœ should validate min/max bounds for refill rate

  console.error
    [2025-12-06T00:27:10.036Z] [WARN] Area path "MyProject" appears invalid - should be "ProjectName\AreaName" format

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at extractProjectFromAreaPath (src/config/config.ts:43:12)
      at Object.<anonymous> (test/unit/config-types.test.ts:91:49)

  console.error
    [2025-12-06T00:27:10.075Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:10.075Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:10.078Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:10.080Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/config-types.test.ts
  Configuration Type Safety
    CLIArguments interface
      Î“ÃªÃœ should accept valid CLI arguments from yargs (2 ms)
      Î“ÃªÃœ should accept minimal CLI arguments (1 ms)
      Î“ÃªÃœ should accept CLI arguments with area path but no project (1 ms)
    extractProjectFromAreaPath function
      Î“ÃªÃœ should extract project from simple area path
      Î“ÃªÃœ should extract project from multi-level area path (1 ms)
      Î“ÃªÃœ should handle single segment (project only) (5 ms)
      Î“ÃªÃœ should return null for empty string
      Î“ÃªÃœ should return null for null/undefined input
      Î“ÃªÃœ should handle area paths with spaces (1 ms)
      Î“ÃªÃœ should filter empty segments from malformed paths
    updateConfigFromCLI function
      Î“ÃªÃœ should accept CLIArguments without type errors
      Î“ÃªÃœ should properly store CLI arguments for later use (1 ms)
      Î“ÃªÃœ should extract project from area path when project not provided (1 ms)
      Î“ÃªÃœ should throw error if neither project nor area path provided (24 ms)
    loadConfiguration function
      Î“ÃªÃœ should return properly typed MCPServerConfig (1 ms)
      Î“ÃªÃœ should apply proper defaults from schema (1 ms)
      Î“ÃªÃœ should handle verbose logging flag (1 ms)
      Î“ÃªÃœ should handle optional CLI parameters
    Type safety guarantees
      Î“ÃªÃœ should not allow assignment of wrong types to CLIArguments
      Î“ÃªÃœ should properly type optional CLI parameters
    No any types in config module
      Î“ÃªÃœ should use proper types throughout configuration system (1 ms)

  console.error
    [2025-12-06T00:27:10.551Z] [INFO] test operation succeeded on attempt 3/3

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at withRetry (src/utils/retry.ts:84:16)
      at Object.<anonymous> (test/unit/retry.test.ts:28:22)

  console.error
    [2025-12-06T00:27:10.975Z] [INFO] operation succeeded on attempt 3/3

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at withRetry (src/utils/retry.ts:84:16)
      at Object.<anonymous> (test/unit/retry.test.ts:79:7)

  console.error
    [2025-12-06T00:27:11.238Z] [INFO] operation succeeded on attempt 3/3

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at withRetry (src/utils/retry.ts:84:16)
      at Object.<anonymous> (test/unit/retry.test.ts:101:7)

  console.error
    [2025-12-06T00:27:11.281Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:11.281Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:11.284Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:11.287Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/retry.test.ts
  Retry Utility
    withRetry
      Î“ÃªÃœ should return result on first successful attempt (2 ms)
      Î“ÃªÃœ should retry on failure and eventually succeed (59 ms)
      Î“ÃªÃœ should throw last error when all retries exhausted (104 ms)
      Î“ÃªÃœ should respect isRetryable function (2 ms)
      Î“ÃªÃœ should use exponential backoff (313 ms)
      Î“ÃªÃœ should respect maxDelayMs (273 ms)
      Î“ÃªÃœ should handle non-Error rejections (20 ms)
    isTransientError
      Î“ÃªÃœ should identify timeout errors as transient (1 ms)
      Î“ÃªÃœ should identify connection errors as transient
      Î“ÃªÃœ should identify rate limit errors as transient
      Î“ÃªÃœ should identify service unavailable errors as transient
      Î“ÃªÃœ should identify gateway errors as transient (1 ms)
      Î“ÃªÃœ should not identify auth errors as transient
      Î“ÃªÃœ should not identify validation errors as transient
    isRetryableAuthError
      Î“ÃªÃœ should identify token refresh failures as retryable
      Î“ÃªÃœ should identify network errors during auth as retryable
      Î“ÃªÃœ should not identify "not logged in" as retryable
      Î“ÃªÃœ should not identify expired token as retryable
      Î“ÃªÃœ should not identify permission errors as retryable (1 ms)

  console.error
    [2025-12-06T00:27:11.814Z] [INFO] Azure CLI token acquisition succeeded on attempt 3/3

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at withRetry (src/utils/retry.ts:84:16)
      at AzureCliTokenProvider.getToken (src/utils/azure-cli-token.ts:63:22)
      at Object.<anonymous> (test/unit/azure-cli-token.test.ts:256:21)

  console.error
    [2025-12-06T00:27:11.819Z] [ERROR] Azure CLI authentication required - user not logged in

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at AzureCliTokenProvider.createDetailedError (src/utils/azure-cli-token.ts:151:14)
      at AzureCliTokenProvider.getToken (src/utils/azure-cli-token.ts:84:18)
      at Object.<anonymous> (test/unit/azure-cli-token.test.ts:269:7)

  console.error
    [2025-12-06T00:27:12.012Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:12.012Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:12.014Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:12.017Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/create-item-multi-area.test.ts
  Work Item Creation with Multiple Area Paths
    Single Area Path (Backward Compatible)
      Î“ÃªÃœ should use configured area path as default (3 ms)
      Î“ÃªÃœ should allow creating work items without explicit area path (1 ms)
    Multiple Area Paths Configured
      Î“ÃªÃœ should require explicit area path when multiple configured (1 ms)
      Î“ÃªÃœ should validate area path is in configured list
      Î“ÃªÃœ should accept area path from configured list
      Î“ÃªÃœ should provide helpful error message listing valid area paths (1 ms)
    Area Path Validation Logic
      Î“ÃªÃœ should use first area path as fallback when none specified (single path) (1 ms)
      Î“ÃªÃœ should warn when using default with multiple paths (1 ms)
      Î“ÃªÃœ should validate format of provided area path
    Integration with Parent Work Items
      Î“ÃªÃœ should inherit parent area path when not specified (1 ms)
      Î“ÃªÃœ should validate inherited area path against configured paths (1 ms)
      Î“ÃªÃœ should reject inherited area path not in configured list
    Error Messages
      Î“ÃªÃœ should provide clear error when area path required but not provided (1 ms)
      Î“ÃªÃœ should provide clear error when invalid area path provided (1 ms)

  console.error
    [2025-12-06T00:27:12.630Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:12.630Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:12.633Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:12.635Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/get-configuration.test.ts
  get-configuration handler
    Basic Functionality
      Î“ÃªÃœ should return all configuration when section is "all" (2 ms)
      Î“ÃªÃœ should return all configuration when no section specified
      Î“ÃªÃœ should return only azureDevOps section when requested (1 ms)
      Î“ÃªÃœ should return only gitRepository section when requested
      Î“ÃªÃœ should return only gitHubCopilot section when requested (1 ms)
    Help Text
      Î“ÃªÃœ should include helpful area path text (1 ms)
      Î“ÃªÃœ should include helpful iteration path text
      Î“ÃªÃœ should include helpful GitHub Copilot text when GUID is configured (1 ms)
      Î“ÃªÃœ should show appropriate message when no area path configured
      Î“ÃªÃœ should show appropriate message when no iteration path configured (1 ms)
      Î“ÃªÃœ should show appropriate message when no GitHub Copilot GUID configured
    Multiple Area Paths
      Î“ÃªÃœ should handle multiple area paths correctly
    Error Handling
      Î“ÃªÃœ should handle errors gracefully (1 ms)
    Metadata
      Î“ÃªÃœ should include correct metadata

  console.error
    [2025-12-06T00:27:13.254Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:13.254Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:13.256Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:13.259Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/multi-area-path-support.test.ts
  Multi-Area Path Support
    CLI Arguments with Multiple Area Paths
      Î“ÃªÃœ should accept multiple area paths via areaPaths array (3 ms)
      Î“ÃªÃœ should normalize single areaPath to areaPaths array (1 ms)
      Î“ÃªÃœ should support backward compatibility with single areaPath (1 ms)
    Project Extraction from Multiple Area Paths
      Î“ÃªÃœ should extract project from multiple area paths (same project) (1 ms)
      Î“ÃªÃœ should error when area paths contain different projects (27 ms)
    Area Path Validation
      Î“ÃªÃœ should reject empty area paths in array (1 ms)
      Î“ÃªÃœ should reject duplicate area paths (1 ms)
      Î“ÃªÃœ should accept valid multiple area paths (1 ms)
    getRequiredConfig with Multiple Area Paths
      Î“ÃªÃœ should return array of area paths in defaultAreaPaths
      Î“ÃªÃœ should normalize single areaPath to defaultAreaPaths array
    Backward Compatibility
      Î“ÃªÃœ should work with existing single area path configurations (1 ms)
      Î“ÃªÃœ should maintain defaultAreaPath for backward compatibility
    Configuration Schema Validation
      Î“ÃªÃœ should validate areaPaths is array of strings (1 ms)
      Î“ÃªÃœ should require organization (1 ms)
      Î“ÃªÃœ should require project or area path

  console.error
    [2025-12-06T00:27:13.942Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:13.942Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:13.944Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:13.946Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/metrics-service.test.ts
  MetricsService
    Counter Operations
      Î“ÃªÃœ should increment counter by default value of 1 (2 ms)
      Î“ÃªÃœ should increment counter by specified value
      Î“ÃªÃœ should accumulate multiple increments (1 ms)
      Î“ÃªÃœ should handle counters with tags
      Î“ÃªÃœ should return 0 for non-existent counter (1 ms)
    Histogram Operations
      Î“ÃªÃœ should record duration values (1 ms)
      Î“ÃªÃœ should calculate percentiles correctly (1 ms)
      Î“ÃªÃœ should handle single value histogram (1 ms)
      Î“ÃªÃœ should limit histogram size (2 ms)
      Î“ÃªÃœ should return undefined for non-existent histogram
    Gauge Operations
      Î“ÃªÃœ should set and get gauge value
      Î“ÃªÃœ should overwrite previous gauge value
      Î“ÃªÃœ should handle gauges with tags
      Î“ÃªÃœ should return undefined for non-existent gauge
    Snapshot Operations
      Î“ÃªÃœ should return complete metrics snapshot
      Î“ÃªÃœ should include timestamp in snapshot (1 ms)
    Reset Operations
      Î“ÃªÃœ should clear all metrics on reset
    Uptime Tracking
      Î“ÃªÃœ should track uptime in seconds (112 ms)
      Î“ÃªÃœ should reset uptime on reset (110 ms)
    Tag Handling
      Î“ÃªÃœ should sort tags consistently (13 ms)
      Î“ÃªÃœ should handle empty tags object

  console.error
    [2025-12-06T00:27:14.537Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:14.537Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:14.539Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:14.579Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/find-tool-minimization.test.ts
  Tool Discovery Token Minimization
    Schema Definition
      Î“ÃªÃœ should have includeExamples parameter with default false (2 ms)
      Î“ÃªÃœ should accept includeExamples: true (1 ms)
      Î“ÃªÃœ should accept includeExamples: false explicitly
      Î“ÃªÃœ should have token savings mentioned in description (1 ms)
    Response Format with includeExamples
      Î“ÃªÃœ should demonstrate response without exampleUsage when includeExamples is false (1 ms)
      Î“ÃªÃœ should demonstrate response with exampleUsage when includeExamples is true
    Token Savings Estimation
      Î“ÃªÃœ should demonstrate significant token savings per tool (1 ms)
      Î“ÃªÃœ should show cumulative savings with multiple tools
    Schema Validation
      Î“ÃªÃœ should maintain all required fields in schema (2 ms)
      Î“ÃªÃœ should reject invalid values (22 ms)
    Default Values
      Î“ÃªÃœ should apply correct defaults
    Integration with Tool Config
      Î“ÃªÃœ should be consistent with toolDiscoverySchema export (1 ms)

  console.error
    [2025-12-06T00:27:14.828Z] [ERROR] Network error during Azure CLI token acquisition (retries exhausted)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at AzureCliTokenProvider.createDetailedError (src/utils/azure-cli-token.ts:267:14)
      at AzureCliTokenProvider.getToken (src/utils/azure-cli-token.ts:84:18)
      at Object.<anonymous> (test/unit/azure-cli-token.test.ts:282:7)

  console.error
    [2025-12-06T00:27:14.845Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:14.845Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:14.849Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:14.852Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/azure-cli-token.test.ts (10.115 s)
  AzureCliTokenProvider
    Token acquisition
      Î“ÃªÃœ should acquire token successfully (3 ms)
      Î“ÃªÃœ should cache token and reuse if valid (1 ms)
      Î“ÃªÃœ should refresh token before expiration (1 ms)
      Î“ÃªÃœ should not cache expired token
      Î“ÃªÃœ should support custom tenant ID (1 ms)
      Î“ÃªÃœ should support custom scopes (1 ms)
    Error handling
      Î“ÃªÃœ should provide actionable error for not logged in (7 ms)
      Î“ÃªÃœ should provide actionable error for expired token (4 ms)
      Î“ÃªÃœ should provide actionable error for Azure CLI not installed (4 ms)
      Î“ÃªÃœ should provide actionable error for permission issues (3 ms)
      Î“ÃªÃœ should provide actionable error for network issues (3010 ms)
      Î“ÃªÃœ should handle null token from credential (17 ms)
    Retry logic
      Î“ÃªÃœ should retry on transient network errors (3023 ms)
      Î“ÃªÃœ should not retry on non-retryable auth errors (4 ms)
      Î“ÃªÃœ should exhaust retries on persistent transient errors (3014 ms)
    Cache management
      Î“ÃªÃœ should clear cache manually (3 ms)
      Î“ÃªÃœ should return token info when cached (1 ms)

  console.error
    [2025-12-06T00:27:15.001Z] [WARN] Batch size limit reached. Added 3/5 GET requests

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at BatchRequestBuilder.addGetRequests (src/utils/batch-request-builder.ts:94:16)
      at Object.<anonymous> (test/unit/batch-request-builder.test.ts:74:15)

  console.error
    [2025-12-06T00:27:15.053Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:15.053Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:15.055Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:15.057Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/batch-request-builder.test.ts
  BatchRequestBuilder
    constructor
      Î“ÃªÃœ should create builder with default batch size (1 ms)
      Î“ÃªÃœ should create builder with custom batch size (1 ms)
    addGetRequest
      Î“ÃªÃœ should add GET request without fields (1 ms)
      Î“ÃªÃœ should add GET request with fields
      Î“ÃªÃœ should throw when exceeding batch size (36 ms)
    addGetRequests
      Î“ÃªÃœ should add multiple GET requests
      Î“ÃªÃœ should stop adding when batch size reached (41 ms)
    addPatchRequest
      Î“ÃªÃœ should add PATCH request (1 ms)
    addPostRequest
      Î“ÃªÃœ should add POST request for work item creation
      Î“ÃªÃœ should URL encode work item type (1 ms)
    addCommentRequest
      Î“ÃªÃœ should add comment request
    addDeleteRequest
      Î“ÃªÃœ should add DELETE request (1 ms)
      Î“ÃªÃœ should add hard delete parameter
    build
      Î“ÃªÃœ should throw when building empty batch (1 ms)
      Î“ÃªÃœ should return immutable copy of requests
    clear
      Î“ÃªÃœ should clear all requests (1 ms)
    getOperationStats
      Î“ÃªÃœ should return operation breakdown
  splitIntoBatches
    Î“ÃªÃœ should split array into batches (1 ms)
    Î“ÃªÃœ should handle empty array
    Î“ÃªÃœ should handle array smaller than batch size
  validateBatchResponse
    Î“ÃªÃœ should validate valid batch response
    Î“ÃªÃœ should reject invalid response - missing count (1 ms)
    Î“ÃªÃœ should reject invalid response - missing value array
    Î“ÃªÃœ should reject invalid response - missing code in item
    Î“ÃªÃœ should reject null/undefined (1 ms)

  console.error
    [2025-12-06T00:27:15.605Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:15.605Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:15.606Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:15.608Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

  console.error
    [2025-12-06T00:27:15.670Z] [WARN] Area path "myorg" appears invalid - should be "ProjectName\AreaName" format

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at extractProjectFromAreaPath (src/config/config.ts:43:12)
      at Object.<anonymous> (test/unit/org-project-validation.test.ts:28:49)

  console.error
    [2025-12-06T00:27:15.712Z] [WARN] Î“ÃœÃ¡âˆ©â••Ã…  WARNING: Extracted project name "myorg" matches organization name "myorg"

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at loadConfiguration (src/config/config.ts:339:16)
      at Object.<anonymous> (test/unit/org-project-validation.test.ts:106:24)

  console.error
    [2025-12-06T00:27:15.714Z] [WARN] Î“ÃœÃ¡âˆ©â••Ã…  This is likely a configuration error. Did you mean to provide an area path like "myorg\\TeamName"?

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at loadConfiguration (src/config/config.ts:340:16)
      at Object.<anonymous> (test/unit/org-project-validation.test.ts:106:24)

  console.error
    [2025-12-06T00:27:15.716Z] [WARN] Î“ÃœÃ¡âˆ©â••Ã…  If "myorg" is both your organization AND project name, ignore this warning.

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at loadConfiguration (src/config/config.ts:341:16)
      at Object.<anonymous> (test/unit/org-project-validation.test.ts:106:24)

  console.error
    [2025-12-06T00:27:15.718Z] [WARN] Î“ÃœÃ¡âˆ©â••Ã…  WARNING: Extracted project name "myorg" matches organization name "myorg"

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at loadConfiguration (src/config/config.ts:339:16)
      at Object.<anonymous> (test/unit/org-project-validation.test.ts:109:39)

  console.error
    [2025-12-06T00:27:15.720Z] [WARN] Î“ÃœÃ¡âˆ©â••Ã…  This is likely a configuration error. Did you mean to provide an area path like "myorg\\TeamName"?

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at loadConfiguration (src/config/config.ts:340:16)
      at Object.<anonymous> (test/unit/org-project-validation.test.ts:109:39)

  console.error
    [2025-12-06T00:27:15.723Z] [WARN] Î“ÃœÃ¡âˆ©â••Ã…  If "myorg" is both your organization AND project name, ignore this warning.

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at loadConfiguration (src/config/config.ts:341:16)
      at Object.<anonymous> (test/unit/org-project-validation.test.ts:109:39)

PASS test/unit/validation-errors.test.ts
  Schema Validation Error Messages
    String validation with custom messages
      Î“ÃªÃœ should provide helpful error for empty string with min constraint (2 ms)
      Î“ÃªÃœ should provide helpful error for empty required string (1 ms)
    Number validation with custom messages
      Î“ÃªÃœ should provide helpful error for negative number when positive required (1 ms)
      Î“ÃªÃœ should provide helpful error for non-integer number
      Î“ÃªÃœ should provide helpful error for value exceeding max (1 ms)
      Î“ÃªÃœ should provide helpful error for value below min
      Î“ÃªÃœ should provide helpful error for negative skip value (1 ms)
    Enum validation with custom messages
      Î“ÃªÃœ should provide helpful error for invalid enum value with errorMap
      Î“ÃªÃœ should provide helpful error for invalid scale type (1 ms)
      Î“ÃªÃœ should provide helpful error for invalid format type (1 ms)
    Array validation with custom messages
      Î“ÃªÃœ should provide helpful error for array exceeding max length (1 ms)
      Î“ÃªÃœ should provide helpful error for empty array when min required
    Range constraints with helpful messages
      Î“ÃªÃœ should provide helpful error for sampleSize exceeding limit
      Î“ÃªÃœ should provide helpful error for maxIterations out of range
      Î“ÃªÃœ should provide helpful error for criteria count constraints
    buildValidationErrorResponse formatting
      Î“ÃªÃœ should format Zod errors with field paths and helpful tips (2 ms)
      Î“ÃªÃœ should handle single validation error
      Î“ÃªÃœ should include received value when available (1 ms)
      Î“ÃªÃœ should handle non-Zod errors gracefully
      Î“ÃªÃœ should format multiple field errors clearly (1 ms)

  console.error
    [2025-12-06T00:27:15.734Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:15.734Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:15.737Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:15.740Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/org-project-validation.test.ts
  Organization vs Project Name Validation
    extractProjectFromAreaPath
      Î“ÃªÃœ should extract project from valid area path (1 ms)
      Î“ÃªÃœ should extract project from two-segment area path (1 ms)
      Î“ÃªÃœ should handle single-segment path but warn (backward compatibility) (11 ms)
      Î“ÃªÃœ should return null for empty string (1 ms)
      Î“ÃªÃœ should handle area paths with multiple levels
    Configuration Validation - Invalid Area Path Format
      Î“ÃªÃœ should reject area path without backslash (organization-like format) (24 ms)
      Î“ÃªÃœ should reject area path that is just a simple name (2 ms)
      Î“ÃªÃœ should accept valid area path with backslash (3 ms)
    Configuration Validation - Organization vs Project Detection
      Î“ÃªÃœ should warn when extracted project matches organization name (14 ms)
      Î“ÃªÃœ should not warn when project differs from organization (1 ms)
    Error Messages
      Î“ÃªÃœ should provide helpful error message for invalid area path (1 ms)
      Î“ÃªÃœ should suggest correct format in error message
    Valid Configurations
      Î“ÃªÃœ should accept organization and valid area path (3 ms)
      Î“ÃªÃœ should accept multiple area paths from same project
      Î“ÃªÃœ should handle complex area path hierarchies (1 ms)

  console.error
    [2025-12-06T00:27:15.952Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:15.952Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at Object.<anonymous> (test/unit/item-context-enrichment.test.ts:13:1)

  console.error
    [2025-12-06T00:27:15.956Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at Object.<anonymous> (test/unit/item-context-enrichment.test.ts:13:1)

  console.error
    [2025-12-06T00:27:15.969Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/item-context-enrichment.test.ts
  Item Context Enrichment
    Rich itemContext storage
      Î“ÃªÃœ should store complete itemContext with all required fields (2 ms)
      Î“ÃªÃœ should handle lastChange fallback when substantive change unavailable (1 ms)
      Î“ÃªÃœ should parse tags from semicolon-separated string
      Î“ÃªÃœ should handle empty or missing tags (1 ms)
      Î“ÃªÃœ should maintain zero-based indices correctly (1 ms)
    Selection metadata generation
      Î“ÃªÃœ should generate selectionMetadata with correct structure
      Î“ÃªÃœ should deduplicate tags in criteriaTags (1 ms)
      Î“ÃªÃœ should handle items with no tags in metadata
    Default values for missing data
      Î“ÃªÃœ should use default values when context is missing (1 ms)
      Î“ÃªÃœ should use partial context when only some fields provided

  console.error
    [2025-12-06T00:27:16.168Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:16.168Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:16.170Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:16.172Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/get-pr-comments.test.ts
  get-pr-comments
    Schema Validation
      Î“ÃªÃœ should accept natural language description (1 ms)
      Î“ÃªÃœ should accept specific PR mode (1 ms)
      Î“ÃªÃœ should accept explicit search filters
      Î“ÃªÃœ should validate thread status filter values (1 ms)
      Î“ÃªÃœ should reject invalid thread status (1 ms)
      Î“ÃªÃœ should validate PR status enum (1 ms)
      Î“ÃªÃœ should reject invalid PR status
      Î“ÃªÃœ should accept pagination parameters (1 ms)
      Î“ÃªÃœ should validate maxPRsToFetch range (1 ms)
      Î“ÃªÃœ should accept boolean flags
      Î“ÃªÃœ should accept organization and project overrides
    Parameter Combinations
      Î“ÃªÃœ should allow description without pullRequestId (AI mode) (1 ms)
      Î“ÃªÃœ should allow pullRequestId without description (specific mode)
      Î“ÃªÃœ should allow explicit filters without description (search mode) (1 ms)
      Î“ÃªÃœ should allow thread filters with any mode
    Date Format
      Î“ÃªÃœ should accept valid ISO date strings
    Branch Reference Format
      Î“ÃªÃœ should accept full ref names (1 ms)

  console.error
    [2025-12-06T00:27:16.619Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:16.619Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:16.622Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:16.625Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

  console.error
    [2025-12-06T00:27:16.693Z] [INFO] [Cache] Caching disabled

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at CacheService.disable (src/services/cache-service.ts:298:12)
      at Object.<anonymous> (test/unit/cache-service.test.ts:193:20)

  console.error
    [2025-12-06T00:27:16.700Z] [INFO] [Cache] Caching disabled

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at CacheService.disable (src/services/cache-service.ts:298:12)
      at Object.<anonymous> (test/unit/cache-service.test.ts:200:20)

  console.error
    [2025-12-06T00:27:16.703Z] [INFO] [Cache] Caching enabled

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at CacheService.enable (src/services/cache-service.ts:289:12)
      at Object.<anonymous> (test/unit/cache-service.test.ts:201:20)

  console.error
    [2025-12-06T00:27:16.711Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:16.711Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:16.713Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:16.716Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/html-field-stripping.test.ts
  HTML Field Stripping Parameters
    Schema validation
      Î“ÃªÃœ should allow includeHtml parameter (2 ms)
      Î“ÃªÃœ should default includeHtml to false
      Î“ÃªÃœ should accept true for includeHtml (1 ms)

PASS test/unit/cache-service.test.ts
  CacheService
    Basic Operations
      Î“ÃªÃœ should store and retrieve values (2 ms)
      Î“ÃªÃœ should return null for non-existent keys
      Î“ÃªÃœ should check if key exists (1 ms)
      Î“ÃªÃœ should delete keys (1 ms)
      Î“ÃªÃœ should clear all entries
    TTL Expiration
      Î“ÃªÃœ should expire entries after TTL (158 ms)
      Î“ÃªÃœ should not expire before TTL (68 ms)
      Î“ÃªÃœ should use default TTL when not specified (1 ms)
    Size Limits
      Î“ÃªÃœ should evict oldest entry when max size reached (1 ms)
      Î“ÃªÃœ should report correct stats (1 ms)
    Data Types
      Î“ÃªÃœ should handle objects (1 ms)
      Î“ÃªÃœ should handle arrays
      Î“ÃªÃœ should handle null values
    Statistics
      Î“ÃªÃœ should track hits and misses (1 ms)
      Î“ÃªÃœ should track evictions
      Î“ÃªÃœ should reset statistics
    Pattern-Based Invalidation
      Î“ÃªÃœ should delete entries matching string pattern (1 ms)
      Î“ÃªÃœ should delete entries matching regex pattern (4 ms)
    Enable/Disable
      Î“ÃªÃœ should not cache when disabled (7 ms)
      Î“ÃªÃœ should cache when re-enabled (6 ms)
    Data Type TTLs
      Î“ÃªÃœ should use correct TTL for iterations (1 ms)
      Î“ÃªÃœ should use correct TTL for work item content
    Key Generation
      Î“ÃªÃœ should generate consistent keys (1 ms)
      Î“ÃªÃœ should handle undefined values (1 ms)

  console.error
    [2025-12-06T00:27:17.321Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:17.321Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at Object.<anonymous> (src/services/handlers/context/get-context-packages-by-query-handle.handler.ts:10:1)
      at Object.<anonymous> (test/unit/context-packages-by-handle.test.ts:10:1)

  console.error
    [2025-12-06T00:27:17.343Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at Object.<anonymous> (src/services/handlers/context/get-context-packages-by-query-handle.handler.ts:10:1)
      at Object.<anonymous> (test/unit/context-packages-by-handle.test.ts:10:1)

  console.error
    [2025-12-06T00:27:17.390Z] [INFO] Fetching context packages for 3 work items from query handle qh_325f5dba652bf9cbee65ad7ec01d952c

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleGetContextPackagesByQueryHandle (src/services/handlers/context/get-context-packages-by-query-handle.handler.ts:115:12)
      at Object.<anonymous> (test/unit/context-packages-by-handle.test.ts:89:65)

  console.error
    [2025-12-06T00:27:17.398Z] [INFO] Fetching context packages for 3 work items from query handle qh_97392bdeb4580c0441323f7ce3328af4

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleGetContextPackagesByQueryHandle (src/services/handlers/context/get-context-packages-by-query-handle.handler.ts:115:12)
      at Object.<anonymous> (test/unit/context-packages-by-handle.test.ts:117:65)

  console.error
    [2025-12-06T00:27:17.403Z] [INFO] Fetching context packages for 2 work items from query handle qh_3299e32bb34fcd2e25b83f98a24bd2e2

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleGetContextPackagesByQueryHandle (src/services/handlers/context/get-context-packages-by-query-handle.handler.ts:115:12)
      at Object.<anonymous> (test/unit/context-packages-by-handle.test.ts:144:65)

  console.error
    [2025-12-06T00:27:17.407Z] [INFO] Fetching context packages for 5 work items from query handle qh_871ac0c755e155d1ad6100e40191fb37

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleGetContextPackagesByQueryHandle (src/services/handlers/context/get-context-packages-by-query-handle.handler.ts:115:12)
      at Object.<anonymous> (test/unit/context-packages-by-handle.test.ts:173:65)

  console.error
    [2025-12-06T00:27:17.412Z] [INFO] Fetching context packages for 10 work items from query handle qh_1e3020e63be9c344360ceb251b700d80

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleGetContextPackagesByQueryHandle (src/services/handlers/context/get-context-packages-by-query-handle.handler.ts:115:12)
      at Object.<anonymous> (test/unit/context-packages-by-handle.test.ts:205:65)

  console.error
    [2025-12-06T00:27:17.416Z] [INFO] Fetching context packages for 1 work items from query handle qh_856fa9552286bc02fb4cdc5ce9fbd7c7

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleGetContextPackagesByQueryHandle (src/services/handlers/context/get-context-packages-by-query-handle.handler.ts:115:12)
      at Object.<anonymous> (test/unit/context-packages-by-handle.test.ts:234:50)

  console.error
    [2025-12-06T00:27:17.420Z] [INFO] Fetching context packages for 1 work items from query handle qh_a84163ace4269c840ea9405a2a78255a

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleGetContextPackagesByQueryHandle (src/services/handlers/context/get-context-packages-by-query-handle.handler.ts:115:12)
      at Object.<anonymous> (test/unit/context-packages-by-handle.test.ts:262:50)

  console.error
    [2025-12-06T00:27:17.424Z] [INFO] Fetching context packages for 1 work items from query handle qh_d35fccbe064b4ab8355ccb71d435a0ac

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleGetContextPackagesByQueryHandle (src/services/handlers/context/get-context-packages-by-query-handle.handler.ts:115:12)
      at Object.<anonymous> (test/unit/context-packages-by-handle.test.ts:288:50)

  console.error
    [2025-12-06T00:27:17.436Z] [INFO] Fetching context packages for 1 work items from query handle qh_254ec8ea2f1e9e4cf092371fbf82e1bd

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleGetContextPackagesByQueryHandle (src/services/handlers/context/get-context-packages-by-query-handle.handler.ts:115:12)
      at Object.<anonymous> (test/unit/context-packages-by-handle.test.ts:314:50)

  console.error
    [2025-12-06T00:27:17.442Z] [INFO] Fetching context packages for 1 work items from query handle qh_3f57f8411cfe17975661f10cc90fc8cc

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleGetContextPackagesByQueryHandle (src/services/handlers/context/get-context-packages-by-query-handle.handler.ts:115:12)
      at Object.<anonymous> (test/unit/context-packages-by-handle.test.ts:342:50)

  console.error
    [2025-12-06T00:27:17.450Z] [INFO] Fetching context packages for 3 work items from query handle qh_b036342e89f167eeac8990b9031b68ed

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleGetContextPackagesByQueryHandle (src/services/handlers/context/get-context-packages-by-query-handle.handler.ts:115:12)
      at Object.<anonymous> (test/unit/context-packages-by-handle.test.ts:441:65)

  console.error
    [2025-12-06T00:27:17.453Z] [WARN] Failed to fetch context package for work item 102: {"errors":["Failed to fetch item 102"]}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at src/services/handlers/context/get-context-packages-by-query-handle.handler.ts:148:18
          at async Promise.all (index 1)
      at handleGetContextPackagesByQueryHandle (src/services/handlers/context/get-context-packages-by-query-handle.handler.ts:165:28)
      at Object.<anonymous> (test/unit/context-packages-by-handle.test.ts:441:22)

  console.error
    [2025-12-06T00:27:17.456Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:17.456Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:17.458Z] [INFO] Fetching context packages for 2 work items from query handle qh_1487fd3dc3749d78cb83af89c591946f

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleGetContextPackagesByQueryHandle (src/services/handlers/context/get-context-packages-by-query-handle.handler.ts:115:12)
      at Object.<anonymous> (test/unit/context-packages-by-handle.test.ts:473:65)

  console.error
    [2025-12-06T00:27:17.459Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:17.462Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

  console.error
    [2025-12-06T00:27:17.463Z] [INFO] Fetching context packages for 1 work items from query handle qh_4edec93a78b1cbf0e70c3fc9e28df618

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleGetContextPackagesByQueryHandle (src/services/handlers/context/get-context-packages-by-query-handle.handler.ts:115:12)
      at Object.<anonymous> (test/unit/context-packages-by-handle.test.ts:498:65)

  console.error
    [2025-12-06T00:27:17.468Z] [INFO] Fetching context packages for 2 work items from query handle qh_96d0b1f8dab3c855ed05f9cd5637b6fe

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleGetContextPackagesByQueryHandle (src/services/handlers/context/get-context-packages-by-query-handle.handler.ts:115:12)
      at Object.<anonymous> (test/unit/context-packages-by-handle.test.ts:526:65)

  console.error
    [2025-12-06T00:27:17.471Z] [INFO] Fetching context packages for 2 work items from query handle qh_8d9738e8012d1c51d62d2506982738ca

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleGetContextPackagesByQueryHandle (src/services/handlers/context/get-context-packages-by-query-handle.handler.ts:115:12)
      at Object.<anonymous> (test/unit/context-packages-by-handle.test.ts:555:65)

  console.error
    [2025-12-06T00:27:17.488Z] [INFO] Fetching context packages for 2 work items from query handle qh_5742e74d8c7914e7b27749dc88fd1a00

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleGetContextPackagesByQueryHandle (src/services/handlers/context/get-context-packages-by-query-handle.handler.ts:115:12)
      at Object.<anonymous> (test/unit/context-packages-by-handle.test.ts:635:65)

  console.error
    [2025-12-06T00:27:17.493Z] [INFO] Fetching context packages for 1 work items from query handle qh_5af5ffc77415e4ec3bfdc93116a4428e

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleGetContextPackagesByQueryHandle (src/services/handlers/context/get-context-packages-by-query-handle.handler.ts:115:12)
      at Object.<anonymous> (test/unit/context-packages-by-handle.test.ts:665:50)

  console.error
    [2025-12-06T00:27:17.496Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/specialized-agent.test.ts
  Specialized Agent Assignment Schema
    assignToCopilotSchema
      Î“ÃªÃœ should accept valid input with specializedAgent (2 ms)
      Î“ÃªÃœ should accept valid input without specializedAgent (1 ms)
      Î“ÃªÃœ should reject invalid input (missing workItemId) (1 ms)
      Î“ÃªÃœ should reject invalid input (missing repository)

PASS test/unit/context-packages-by-handle.test.ts
  Get Context Packages By Query Handle Handler
    Basic retrieval
      Î“ÃªÃœ should retrieve context packages for all items (8 ms)
      Î“ÃªÃœ should retrieve context packages for selected indices (4 ms)
      Î“ÃªÃœ should retrieve context packages matching criteria (4 ms)
    Preview limiting
      Î“ÃªÃœ should limit to maxPreviewItems (5 ms)
      Î“ÃªÃœ should use default maxPreviewItems of 10 (5 ms)
    Optional parameters
      Î“ÃªÃœ should support includeHistory parameter (3 ms)
      Î“ÃªÃœ should support includeComments parameter (5 ms)
      Î“ÃªÃœ should support includeRelations parameter (11 ms)
      Î“ÃªÃœ should support includeChildren and includeParent parameters (6 ms)
      Î“ÃªÃœ should support includeExtendedFields parameter (4 ms)
    Error handling
      Î“ÃªÃœ should return error for invalid query handle
      Î“ÃªÃœ should return error when no items selected (1 ms)
      Î“ÃªÃœ should handle schema validation errors (1 ms)
      Î“ÃªÃœ should handle partial failures when fetching packages (8 ms)
    Selection summary
      Î“ÃªÃœ should include index-based selection summary (5 ms)
      Î“ÃªÃœ should include criteria-based selection summary (4 ms)
      Î“ÃªÃœ should include all selection summary (3 ms)
    Next steps guidance
      Î“ÃªÃœ should include helpful next steps (4 ms)
    Edge cases
      Î“ÃªÃœ should handle expired query handles (12 ms)
      Î“ÃªÃœ should handle empty query results
      Î“ÃªÃœ should handle maxPreviewItems larger than selection (5 ms)
    Configuration parameters
      Î“ÃªÃœ should use organization and project from parameters (3 ms)

  console.log
    \nÎ“Â£Ã  Filter logic test results:

      at Object.<anonymous> (test/unit/missing-description-filter.test.ts:69:13)

  console.log
    Expected items to be included: [1, 2, 3, 5]

      at Object.<anonymous> (test/unit/missing-description-filter.test.ts:70:13)

  console.log
    Actually included items: [1, 2, 3, 5]

      at Object.<anonymous> (test/unit/missing-description-filter.test.ts:71:13)

  console.log
      - #1: "Item with no description" (desc length: 0)

      at test/unit/missing-description-filter.test.ts:76:15
          at Array.forEach (<anonymous>)

  console.log
      - #2: "Item with empty description" (desc length: 0)

      at test/unit/missing-description-filter.test.ts:76:15
          at Array.forEach (<anonymous>)

  console.log
      - #3: "Item with short description" (desc length: 5)

      at test/unit/missing-description-filter.test.ts:76:15
          at Array.forEach (<anonymous>)

  console.log
      - #5: "Item with HTML description that is empty when stripped" (desc length: 0)

      at test/unit/missing-description-filter.test.ts:76:15
          at Array.forEach (<anonymous>)

  console.log
    \nÎ“Â£Ã  Edge cases test results:

      at Object.<anonymous> (test/unit/missing-description-filter.test.ts:131:13)

  console.log
      - #1: "Null description" (desc length: 0)

      at test/unit/missing-description-filter.test.ts:135:15
          at Array.forEach (<anonymous>)

  console.log
      - #2: "Undefined description" (desc length: 0)

      at test/unit/missing-description-filter.test.ts:135:15
          at Array.forEach (<anonymous>)

  console.log
      - #3: "Whitespace only description" (desc length: 4)

      at test/unit/missing-description-filter.test.ts:135:15
          at Array.forEach (<anonymous>)

  console.log
      - #4: "HTML with only whitespace" (desc length: 2)

      at test/unit/missing-description-filter.test.ts:135:15
          at Array.forEach (<anonymous>)

  console.log
      - #6: "Exactly 9 characters - should be filtered" (desc length: 9)

      at test/unit/missing-description-filter.test.ts:135:15
          at Array.forEach (<anonymous>)

  console.log
    \nâ‰¡Æ’Ã´Ã¯ Real-world scenario test:

      at Object.<anonymous> (test/unit/missing-description-filter.test.ts:198:13)

  console.log
    Items with good descriptions (should NOT be filtered): 1, 2, 4

      at Object.<anonymous> (test/unit/missing-description-filter.test.ts:199:13)

  console.log
    Items with missing descriptions (should be filtered): 3

      at Object.<anonymous> (test/unit/missing-description-filter.test.ts:200:13)

  console.log
    Actually filtered: [3]

      at Object.<anonymous> (test/unit/missing-description-filter.test.ts:201:13)

  console.log
    \nÎ“Â£Ã  Good descriptions test - none should be filtered:

      at Object.<anonymous> (test/unit/missing-description-filter.test.ts:241:13)

  console.log
      - #1: "Item with plain text description" (desc length: 117) - KEEP

      at test/unit/missing-description-filter.test.ts:245:15
          at Array.forEach (<anonymous>)

  console.error
    [2025-12-06T00:27:18.000Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:18.000Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.log
      - #2: "Item with HTML description" (desc length: 143) - KEEP

      at test/unit/missing-description-filter.test.ts:245:15
          at Array.forEach (<anonymous>)

  console.log
      - #3: "Item with mixed content" (desc length: 127) - KEEP

      at test/unit/missing-description-filter.test.ts:245:15
          at Array.forEach (<anonymous>)

  console.error
    [2025-12-06T00:27:18.002Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.log
    \nâ‰¡Æ’Ã¶Ã¬ Work item 35202849 scenario analysis:

      at Object.<anonymous> (test/unit/missing-description-filter.test.ts:300:13)

  console.log
      â‰¡Æ’Ã„Â» #35202849: Adequate HTML description

      at test/unit/missing-description-filter.test.ts:306:15
          at Array.forEach (<anonymous>)

  console.log
         Raw HTML: "<div><p>This item has a real description that should not be considered missing.</p></div>"

      at test/unit/missing-description-filter.test.ts:307:15
          at Array.forEach (<anonymous>)

  console.error
    [2025-12-06T00:27:18.006Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

  console.log
         Stripped: "This item has a real description that should not be considered missing." (71 chars)

      at test/unit/missing-description-filter.test.ts:308:15
          at Array.forEach (<anonymous>)

  console.log
         Would filter: NO Î“Â£Ã 

      at test/unit/missing-description-filter.test.ts:309:15
          at Array.forEach (<anonymous>)

  console.log
         #35202850: Very short HTML description (should be filtered)

      at test/unit/missing-description-filter.test.ts:306:15
          at Array.forEach (<anonymous>)

  console.log
         Raw HTML: "<p>Short</p>"

      at test/unit/missing-description-filter.test.ts:307:15
          at Array.forEach (<anonymous>)

  console.log
         Stripped: "Short" (5 chars)

      at test/unit/missing-description-filter.test.ts:308:15
          at Array.forEach (<anonymous>)

  console.log
         Would filter: YES Î“Â¥Ã®

      at test/unit/missing-description-filter.test.ts:309:15
          at Array.forEach (<anonymous>)

  console.log
         #35202851: Empty HTML tags (should be filtered)

      at test/unit/missing-description-filter.test.ts:306:15
          at Array.forEach (<anonymous>)

  console.log
         Raw HTML: "<div></div><p></p>"

      at test/unit/missing-description-filter.test.ts:307:15
          at Array.forEach (<anonymous>)

  console.log
         Stripped: "" (0 chars)

      at test/unit/missing-description-filter.test.ts:308:15
          at Array.forEach (<anonymous>)

  console.log
         Would filter: YES Î“Â¥Ã®

      at test/unit/missing-description-filter.test.ts:309:15
          at Array.forEach (<anonymous>)

  console.log
         #35202852: Exactly 10 characters (should NOT be filtered)

      at test/unit/missing-description-filter.test.ts:306:15
          at Array.forEach (<anonymous>)

  console.log
         Raw HTML: "<span>1234567890</span>"

      at test/unit/missing-description-filter.test.ts:307:15
          at Array.forEach (<anonymous>)

  console.log
         Stripped: "1234567890" (10 chars)

      at test/unit/missing-description-filter.test.ts:308:15
          at Array.forEach (<anonymous>)

  console.log
         Would filter: NO Î“Â£Ã 

      at test/unit/missing-description-filter.test.ts:309:15
          at Array.forEach (<anonymous>)

  console.log
         #35202853: Exactly 9 characters (should be filtered)

      at test/unit/missing-description-filter.test.ts:306:15
          at Array.forEach (<anonymous>)

  console.log
         Raw HTML: "<span>123456789</span>"

      at test/unit/missing-description-filter.test.ts:307:15
          at Array.forEach (<anonymous>)

  console.log
         Stripped: "123456789" (9 chars)

      at test/unit/missing-description-filter.test.ts:308:15
          at Array.forEach (<anonymous>)

  console.log
         Would filter: YES Î“Â¥Ã®

      at test/unit/missing-description-filter.test.ts:309:15
          at Array.forEach (<anonymous>)

  console.log
    \nÎ“Â£Ã  Work item 35202849 verification:

      at Object.<anonymous> (test/unit/missing-description-filter.test.ts:323:13)

  console.log
       Description: "This item has a real description that should not be considered missing."

      at Object.<anonymous> (test/unit/missing-description-filter.test.ts:324:13)

  console.log
       Length: 71 characters

      at Object.<anonymous> (test/unit/missing-description-filter.test.ts:325:13)

  console.log
       Should be filtered: NO

      at Object.<anonymous> (test/unit/missing-description-filter.test.ts:326:13)

  console.error
    [2025-12-06T00:27:18.044Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:18.044Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:18.047Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:18.050Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/resource-service.test.ts
  Resource Service
    listResources
      Î“ÃªÃœ should return all available resources (5 ms)
      Î“ÃªÃœ should include WIQL quick reference
      Î“ÃªÃœ should include OData quick reference (1 ms)
      Î“ÃªÃœ should include hierarchy patterns
      Î“ÃªÃœ should include common workflows
      Î“ÃªÃœ should include tool selection guide
    resourceExists
      Î“ÃªÃœ should return true for existing resources
      Î“ÃªÃœ should return false for non-existing resources (1 ms)
    getResourceContent
      Î“ÃªÃœ should throw error for non-existent resource (26 ms)
      Î“ÃªÃœ should return content for WIQL quick reference (11 ms)
      Î“ÃªÃœ should return content for OData quick reference (2 ms)
      Î“ÃªÃœ should return content for hierarchy patterns (1 ms)
      Î“ÃªÃœ should return content for common workflows (3 ms)
      Î“ÃªÃœ should return content for tool selection guide (1 ms)
      Î“ÃªÃœ WIQL reference should contain essential query patterns (1 ms)
      Î“ÃªÃœ OData reference should contain query types (1 ms)
      Î“ÃªÃœ tool selection guide should list all major tools (1 ms)

PASS test/unit/missing-description-filter.test.ts
  Missing Description Filter Logic
    Î“ÃªÃœ should correctly identify missing descriptions in test data (12 ms)
    Î“ÃªÃœ should handle edge cases correctly (9 ms)
    Î“ÃªÃœ should NOT include items with comprehensive descriptions (5 ms)
    Î“ÃªÃœ should NOT filter items with adequate descriptions (4 ms)
    Î“ÃªÃœ should handle work item 35202849 scenario correctly (23 ms)

  console.error
    [2025-12-06T00:27:18.582Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:18.582Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:18.585Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:18.587Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

  console.error
    [2025-12-06T00:27:18.619Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:18.619Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:18.620Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:18.622Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/odata-area-path-escaping.test.ts
  OData Area Path Escaping
    escapeAreaPathForOData
      Î“ÃªÃœ should escape backslashes in area paths (1 ms)
      Î“ÃªÃœ should escape single quotes in area paths (1 ms)
      Î“ÃªÃœ should escape both backslashes and single quotes
      Î“ÃªÃœ should handle simple project path
      Î“ÃªÃœ should handle deeply nested paths
      Î“ÃªÃœ should handle empty string
      Î“ÃªÃœ should handle path with only backslashes
      Î“ÃªÃœ should handle path with only quotes (1 ms)
      Î“ÃªÃœ should handle mixed special characters
    WIQL vs OData Escaping Differences
      Î“ÃªÃœ WIQL should NOT escape backslashes
      Î“ÃªÃœ WIQL should escape single quotes
      Î“ÃªÃœ OData and WIQL produce different output for paths with backslashes
    OData Query Construction
      Î“ÃªÃœ should build valid OData startswith filter (1 ms)
      Î“ÃªÃœ should build valid OData filter with quotes
      Î“ÃªÃœ should build complete OData query string
    WIQL Query Construction
      Î“ÃªÃœ should build valid WIQL UNDER clause (1 ms)
      Î“ÃªÃœ should build valid WIQL clause with quotes
    Real-world Examples
      Î“ÃªÃœ should handle Azure DevOps common path pattern
      Î“ÃªÃœ should handle path from audit_results.md example (1 ms)
    Edge Cases
      Î“ÃªÃœ should handle null input
      Î“ÃªÃœ should handle undefined input
      Î“ÃªÃœ should handle trailing backslash
      Î“ÃªÃœ should handle leading backslash (1 ms)
      Î“ÃªÃœ should handle consecutive backslashes
      Î“ÃªÃœ should handle path with Unicode characters

PASS test/unit/markdown-converter.test.ts
  Markdown Converter
    convertMarkdownToHtml
      Î“ÃªÃœ should convert headers (1 ms)
      Î“ÃªÃœ should convert bold text (1 ms)
      Î“ÃªÃœ should convert italic text
      Î“ÃªÃœ should convert lists
      Î“ÃªÃœ should convert code blocks (1 ms)
      Î“ÃªÃœ should convert links
      Î“ÃªÃœ should handle empty input (1 ms)
      Î“ÃªÃœ should convert line breaks with GFM enabled
    isMarkdown
      Î“ÃªÃœ should detect markdown headers (1 ms)
      Î“ÃªÃœ should detect markdown bold
      Î“ÃªÃœ should detect markdown italic
      Î“ÃªÃœ should detect markdown lists
      Î“ÃªÃœ should detect markdown links
      Î“ÃªÃœ should detect markdown code (1 ms)
      Î“ÃªÃœ should detect markdown blockquotes
      Î“ÃªÃœ should detect markdown tables
      Î“ÃªÃœ should return false for plain text
      Î“ÃªÃœ should return false for HTML (1 ms)
      Î“ÃªÃœ should handle empty input
    smartConvertToHtml
      Î“ÃªÃœ should convert markdown to HTML
      Î“ÃªÃœ should return HTML as-is (1 ms)
      Î“ÃªÃœ should wrap plain text in paragraph tags
      Î“ÃªÃœ should handle empty input
      Î“ÃªÃœ should escape HTML in plain text
    Azure DevOps specific use cases
      Î“ÃªÃœ should handle typical work item descriptions
      Î“ÃªÃœ should handle acceptance criteria (1 ms)
      Î“ÃªÃœ should handle code snippets in descriptions

  console.error
    [2025-12-06T00:27:18.950Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:18.950Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at Object.<anonymous> (src/services/handlers/bulk-operations/bulk-link-handler.ts:14:1)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:10:1)

  console.error
    [2025-12-06T00:27:18.963Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at Object.<anonymous> (src/services/handlers/bulk-operations/bulk-link-handler.ts:14:1)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:10:1)

  console.error
    [2025-12-06T00:27:18.978Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:18.978Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at Object.<anonymous> (src/services/handlers/query-handles/query-handle-info-handler.ts:14:1)
      at Object.<anonymous> (test/unit/query-handle-info.test.ts:9:1)

  console.error
    [2025-12-06T00:27:18.989Z] [INFO] Bulk link operation: 3 source(s) â”œÃ¹ 3 target(s) using one-to-one strategy

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:417:12)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:103:56)

  console.error
    [2025-12-06T00:27:18.989Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at Object.<anonymous> (src/services/handlers/query-handles/query-handle-info-handler.ts:14:1)
      at Object.<anonymous> (test/unit/query-handle-info.test.ts:9:1)

  console.error
    [2025-12-06T00:27:18.993Z] [INFO] Bulk link operation: 1 source(s) â”œÃ¹ 3 target(s) using one-to-many strategy

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:417:12)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:143:56)

  console.error
    [2025-12-06T00:27:18.996Z] [INFO] Bulk link operation: 3 source(s) â”œÃ¹ 1 target(s) using many-to-one strategy

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:417:12)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:182:56)

  console.error
    [2025-12-06T00:27:19.000Z] [INFO] Bulk link operation: 2 source(s) â”œÃ¹ 2 target(s) using many-to-many strategy

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:417:12)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:221:56)

  console.error
    [2025-12-06T00:27:19.003Z] [INFO] Bulk link operation: 1 source(s) â”œÃ¹ 1 target(s) using one-to-one strategy

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:417:12)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:252:56)

  console.error
    [2025-12-06T00:27:19.006Z] [INFO] Bulk link operation: 1 source(s) â”œÃ¹ 1 target(s) using one-to-one strategy

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:417:12)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:278:56)

  console.error
    [2025-12-06T00:27:19.006Z] [INFO] Getting info for query handle: qh_4c0f48972378ccc678b3e62c4be150ac (3 items, detailed=false)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleQueryHandleInfo (src/services/handlers/query-handles/query-handle-info-handler.ts:76:12)
      at Object.<anonymous> (test/unit/query-handle-info.test.ts:150:49)

  console.error
    [2025-12-06T00:27:19.009Z] [INFO] Bulk link operation: 1 source(s) â”œÃ¹ 1 target(s) using one-to-one strategy

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:417:12)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:304:56)

  console.error
    [2025-12-06T00:27:19.011Z] [INFO] Bulk link operation: 1 source(s) â”œÃ¹ 1 target(s) using one-to-one strategy

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:417:12)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:330:56)

  console.error
    [2025-12-06T00:27:19.014Z] [INFO] Bulk link operation: 2 source(s) â”œÃ¹ 2 target(s) using many-to-one strategy

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:417:12)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:361:56)

  console.error
    [2025-12-06T00:27:19.017Z] [INFO] Bulk link operation: 2 source(s) â”œÃ¹ 2 target(s) using one-to-many strategy

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:417:12)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:391:56)

  console.error
    [2025-12-06T00:27:19.012Z] [INFO] Getting info for query handle: qh_5bee213296b5f173edf00d85cf36caee (3 items, detailed=false)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleQueryHandleInfo (src/services/handlers/query-handles/query-handle-info-handler.ts:76:12)
      at Object.<anonymous> (test/unit/query-handle-info.test.ts:177:49)

  console.error
    [2025-12-06T00:27:19.020Z] [INFO] Bulk link operation: 2 source(s) â”œÃ¹ 2 target(s) using one-to-one strategy

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:417:12)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:418:56)

  console.error
    [2025-12-06T00:27:19.023Z] [INFO] Getting info for query handle: qh_2a2a62966ee766cd4c430ded383dfbc7 (3 items, detailed=false)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleQueryHandleInfo (src/services/handlers/query-handles/query-handle-info-handler.ts:76:12)
      at Object.<anonymous> (test/unit/query-handle-info.test.ts:199:49)

  console.error
    [2025-12-06T00:27:19.023Z] [INFO] Bulk link operation: 2 source(s) â”œÃ¹ 2 target(s) using one-to-one strategy

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:417:12)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:452:56)

  console.error
    [2025-12-06T00:27:19.026Z] [INFO] Getting info for query handle: qh_d1dfbe58e23f905cdc9b177205fc1796 (3 items, detailed=false)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleQueryHandleInfo (src/services/handlers/query-handles/query-handle-info-handler.ts:76:12)
      at Object.<anonymous> (test/unit/query-handle-info.test.ts:214:49)

  console.error
    [2025-12-06T00:27:19.026Z] [INFO] Bulk link operation: 10 source(s) â”œÃ¹ 10 target(s) using one-to-one strategy

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:417:12)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:480:56)

  console.error
    [2025-12-06T00:27:19.028Z] [INFO] Getting info for query handle: qh_735eecd921a7682b68260e1b161afbdf (3 items, detailed=false)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleQueryHandleInfo (src/services/handlers/query-handles/query-handle-info-handler.ts:76:12)
      at Object.<anonymous> (test/unit/query-handle-info.test.ts:230:49)

  console.error
    [2025-12-06T00:27:19.029Z] [INFO] Bulk link operation: 2 source(s) â”œÃ¹ 2 target(s) using one-to-one strategy

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:417:12)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:519:56)

  console.error
    [2025-12-06T00:27:19.031Z] [INFO] Getting info for query handle: qh_77bb2771291b6919b93b4a472fd95ec5 (3 items, detailed=true)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleQueryHandleInfo (src/services/handlers/query-handles/query-handle-info-handler.ts:76:12)
      at Object.<anonymous> (test/unit/query-handle-info.test.ts:246:49)

  console.error
    [2025-12-06T00:27:19.031Z] [INFO] Batch checking for existing links before creation

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:578:14)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:519:56)

  console.error
    [2025-12-06T00:27:19.033Z] [INFO] Getting info for query handle: qh_82b5ae1d84513446c8c54e84117d3b6a (3 items, detailed=true)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleQueryHandleInfo (src/services/handlers/query-handles/query-handle-info-handler.ts:76:12)
      at Object.<anonymous> (test/unit/query-handle-info.test.ts:262:49)

  console.error
    [2025-12-06T00:27:19.034Z] [INFO] Batch checking existing links for 2 source work items

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at batchCheckExistingLinks (src/services/handlers/bulk-operations/bulk-link-handler.ts:157:10)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:580:34)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:519:56)

  console.error
    [2025-12-06T00:27:19.037Z] [INFO] Getting info for query handle: qh_765786fc9edcb57ea7cf176e77c50144 (3 items, detailed=true)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleQueryHandleInfo (src/services/handlers/query-handles/query-handle-info-handler.ts:76:12)
      at Object.<anonymous> (test/unit/query-handle-info.test.ts:280:49)

  console.error
    [2025-12-06T00:27:19.040Z] [INFO] Getting info for query handle: qh_073ba35e3cf5ed5877de4e93fcae04db (3 items, detailed=true)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleQueryHandleInfo (src/services/handlers/query-handles/query-handle-info-handler.ts:76:12)
      at Object.<anonymous> (test/unit/query-handle-info.test.ts:296:49)

  console.error
    [2025-12-06T00:27:19.044Z] [INFO] Getting info for query handle: qh_94b9e45f568b4dfac8548fc80f57b412 (3 items, detailed=true)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleQueryHandleInfo (src/services/handlers/query-handles/query-handle-info-handler.ts:76:12)
      at Object.<anonymous> (test/unit/query-handle-info.test.ts:312:49)

  console.error
    [2025-12-06T00:27:19.049Z] [INFO] Getting info for query handle: qh_3e734d6441dd64e0e34bb8d1a0e4d013 (1 items, detailed=false)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleQueryHandleInfo (src/services/handlers/query-handles/query-handle-info-handler.ts:76:12)
      at Object.<anonymous> (test/unit/query-handle-info.test.ts:360:49)

  console.error
    [2025-12-06T00:27:19.054Z] [INFO] Getting info for query handle: qh_6ebff362959d07be5fe70d5c92947c70 (3 items, detailed=false)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleQueryHandleInfo (src/services/handlers/query-handles/query-handle-info-handler.ts:76:12)
      at Object.<anonymous> (test/unit/query-handle-info.test.ts:374:49)

  console.error
    [2025-12-06T00:27:19.058Z] [INFO] Getting info for query handle: qh_9ed8b931b386e15888532c8a4ae451ac (3 items, detailed=true)

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleQueryHandleInfo (src/services/handlers/query-handles/query-handle-info-handler.ts:76:12)
      at Object.<anonymous> (test/unit/query-handle-info.test.ts:389:49)

  console.error
    [2025-12-06T00:27:19.061Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

  console.error
    [2025-12-06T00:27:19.057Z] [ERROR] Batch check existing links failed: {"message":"response.data.value is not iterable","name":"TypeError","stack":"TypeError: response.data.value is not iterable\n    at batchCheckExistingLinks (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\bulk-link-handler.ts:172:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at handleBulkLinkByQueryHandles (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\bulk-link-handler.ts:580:28)\n    at Object.<anonymous> (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\test\\unit\\bulk-link-work-items.test.ts:519:22)"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at batchCheckExistingLinks (src/services/handlers/bulk-operations/bulk-link-handler.ts:207:12)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:580:28)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:519:22)

  console.error
    [2025-12-06T00:27:19.068Z] [WARN] Batch check failed or returned no results, will fall back to individual checks

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:585:16)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:519:22)

  console.error
    [2025-12-06T00:27:19.071Z] [INFO] Bulk link operation: 2 source(s) â”œÃ¹ 2 target(s) using one-to-one strategy

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:417:12)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:557:56)

  console.error
    [2025-12-06T00:27:19.073Z] [INFO] Batch checking for existing links before creation

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:578:14)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:557:56)

  console.error
    [2025-12-06T00:27:19.074Z] [INFO] Batch checking existing links for 2 source work items

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at batchCheckExistingLinks (src/services/handlers/bulk-operations/bulk-link-handler.ts:157:10)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:580:34)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:557:56)

  console.error
    [2025-12-06T00:27:19.077Z] [ERROR] Batch check existing links failed: {"message":"response.data.value is not iterable","name":"TypeError","stack":"TypeError: response.data.value is not iterable\n    at batchCheckExistingLinks (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\bulk-link-handler.ts:172:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at handleBulkLinkByQueryHandles (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\bulk-link-handler.ts:580:28)\n    at Object.<anonymous> (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\test\\unit\\bulk-link-work-items.test.ts:557:22)"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at batchCheckExistingLinks (src/services/handlers/bulk-operations/bulk-link-handler.ts:207:12)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:580:28)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:557:22)

  console.error
    [2025-12-06T00:27:19.078Z] [WARN] Batch check failed or returned no results, will fall back to individual checks

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:585:16)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:557:22)

  console.error
    [2025-12-06T00:27:19.087Z] [ERROR] Failed to create link 102 -> 202: {"message":"Link creation failed","name":"Error","stack":"Error: Link creation failed\n    at Object.<anonymous> (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\test\\unit\\bulk-link-work-items.test.ts:537:32)\n    at Promise.then.completed (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:640:16)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:557:22)

  console.error
    [2025-12-06T00:27:19.089Z] [INFO] Bulk link operation: 1 source(s) â”œÃ¹ 1 target(s) using one-to-one strategy

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:417:12)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:600:56)

  console.error
    [2025-12-06T00:27:19.091Z] [INFO] Batch checking for existing links before creation

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:578:14)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:600:56)

  console.error
    [2025-12-06T00:27:19.093Z] [INFO] Batch checking existing links for 1 source work items

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at batchCheckExistingLinks (src/services/handlers/bulk-operations/bulk-link-handler.ts:157:10)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:580:34)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:600:56)

  console.error
    [2025-12-06T00:27:19.095Z] [ERROR] Batch check existing links failed: {"message":"response.data.value is not iterable","name":"TypeError","stack":"TypeError: response.data.value is not iterable\n    at batchCheckExistingLinks (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\bulk-link-handler.ts:172:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at handleBulkLinkByQueryHandles (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\src\\services\\handlers\\bulk-operations\\bulk-link-handler.ts:580:28)\n    at Object.<anonymous> (C:\\Users\\ameliapayne\\ADO-Work-Item-MSP\\mcp_server\\test\\unit\\bulk-link-work-items.test.ts:600:22)"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at batchCheckExistingLinks (src/services/handlers/bulk-operations/bulk-link-handler.ts:207:12)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:580:28)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:600:22)

  console.error
    [2025-12-06T00:27:19.096Z] [WARN] Batch check failed or returned no results, will fall back to individual checks

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:585:16)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:600:22)

  console.error
    [2025-12-06T00:27:19.100Z] [INFO] Bulk link operation: 1 source(s) â”œÃ¹ 1 target(s) using one-to-one strategy

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:417:12)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:630:56)

  console.error
    [2025-12-06T00:27:19.104Z] [INFO] Bulk link operation: 1 source(s) â”œÃ¹ 1 target(s) using one-to-one strategy

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:417:12)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:658:56)

  console.error
    [2025-12-06T00:27:19.109Z] [INFO] Bulk link operation: 3 source(s) â”œÃ¹ 1 target(s) using one-to-one strategy

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:417:12)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:821:56)

  console.error
    [2025-12-06T00:27:19.112Z] [INFO] Bulk link operation: 1 source(s) â”œÃ¹ 1 target(s) using one-to-one strategy

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkLinkByQueryHandles (src/services/handlers/bulk-operations/bulk-link-handler.ts:417:12)
      at Object.<anonymous> (test/unit/bulk-link-work-items.test.ts:844:56)

  console.error
    [2025-12-06T00:27:19.114Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/query-handle-info.test.ts
  Query Handle Info Handler
    Basic Mode (detailed=false)
      Î“ÃªÃœ should return basic inspection data by default (7 ms)
      Î“ÃªÃœ should include item preview by default (12 ms)
      Î“ÃªÃœ should include selection hints (3 ms)
      Î“ÃªÃœ should include statistics when includeStats=true (2 ms)
      Î“ÃªÃœ should NOT include validation or selection analysis in basic mode (2 ms)
    Detailed Mode (detailed=true)
      Î“ÃªÃœ should include validation data when detailed=true (3 ms)
      Î“ÃªÃœ should include selection analysis when detailed=true and itemSelector provided (3 ms)
      Î“ÃªÃœ should handle "all" itemSelector (4 ms)
      Î“ÃªÃœ should handle criteria-based itemSelector (3 ms)
      Î“ÃªÃœ should fetch sample items when detailed=true and includeSampleItems=true (4 ms)
    Error Handling
      Î“ÃªÃœ should return error for invalid query handle (1 ms)
      Î“ÃªÃœ should return validation error for missing queryHandle (1 ms)
    Expiration Warnings
      Î“ÃªÃœ should warn when query handle is about to expire (4 ms)
    Metadata
      Î“ÃªÃœ should include correct metadata (3 ms)
      Î“ÃªÃœ should reflect detailed mode in metadata (3 ms)

PASS test/unit/bulk-link-work-items.test.ts
  Bulk Link Work Items Handler
    Link strategies
      Î“ÃªÃœ should create one-to-one links (8 ms)
      Î“ÃªÃœ should create one-to-many links (3 ms)
      Î“ÃªÃœ should create many-to-one links (3 ms)
      Î“ÃªÃœ should create many-to-many links (3 ms)
    Link types
      Î“ÃªÃœ should support Parent link type (3 ms)
      Î“ÃªÃœ should support Child link type (3 ms)
      Î“ÃªÃœ should support Related link type (3 ms)
      Î“ÃªÃœ should support dependency link types (2 ms)
    Item selection
      Î“ÃªÃœ should support source item selector (3 ms)
      Î“ÃªÃœ should support target item selector (3 ms)
      Î“ÃªÃœ should support index-based selectors (4 ms)
    Dry run mode
      Î“ÃªÃœ should show preview without creating links (3 ms)
      Î“ÃªÃœ should limit preview to maxPreviewItems (3 ms)
    Execution mode
      Î“ÃªÃœ should create links successfully (41 ms)
      Î“ÃªÃœ should handle partial failures (19 ms)
      Î“ÃªÃœ should skip existing links when skipExisting=true (10 ms)
    Link validation
      Î“ÃªÃœ should validate hierarchical link types (4 ms)
      Î“ÃªÃœ should allow valid hierarchical relationships (2 ms)
    Error handling
      Î“ÃªÃœ should return error for invalid source query handle (1 ms)
      Î“ÃªÃœ should return error for invalid target query handle
      Î“ÃªÃœ should return error when Azure CLI not available (1 ms)
      Î“ÃªÃœ should handle invalid link type
      Î“ÃªÃœ should return error when no source items selected (1 ms)
      Î“ÃªÃœ should return error when no target items selected
    Edge cases
      Î“ÃªÃœ should handle mismatched counts in one-to-one strategy (2 ms)
      Î“ÃªÃœ should handle self-referencing links (3 ms)

  console.error
    [2025-12-06T00:27:19.460Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:19.460Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:19.464Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:19.466Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

  console.error
    [2025-12-06T00:27:19.538Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:19.538Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:19.540Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:19.542Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/add-pr-comment.test.ts
  add-pr-comment
    Schema Validation
      Î“ÃªÃœ should accept required parameters only (2 ms)
      Î“ÃªÃœ should accept comment with Copilot mention (1 ms)
      Î“ÃªÃœ should accept comment with explicit Copilot GUID (1 ms)
      Î“ÃªÃœ should accept line-specific comment with thread context
      Î“ÃªÃœ should accept thread context with offset
      Î“ÃªÃœ should accept custom Copilot display name
      Î“ÃªÃœ should reject missing repository (1 ms)
      Î“ÃªÃœ should reject missing pull request ID
      Î“ÃªÃœ should reject missing comment text
      Î“ÃªÃœ should reject empty comment text (1 ms)
      Î“ÃªÃœ should reject invalid PR ID (negative)
      Î“ÃªÃœ should reject invalid PR ID (zero)
      Î“ÃªÃœ should reject invalid line number (negative)
      Î“ÃªÃœ should reject invalid line number (zero)
      Î“ÃªÃœ should reject invalid offset (negative) (1 ms)
      Î“ÃªÃœ should reject invalid offset (zero) - offset must be >= 1
      Î“ÃªÃœ should accept organization and project overrides (1 ms)
    Mention Format
      Î“ÃªÃœ should generate correct HTML mention format
      Î“ÃªÃœ should prepend mention to comment text (1 ms)

PASS test/unit/history-stripping.test.ts
  History Stripping Parameters
    Schema Defaults
      Î“ÃªÃœ should default includeHistory to false (2 ms)
      Î“ÃªÃœ should default maxHistoryRevisions to 3 (1 ms)
      Î“ÃªÃœ should allow overriding includeHistory to true
      Î“ÃªÃœ should allow custom maxHistoryRevisions value
    Parameter Behavior
      Î“ÃªÃœ should accept maxHistoryRevisions parameter without error
      Î“ÃªÃœ should not accept historyCount parameter (old name)
    Context Window Optimization
      Î“ÃªÃœ should describe history as optimized for context window efficiency (1 ms)
      Î“ÃªÃœ should describe maxHistoryRevisions context optimization
    Integration with other parameters
      Î“ÃªÃœ should work correctly with all parameters
    Backward Compatibility Considerations
      Î“ÃªÃœ should handle explicit includeHistory: false (1 ms)
      Î“ÃªÃœ should handle explicit includeHistory: true with defaults

  console.error
    [2025-12-06T00:27:19.832Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:19.832Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at Object.<anonymous> (test/unit/query-handle-service.test.ts:9:1)

  console.error
    [2025-12-06T00:27:19.838Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at Object.<anonymous> (test/unit/query-handle-service.test.ts:9:1)

  console.error
    [2025-12-06T00:27:19.852Z] [WARN] Query handle 'qh_nonexistent' not found. Server started at 2025-12-06T00:27:19.832Z. Currently tracking 0 active handles. Note: Handles are lost if MCP server restarts.

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at QueryHandleService.getWorkItemIds (src/services/query-handle-service.ts:215:14)
      at Object.<anonymous> (test/unit/query-handle-service.test.ts:108:44)

  console.error
    [2025-12-06T00:27:19.879Z] [WARN] Query handle 'qh_de39951eb795ffc8ae511bb9d308d3e8' expired. Created at 2025-12-06T00:27:19.855Z, expired at 2025-12-06T00:27:19.856Z, age: 0 minutes

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at QueryHandleService.getWorkItemIds (src/services/query-handle-service.ts:225:14)
      at Timeout._onTimeout (test/unit/query-handle-service.test.ts:119:48)

  console.error
    [2025-12-06T00:27:19.883Z] [WARN] Query handle 'qh_d63a54bfe92d92e2011baf5433fd3803' not found. Server started at 2025-12-06T00:27:19.832Z. Currently tracking 0 active handles. Note: Handles are lost if MCP server restarts.

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at QueryHandleService.getWorkItemIds (src/services/query-handle-service.ts:215:14)
      at Object.<anonymous> (test/unit/query-handle-service.test.ts:152:44)

  console.error
    [2025-12-06T00:27:19.890Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:19.890Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at Object.<anonymous> (test/unit/query-handle-selection.test.ts:7:1)

  console.error
    [2025-12-06T00:27:19.897Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at Object.<anonymous> (test/unit/query-handle-selection.test.ts:7:1)

  console.error
    [2025-12-06T00:27:19.929Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

  console.error
    [2025-12-06T00:27:19.941Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/query-handle-selection.test.ts
  Query Handle Selection Integration Tests
    Index-based Selection
      Î“ÃªÃœ should select items by zero-based indices (1 ms)
      Î“ÃªÃœ should handle out-of-bounds indices gracefully (1 ms)
      Î“ÃªÃœ should handle empty index array
      Î“ÃªÃœ should return null for invalid handle (1 ms)
      Î“ÃªÃœ should filter out negative indices
      Î“ÃªÃœ should handle duplicate indices
      Î“ÃªÃœ should handle selection from empty query result (1 ms)
    Criteria-based Selection
      Î“ÃªÃœ should filter by state
      Î“ÃªÃœ should filter by tags (1 ms)
      Î“ÃªÃœ should filter by title keywords
      Î“ÃªÃœ should filter by staleness (daysInactive) (1 ms)
      Î“ÃªÃœ should combine multiple criteria with AND logic
      Î“ÃªÃœ should return null for invalid handle
      Î“ÃªÃœ should return empty array when criteria matches no items
      Î“ÃªÃœ should filter by multiple states (1 ms)
      Î“ÃªÃœ should filter by multiple tags
      Î“ÃªÃœ should filter by daysInactiveMin only
      Î“ÃªÃœ should filter by daysInactiveMax only
      Î“ÃªÃœ should return all items when empty criteria is provided
      Î“ÃªÃœ should handle special characters in title search (1 ms)
      Î“ÃªÃœ should handle tags with spaces and special characters
      Î“ÃªÃœ should handle case-insensitive title search (1 ms)
      Î“ÃªÃœ should handle case-insensitive tag search
    Unified Item Selector Resolution
      Î“ÃªÃœ should handle "all" selector (1 ms)
      Î“ÃªÃœ should handle index array selector
      Î“ÃªÃœ should handle criteria object selector (1 ms)
      Î“ÃªÃœ should return null for invalid handle
      Î“ÃªÃœ should handle invalid selector type gracefully (1 ms)
    Edge Cases and Expiration
      Î“ÃªÃœ should return null for expired handles
      Î“ÃªÃœ should handle selection with missing itemContext gracefully
    Performance Tests
      Î“ÃªÃœ should handle selection from large itemContext (1000+ items) (2 ms)
      Î“ÃªÃœ should handle complex criteria with many conditions on large dataset (2 ms)
      Î“ÃªÃœ should handle index array with many indices (1 ms)
      Î“ÃªÃœ should efficiently filter large datasets with criteria (3 ms)

PASS test/unit/query-handle-service.test.ts
  Query Handle Service
    storeQuery
      Î“ÃªÃœ should generate unique handles (2 ms)
      Î“ÃªÃœ should store work item IDs (1 ms)
      Î“ÃªÃœ should store metadata
    getWorkItemIds
      Î“ÃªÃœ should retrieve stored work item IDs
      Î“ÃªÃœ should return null for non-existent handle (3 ms)
      Î“ÃªÃœ should return null for expired handle (27 ms)
    getQueryData
      Î“ÃªÃœ should return full query data (1 ms)
    deleteHandle
      Î“ÃªÃœ should delete handle (2 ms)
      Î“ÃªÃœ should return false for non-existent handle
    getStats
      Î“ÃªÃœ should return accurate statistics (26 ms)
    cleanup
      Î“ÃªÃœ should remove expired handles (15 ms)
    TTL behavior
      Î“ÃªÃœ should use default TTL (24 hours) (1 ms)
      Î“ÃªÃœ should use custom TTL (1 ms)
    clearAll
      Î“ÃªÃœ should remove all handles (1 ms)
    itemSelector functionality
      getItemsByIndices
        Î“ÃªÃœ should return work items by indices
        Î“ÃªÃœ should filter invalid indices (1 ms)
        Î“ÃªÃœ should return empty array for all invalid indices
        Î“ÃªÃœ should return null for invalid handle
      getItemsByCriteria
        Î“ÃªÃœ should filter by states
        Î“ÃªÃœ should filter by daysInactive range (1 ms)
        Î“ÃªÃœ should filter by title contains
        Î“ÃªÃœ should filter by tags
        Î“ÃªÃœ should combine multiple criteria (1 ms)
        Î“ÃªÃœ should return empty array when no items match
        Î“ÃªÃœ should return null for invalid handle
      getSelectableIndices
        Î“ÃªÃœ should return selectable indices (1 ms)
        Î“ÃªÃœ should return null for invalid handle
      getItemContext
        Î“ÃªÃœ should return item context by index (1 ms)
        Î“ÃªÃœ should return item context for different indices
        Î“ÃªÃœ should return null for out-of-bounds index (1 ms)
        Î“ÃªÃœ should return null for negative index
        Î“ÃªÃœ should return null for invalid handle
      resolveItemSelector
        Î“ÃªÃœ should resolve "all" selector
        Î“ÃªÃœ should resolve index array selector (1 ms)
        Î“ÃªÃœ should resolve criteria selector
        Î“ÃªÃœ should return null for invalid handle
      itemContext creation
        Î“ÃªÃœ should create itemContext array from workItemContext
        Î“ÃªÃœ should create selectionMetadata (1 ms)

  console.error
    [2025-12-06T00:27:20.515Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:20.515Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:20.517Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:20.519Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

  console.error
    [2025-12-06T00:27:20.534Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:20.534Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:20.536Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:20.539Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/query-generator-usage.test.ts
  Query Generator Usage Tracking
    Response Structure
      Î“ÃªÃœ should not have usage field in data object (1 ms)
      Î“ÃªÃœ should accumulate usage across multiple iterations (1 ms)
      Î“ÃªÃœ should handle missing usage gracefully
      Î“ÃªÃœ should maintain proper response structure for WIQL generator (1 ms)
      Î“ÃªÃœ should maintain proper response structure for OData generator (1 ms)
    Token Savings
      Î“ÃªÃœ should save approximately 50-100 tokens by not duplicating usage in data

PASS test/unit/error-categorization.test.ts
  Error Categorization System
    ErrorCategory enum
      Î“ÃªÃœ should define all required categories (2 ms)
    ErrorCode constants
      Î“ÃªÃœ should define validation error codes
      Î“ÃªÃœ should define authentication error codes (1 ms)
      Î“ÃªÃœ should define network error codes
      Î“ÃªÃœ should define not found error codes (1 ms)
      Î“ÃªÃœ should define rate limit error codes
      Î“ÃªÃœ should define permission error codes
    createErrorMetadata
      Î“ÃªÃœ should create basic error metadata (1 ms)
      Î“ÃªÃœ should include error code when provided
      Î“ÃªÃœ should include context when provided
      Î“ÃªÃœ should mark network errors as retryable (1 ms)
      Î“ÃªÃœ should mark rate limit errors as retryable
      Î“ÃªÃœ should mark validation errors as non-retryable
    categorizeError
      Î“ÃªÃœ should categorize authentication errors (1 ms)
      Î“ÃªÃœ should categorize not found errors
      Î“ÃªÃœ should categorize permission errors (1 ms)
      Î“ÃªÃœ should categorize network errors
      Î“ÃªÃœ should categorize rate limit errors
      Î“ÃªÃœ should categorize validation errors (1 ms)
      Î“ÃªÃœ should default to unknown for uncategorized errors
      Î“ÃªÃœ should handle Error objects (1 ms)
    buildErrorResponse with categorization
      Î“ÃªÃœ should include error category in metadata
      Î“ÃªÃœ should include error code in metadata when provided
      Î“ÃªÃœ should auto-categorize when category not provided (1 ms)
      Î“ÃªÃœ should maintain backwards compatibility with existing metadata
      Î“ÃªÃœ should preserve error message in errors array (1 ms)
    buildValidationErrorResponse with categorization
      Î“ÃªÃœ should categorize as validation error
      Î“ÃªÃœ should maintain validation error formatting
    buildAzureCliErrorResponse with categorization
      Î“ÃªÃœ should categorize CLI not available as business logic error (1 ms)
      Î“ÃªÃœ should categorize not logged in as authentication error
    Helper functions
      buildAuthenticationError
        Î“ÃªÃœ should create authentication error response (1 ms)
      buildNetworkError
        Î“ÃªÃœ should create network error response
      buildNotFoundError
        Î“ÃªÃœ should create not found error for work item
        Î“ÃªÃœ should create not found error for project
        Î“ÃªÃœ should create not found error for query handle
        Î“ÃªÃœ should use generic not found code for unknown resource types (1 ms)
      buildBusinessLogicError
        Î“ÃªÃœ should create business logic error response
      buildRateLimitError
        Î“ÃªÃœ should create rate limit error with default message (1 ms)
        Î“ÃªÃœ should create rate limit error with custom message
      buildPermissionError
        Î“ÃªÃœ should create permission error response (1 ms)
    Backwards compatibility
      Î“ÃªÃœ should work with existing code that does not provide category
      Î“ÃªÃœ should preserve existing metadata fields
    Integration with ToolExecutionResult
      Î“ÃªÃœ should create valid ToolExecutionResult structure (1 ms)
      Î“ÃªÃœ should maintain consistency across different error types (2 ms)

  console.error
    [2025-12-06T00:27:21.143Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:21.143Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:21.146Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:21.150Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

  console.error
    [2025-12-06T00:27:21.147Z] [INFO] Test info message

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at test/unit/logger.test.ts:42:16
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (test/unit/logger.test.ts:45:14)

  console.error
    [2025-12-06T00:27:21.154Z] [WARN] Test warning message

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at test/unit/logger.test.ts:43:16
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (test/unit/logger.test.ts:45:14)

  console.error
    [2025-12-06T00:27:21.157Z] [INFO] Test with context {"userId":123,"action":"test"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at test/unit/logger.test.ts:50:16
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (test/unit/logger.test.ts:52:14)

  console.error
    [2025-12-06T00:27:21.160Z] [ERROR] Error with context {"errorCode":"TEST_ERROR","stack":"test stack"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at test/unit/logger.test.ts:51:16
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (test/unit/logger.test.ts:52:14)

  console.error
    [2025-12-06T00:27:21.164Z] [DEBUG] Debug message with MCP_DEBUG=1

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.debug (src/utils/logger.ts:108:15)
      at test/unit/logger.test.ts:73:16
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (test/unit/logger.test.ts:74:14)

  console.error
    [2025-12-06T00:27:21.171Z] [INFO] Test file logging

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at Object.<anonymous> (test/unit/logger.test.ts:112:14)

  console.error
    [2025-12-06T00:27:21.174Z] [WARN] Test warning to file

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at Object.<anonymous> (test/unit/logger.test.ts:113:14)

  console.error
    [2025-12-06T00:27:21.182Z] [INFO] Test with invalid log file path

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at test/unit/logger.test.ts:132:16
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (test/unit/logger.test.ts:133:14)

  console.error
    [2025-12-06T00:27:21.186Z] [INFO] Simple message

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at test/unit/logger.test.ts:150:16
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (test/unit/logger.test.ts:154:14)

  console.error
    [2025-12-06T00:27:21.189Z] [WARN] Warning message

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at test/unit/logger.test.ts:151:16
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (test/unit/logger.test.ts:154:14)

  console.error
    [2025-12-06T00:27:21.192Z] [ERROR] Error message

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at test/unit/logger.test.ts:152:16
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (test/unit/logger.test.ts:154:14)

  console.error
    [2025-12-06T00:27:21.196Z] [INFO] Message with context {"key":"value"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at test/unit/logger.test.ts:159:16
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (test/unit/logger.test.ts:162:14)

  console.error
    [2025-12-06T00:27:21.199Z] [WARN] Warning with context {"code":123}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at test/unit/logger.test.ts:160:16
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (test/unit/logger.test.ts:162:14)

  console.error
    [2025-12-06T00:27:21.201Z] [ERROR] Error with context {"stack":"test"}

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.error (src/utils/logger.ts:166:15)
      at test/unit/logger.test.ts:161:16
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (test/unit/logger.test.ts:162:14)

  console.error
    [2025-12-06T00:27:21.207Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:21.207Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:21.210Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:21.213Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/subagent-response-types.test.ts
  Subagent Response Types
    SubagentInfo Interface
      Î“ÃªÃœ should have correct structure (2 ms)
      Î“ÃªÃœ should require all three fields (1 ms)
    ListSubagentsResponse Interface
      Î“ÃªÃœ should have correct structure (1 ms)
      Î“ÃªÃœ should allow empty subagents array (1 ms)
      Î“ÃªÃœ should allow optional message field
    Type Safety in ai-assignment.ts
      Î“ÃªÃœ should properly map subagent data (1 ms)
      Î“ÃªÃœ should handle agent with specialized tags
      Î“ÃªÃœ should validate agent name is non-empty (3 ms)
    Array Operations
      Î“ÃªÃœ should safely filter and transform subagent arrays

PASS test/unit/logger.test.ts
  Logger
    Basic logging
      Î“ÃªÃœ should create logger instance (2 ms)
      Î“ÃªÃœ should log messages without errors (10 ms)
      Î“ÃªÃœ should support context metadata (5 ms)
      Î“ÃªÃœ should handle debug messages when MCP_DEBUG is not set
      Î“ÃªÃœ should handle debug messages when MCP_DEBUG is set (4 ms)
    MCP connection awareness
      Î“ÃªÃœ should mark MCP as connected (1 ms)
      Î“ÃªÃœ should continue to accept log calls after MCP connected (1 ms)
    File logging
      Î“ÃªÃœ should support file logging when MCP_LOG_FILE is set (11 ms)
      Î“ÃªÃœ should handle missing log file gracefully (4 ms)
    Backward compatibility
      Î“ÃªÃœ should work with existing single-argument calls (9 ms)
      Î“ÃªÃœ should work with context as optional second parameter (8 ms)

  console.error
    [2025-12-06T00:27:21.653Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:21.653Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at Object.<anonymous> (test/factories/query-factory.ts:9:1)
      at Object.<anonymous> (test/unit/fixtures-and-factories.test.ts:24:1)

  console.error
    [2025-12-06T00:27:21.660Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at Object.<anonymous> (test/factories/query-factory.ts:9:1)
      at Object.<anonymous> (test/unit/fixtures-and-factories.test.ts:24:1)

  console.error
    [2025-12-06T00:27:21.697Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

  console.error
    [2025-12-06T00:27:21.702Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:21.702Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:21.704Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:21.706Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/fixtures-and-factories.test.ts
  Test Fixtures and Factories
    Work Item Fixtures
      Î“ÃªÃœ should provide pre-configured work items (2 ms)
      Î“ÃªÃœ should provide test identity
    Work Item Factory
      Î“ÃªÃœ should create work item with defaults (1 ms)
      Î“ÃªÃœ should create work item with overrides (1 ms)
      Î“ÃªÃœ should create specific work item types (1 ms)
      Î“ÃªÃœ should create parent-child relationships (1 ms)
      Î“ÃªÃœ should create multiple work items (1 ms)
      Î“ÃªÃœ should create context map from work items (1 ms)
      Î“ÃªÃœ should create work item context (1 ms)
    Query Fixtures
      Î“ÃªÃœ should provide WIQL query strings
      Î“ÃªÃœ should provide WIQL query results
    Query Factory
      Î“ÃªÃœ should create query handle (1 ms)
      Î“ÃªÃœ should create WIQL result
      Î“ÃªÃœ should create WIQL query string (1 ms)
      Î“ÃªÃœ should create OData query string
    Response Factory
      Î“ÃªÃœ should create success result (7 ms)
      Î“ÃªÃœ should create error result (1 ms)
      Î“ÃªÃœ should create custom tool execution result (1 ms)
      Î“ÃªÃœ should create work items batch
      Î“ÃªÃœ should create bulk operation result (1 ms)

PASS test/unit/openapi-generation.test.ts
  OpenAPI Generation
    OpenAPI Specification
      Î“ÃªÃœ should have OpenAPI 3.0.0 format (1 ms)
      Î“ÃªÃœ should have info section with title and version
      Î“ÃªÃœ should have contact information (1 ms)
      Î“ÃªÃœ should have MIT license
      Î“ÃªÃœ should have servers defined (1 ms)
      Î“ÃªÃœ should have tags for categorization
      Î“ÃªÃœ should have paths for tools (1 ms)
      Î“ÃªÃœ should have properly formatted tool paths (2 ms)
      Î“ÃªÃœ should have POST operations for all tools (17 ms)
      Î“ÃªÃœ should have request body schemas (7 ms)
      Î“ÃªÃœ should have response schemas (7 ms)
      Î“ÃªÃœ should mark AI-powered tools correctly (1 ms)
    Individual Schemas
      Î“ÃªÃœ should have schema index
      Î“ÃªÃœ should have generation metadata
      Î“ÃªÃœ should have schema files for all tools (1 ms)
    Schema Consistency
      Î“ÃªÃœ should have matching number of paths and schemas
      Î“ÃªÃœ should have consistent tool names (2 ms)

  console.error
    [2025-12-06T00:27:22.191Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:22.191Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:22.193Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:22.194Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/query-count-discrepancy.test.ts
  Query Count Discrepancy Investigation
    Scenario 1: Client-Side Filtering After Query
      Î“ÃªÃœ should accurately reflect count after filterByPatterns is applied (1 ms)
      Î“ÃªÃœ should accurately reflect count after substantive change filtering (1 ms)
    Scenario 2: Pagination with Filtering
      Î“ÃªÃœ should correctly calculate hasMore when filtering reduces total count
      Î“ÃªÃœ should correctly paginate when filters are applied BEFORE pagination (2 ms)
      Î“ÃªÃœ should handle edge case where filtering leaves fewer items than skip offset
    Scenario 3: Query Handle Count Storage
      Î“ÃªÃœ should store the correct count in query handle after filtering (1 ms)
      Î“ÃªÃœ should consistently report count across handle operations
    Scenario 4: Warning Messages and User Communication
      Î“ÃªÃœ should generate accurate warning when totalCount differs from returned count
      Î“ÃªÃœ should generate accurate summary for filtered results (1 ms)
    Scenario 5: OData Count Aggregation
      Î“ÃªÃœ should correctly aggregate counts in OData queries
    Scenario 6: Real-World Discrepancy Examples
      Î“ÃªÃœ should reproduce "100 of 500" showing only 95 items scenario (1 ms)
    Scenario 7: Code Review of Count Assignments
      Î“ÃªÃœ should verify the correct count variables are used in response (1 ms)
  Integration Test: Full Query Flow with Filtering
    Î“ÃªÃœ should maintain count consistency through entire query flow (1 ms)

PASS test/unit/resources-integration.test.ts
  Resources Integration
    Î“ÃªÃœ should have resources capability enabled (1 ms)
    Î“ÃªÃœ should expose resource list handler
    Î“ÃªÃœ should expose resource read handler (1 ms)
    Î“ÃªÃœ should have all resource files in place (2 ms)

  console.error
    [2025-12-06T00:27:22.610Z] [WARN] Area path "TestProject" does not contain team information. Cannot determine current iteration.

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at getCurrentIterationPath (src/services/ado-discovery-service.ts:75:16)
      at Object.<anonymous> (test/unit/current-iteration-discovery.test.ts:110:51)

  console.error
    [2025-12-06T00:27:22.617Z] [WARN] Hint: Use --team <team-name> to explicitly specify the team for iteration discovery.

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at getCurrentIterationPath (src/services/ado-discovery-service.ts:76:16)
      at Object.<anonymous> (test/unit/current-iteration-discovery.test.ts:110:51)

  console.error
    [2025-12-06T00:27:22.622Z] [WARN] Failed to discover current iteration path: HTTP 404 - Team not found

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at getCurrentIterationPath (src/services/ado-discovery-service.ts:107:14)
      at Object.<anonymous> (test/unit/current-iteration-discovery.test.ts:183:22)

  console.error
    [2025-12-06T00:27:22.624Z] [WARN] Hint: If the auto-detected team name is incorrect, use --team <team-name> to explicitly specify the team.

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at getCurrentIterationPath (src/services/ado-discovery-service.ts:111:16)
      at Object.<anonymous> (test/unit/current-iteration-discovery.test.ts:183:22)

  console.error
    [2025-12-06T00:27:22.626Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:22.626Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:22.626Z] [WARN] Failed to discover current iteration path: Network error

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at getCurrentIterationPath (src/services/ado-discovery-service.ts:137:12)
      at Object.<anonymous> (test/unit/current-iteration-discovery.test.ts:193:22)

  console.error
    [2025-12-06T00:27:22.628Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:22.630Z] [WARN] Failed to get team iterations: HTTP 404

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.warn (src/utils/logger.ts:146:15)
      at getTeamIterations (src/services/ado-discovery-service.ts:177:14)
      at Object.<anonymous> (test/unit/current-iteration-discovery.test.ts:295:22)

  console.error
    [2025-12-06T00:27:22.636Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:22.636Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:22.631Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

  console.error
    [2025-12-06T00:27:22.638Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:22.641Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/context-package-optimization.test.ts
  Context Package Optimization
    Schema Defaults
      Î“ÃªÃœ should default maxHistoryRevisions to 3 (2 ms)
      Î“ÃªÃœ should default includeSystemFields to false (1 ms)
      Î“ÃªÃœ should allow includeSystemFields to be explicitly set
      Î“ÃªÃœ should default stripHtmlFormatting to true (1 ms)
    Field Filtering
      Î“ÃªÃœ should identify WEF fields as system fields (1 ms)
      Î“ÃªÃœ should have system fields list defined (1 ms)
    History Optimization
      Î“ÃªÃœ should accept reduced history revision count
      Î“ÃªÃœ should allow maxHistoryRevisions up to 100 (1 ms)
      Î“ÃªÃœ should reject maxHistoryRevisions below 1 (1 ms)
    Context Window Efficiency
      Î“ÃªÃœ should have context-efficient defaults (1 ms)

PASS test/unit/current-iteration-discovery.test.ts
  Current Iteration Path Discovery
    getCurrentIterationPath
      Î“ÃªÃœ should extract team name from area path and discover current iteration (3 ms)
      Î“ÃªÃœ should use explicit team override when provided (1 ms)
      Î“ÃªÃœ should return null when area path has insufficient segments (10 ms)
      Î“ÃªÃœ should return null when no current iteration is found (1 ms)
      Î“ÃªÃœ should return first iteration when timeFrame is not "current"
      Î“ÃªÃœ should handle API errors gracefully (5 ms)
      Î“ÃªÃœ should handle network errors gracefully (2 ms)
      Î“ÃªÃœ should prioritize iteration with timeFrame=current (1 ms)
    getTeamIterations
      Î“ÃªÃœ should fetch all iterations for a team (1 ms)
      Î“ÃªÃœ should return null on API error (2 ms)
      Î“ÃªÃœ should return empty array when no iterations exist
    Configuration integration
      Î“ÃªÃœ should cache discovered iteration path in config (1 ms)

  console.error
    [2025-12-06T00:27:23.011Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:23.010Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:23.013Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:23.016Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

  console.error
    [2025-12-06T00:27:23.042Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:23.042Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:23.044Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:23.047Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/area-path-filtering.test.ts
  Area Path Filtering in WIQL Queries
    WIQL Query Injection
      Î“ÃªÃœ should generate correct UNDER clause for single area path (1 ms)
      Î“ÃªÃœ should generate correct OR conditions for multiple area paths
      Î“ÃªÃœ should not modify query that already has area path filtering (1 ms)
      Î“ÃªÃœ should handle queries with existing WHERE clause
      Î“ÃªÃœ should handle queries with ORDER BY clause (1 ms)
      Î“ÃªÃœ should escape single quotes in area paths
    Area Path Filter Parameter
      Î“ÃªÃœ should accept areaPathFilter as array of strings
      Î“ÃªÃœ should default to configured area paths when not specified (1 ms)
      Î“ÃªÃœ should allow subset of configured area paths
      Î“ÃªÃœ should handle empty array as no filtering
    Query Result Metadata
      Î“ÃªÃœ should include area path in work item results (1 ms)
      Î“ÃªÃœ should include project in work item results
    Error Cases
      Î“ÃªÃœ should handle null area path filter gracefully
      Î“ÃªÃœ should handle undefined area path filter gracefully (1 ms)
      Î“ÃªÃœ should validate area paths contain backslashes

PASS test/unit/work-item-repository.test.ts
  WorkItemRepository
    getById
      Î“ÃªÃœ should fetch a work item by ID without fields (2 ms)
      Î“ÃªÃœ should fetch a work item by ID with specific fields
    getBatch
      Î“ÃªÃœ should fetch multiple work items by IDs (1 ms)
      Î“ÃªÃœ should handle empty batch response (1 ms)
    create
      Î“ÃªÃœ should create a work item with provided fields (4 ms)
      Î“ÃªÃœ should URL-encode work item type with spaces
    update
      Î“ÃªÃœ should update a work item with provided fields (1 ms)
    delete
      Î“ÃªÃœ should soft delete a work item (1 ms)
      Î“ÃªÃœ should hard delete a work item
    linkToParent
      Î“ÃªÃœ should create parent link relation (1 ms)
    linkToBranch
      Î“ÃªÃœ should create branch artifact link (1 ms)
    getRevisions
      Î“ÃªÃœ should fetch work item revisions (1 ms)
    executeWiql
      Î“ÃªÃœ should execute a WIQL query
    getRepository
      Î“ÃªÃœ should fetch repository by exact match (1 ms)
      Î“ÃªÃœ should search for repository by name if exact match fails
      Î“ÃªÃœ should throw error if repository not found (10 ms)

  console.error
    [2025-12-06T00:27:23.486Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:23.486Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:23.488Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:23.491Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

  console.error
    [2025-12-06T00:27:23.548Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/date-iso-formatting.test.ts
  Date ISO Formatting
    Î“ÃªÃœ should generate valid ISO 8601 timestamps for date variables (1 ms)
    Î“ÃªÃœ should produce timestamps compatible with OData date filters
    Î“ÃªÃœ should document correct OData date format in team_health_analyzer prompt (3 ms)
    Î“ÃªÃœ should not append Z suffix to ISO timestamp variables in prompts (2 ms)
    Î“ÃªÃœ should distinguish between WIQL and OData date formats (1 ms)
    Î“ÃªÃœ should format dates correctly for different uses

PASS test/unit/handlers/analyze-by-query-handle.test.ts
  Story Points Field Mapping
    Î“ÃªÃœ should recognize Microsoft.VSTS.Scheduling.Effort as story points (1 ms)
    Î“ÃªÃœ should prefer Effort over StoryPoints when both exist (1 ms)
    Î“ÃªÃœ should use StoryPoints when Effort is not present
    Î“ÃªÃœ should return 0 when neither field is present
  AI Suitability Categorization with Query Handles
    Î“ÃªÃœ should categorize work items by AI suitability decision (2 ms)
    Î“ÃªÃœ should return null query handle for empty categories
    Î“ÃªÃœ should include work item context in query handles
    Î“ÃªÃœ should handle multiple work items in same category (1 ms)
    Î“ÃªÃœ should create derived WIQL query with source reference (1 ms)
    Î“ÃªÃœ should handle all four decision categories (1 ms)
    Î“ÃªÃœ should preserve work item IDs in categorization result
    Î“ÃªÃœ should handle analysis failures gracefully
  Work Item Intelligence Categorization with Query Handles
    Î“ÃªÃœ should categorize work items by intelligence category when using categorization analysis (1 ms)
    Î“ÃªÃœ should handle all intelligence categories (1 ms)
    Î“ÃªÃœ should not create categorization when using non-categorization analysis types

  console.error
    [2025-12-06T00:27:23.834Z] [INFO] Undoing 1 operation(s) on query handle qh_cd6ed154664c090211d4aea522a7b54e

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkUndoByQueryHandle (src/services/handlers/bulk-operations/bulk-undo-by-query-handle.handler.ts:68:12)
      at Object.<anonymous> (test/integration/bulk-undo-real.test.ts:76:55)

  console.error
    [2025-12-06T00:27:23.987Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:23.987Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:23.991Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:23.993Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/get-prompts.test.ts
  wit-get-prompts Tool Configuration
    Schema Validation
      Î“ÃªÃœ should validate correct input with all fields (2 ms)
      Î“ÃªÃœ should validate input with only promptName (1 ms)
      Î“ÃªÃœ should validate empty input (list all prompts)
      Î“ÃªÃœ should validate with includeContent false
      Î“ÃªÃœ should validate with custom args (1 ms)
      Î“ÃªÃœ should reject invalid includeContent type
      Î“ÃªÃœ should reject invalid promptName type (1 ms)
    Tool Configuration
      Î“ÃªÃœ should not require any parameters
    Use Case Examples
      Î“ÃªÃœ should validate test scenario: list all prompts metadata
      Î“ÃªÃœ should validate test scenario: get specific prompt with custom variables (1 ms)
      Î“ÃªÃœ should validate test scenario: debugging prompt template

FAIL test/unit/handlers/get-work-item-context-package.handler.test.ts
  Î“Ã¹Ã… Test suite failed to run

    test/unit/handlers/get-work-item-context-package.handler.test.ts:70:85 - error TS2345: Argument of type '"test-token"' is not assignable to parameter of type 'never'.

    70     mockGetTokenProvider.mockReturnValue((jest.fn() as jest.Mock).mockResolvedValue('test-token'));
                                                                                           ~~~~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:95:44 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    95       mockHttpClient.get.mockRejectedValue(new Error('Work item not found'));
                                                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:113:44 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    113       mockHttpClient.get.mockRejectedValue(new Error('Invalid work item ID'));
                                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:130:44 - error TS2345: Argument of type '{ status: number; message: string; }' is not assignable to parameter of type 'never'.

    130       mockHttpClient.get.mockRejectedValue({ status: 404, message: 'Not found' });
                                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:152:44 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    152       mockHttpClient.get.mockRejectedValue(timeoutError);
                                                   ~~~~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:171:44 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    171       mockHttpClient.get.mockRejectedValue(new Error('ECONNREFUSED'));
                                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:190:44 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    190       mockHttpClient.get.mockRejectedValue(new Error('ENOTFOUND dev.azure.com'));
                                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:208:44 - error TS2345: Argument of type '{ status: number; message: string; statusText: string; }' is not assignable to parameter of type 'never'.

    208       mockHttpClient.get.mockRejectedValue({
                                                   ~
    209         status: 500,
        ~~~~~~~~~~~~~~~~~~~~
    ... 
    211         statusText: 'Internal Server Error'
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    212       });
        ~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:230:44 - error TS2345: Argument of type '{ status: number; message: string; statusText: string; }' is not assignable to parameter of type 'never'.

    230       mockHttpClient.get.mockRejectedValue({
                                                   ~
    231         status: 401,
        ~~~~~~~~~~~~~~~~~~~~
    ... 
    233         statusText: 'Unauthorized'
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    234       });
        ~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:253:44 - error TS2345: Argument of type '{ status: number; message: string; statusText: string; }' is not assignable to parameter of type 'never'.

    253       mockHttpClient.get.mockRejectedValue({
                                                   ~
    254         status: 403,
        ~~~~~~~~~~~~~~~~~~~~
    ... 
    256         statusText: 'Forbidden'
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    257       });
        ~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:278:44 - error TS2345: Argument of type '{ data: { id: number; }; status: number; }' is not assignable to parameter of type 'never'.

    278       mockHttpClient.get.mockResolvedValue({
                                                   ~
    279         data: {
        ~~~~~~~~~~~~~~~
    ... 
    283         status: 200
        ~~~~~~~~~~~~~~~~~~~
    284       });
        ~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:294:44 - error TS2345: Argument of type '{ data: null; status: number; }' is not assignable to parameter of type 'never'.

    294       mockHttpClient.get.mockResolvedValue({
                                                   ~
    295         data: null,
        ~~~~~~~~~~~~~~~~~~~
    296         status: 200
        ~~~~~~~~~~~~~~~~~~~
    297       });
        ~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:315:44 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    315       mockHttpClient.get.mockRejectedValue(new Error('Unexpected token < in JSON at position 0'));
                                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:340:32 - error TS2345: Argument of type '{ data: { id: number; fields: { 'System.Title': string; 'System.State': string; }; }; status: number; }' is not assignable to parameter of type 'never'.

    340         .mockResolvedValueOnce({
                                       ~
    341           data: {
        ~~~~~~~~~~~~~~~~~
    ... 
    345           status: 200
        ~~~~~~~~~~~~~~~~~~~~~
    346         })
        ~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:348:32 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    348         .mockRejectedValueOnce(new Error('Comments API unavailable'));
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:371:32 - error TS2345: Argument of type '{ data: { id: number; fields: { 'System.Title': string; 'System.State': string; }; }; status: number; }' is not assignable to parameter of type 'never'.

    371         .mockResolvedValueOnce({
                                       ~
    372           data: {
        ~~~~~~~~~~~~~~~~~
    ... 
    376           status: 200
        ~~~~~~~~~~~~~~~~~~~~~
    377         })
        ~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:378:32 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    378         .mockRejectedValueOnce(new Error('History API timeout'));
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:400:32 - error TS2345: Argument of type '{ data: { id: number; fields: { 'System.Title': string; 'System.WorkItemType': string; }; relations: { rel: string; url: string; }[]; }; status: number; }' is not assignable to parameter of type 'never'.

    400         .mockResolvedValueOnce({
                                       ~
    401           data: {
        ~~~~~~~~~~~~~~~~~
    ... 
    406           status: 200
        ~~~~~~~~~~~~~~~~~~~~~
    407         })
        ~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:408:32 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    408         .mockRejectedValueOnce(new Error('Child work item not found'));
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:429:44 - error TS2345: Argument of type '{ data: { id: number; fields: { 'System.Title': string; }; relations: ({ rel: string; url: string; } | { rel: string; url: null; })[]; }; status: number; }' is not assignable to parameter of type 'never'.

    429       mockHttpClient.get.mockResolvedValue({
                                                   ~
    430         data: {
        ~~~~~~~~~~~~~~~
    ... 
    438         status: 200
        ~~~~~~~~~~~~~~~~~~~
    439       });
        ~~~~~~~

FAIL test/unit/handlers/odata-query.handler.test.ts
  Î“Ã¹Ã… Test suite failed to run

    test/unit/handlers/odata-query.handler.test.ts:120:68 - error TS2345: Argument of type '"mock-token"' is not assignable to parameter of type 'never'.

    120     const mockTokenFn = (jest.fn() as jest.Mock).mockResolvedValue('mock-token');
                                                                           ~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:124:51 - error TS2345: Argument of type '(path: string) => string' is not assignable to parameter of type 'UnknownFunction'.
      Types of parameters 'path' and 'args' are incompatible.
        Type 'unknown' is not assignable to type 'string'.

    124     mockEscapeAreaPathForOData.mockImplementation((path: string) => {
                                                          ~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:205:32 - error TS2349: This expression is not callable.
      Type '{ name: string; description: string; schema: ZodObject<{ organization: ZodOptional<ZodString>; project: ZodOptional<ZodString>; description: ZodOptional<...>; ... 23 more ...; iterationPath: ZodOptional<...>; }, "strip", ZodTypeAny, { ...; }, { ...; }>; describe(: any): any; }' has no call signatures.

    205     const config: ToolConfig = {
                                       ~
    206       name: 'query-odata',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    ... 
    208       schema: odataQuerySchema,
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    209   describe('Input Validation', () => {
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:209:12 - error TS7006: Parameter '(Missing)' implicitly has an 'any' type.

    209   describe('Input Validation', () => {
                   
    test/unit/handlers/odata-query.handler.test.ts:213:14 - error TS2304: Cannot find name 'result'.

    213       expect(result.success).toBe(false);
                     ~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:214:14 - error TS2304: Cannot find name 'result'.

    214       expect(result.errors).toBeDefined();
                     ~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:247:32 - error TS2349: This expression is not callable.
      Type '{ name: string; description: string; schema: ZodObject<{ organization: ZodOptional<ZodString>; project: ZodOptional<ZodString>; description: ZodOptional<...>; ... 23 more ...; iterationPath: ZodOptional<...>; }, "strip", ZodTypeAny, { ...; }, { ...; }>; describe(: any): any; }' has no call signatures.

    247     const config: ToolConfig = {
                                       ~
    248       name: 'query-odata',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    ... 
    250       schema: odataQuerySchema,
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    251   describe('Area Path Filtering', () => {
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:251:12 - error TS7006: Parameter '(Missing)' implicitly has an 'any' type.

    251   describe('Area Path Filtering', () => {
                   
    test/unit/handlers/odata-query.handler.test.ts:257:27 - error TS2552: Cannot find name 'mockResponse'. Did you mean 'Response'?

    257         json: async () => mockResponse,
                                  ~~~~~~~~~~~~

      node_modules/typescript/lib/lib.dom.d.ts:26367:13
        26367 declare var Response: {
                          ~~~~~~~~
        'Response' is declared here.
    test/unit/handlers/odata-query.handler.test.ts:258:42 - error TS2552: Cannot find name 'mockResponse'. Did you mean 'Response'?

    258         text: async () => JSON.stringify(mockResponse)
                                                 ~~~~~~~~~~~~

      node_modules/typescript/lib/lib.dom.d.ts:26367:13
        26367 declare var Response: {
                          ~~~~~~~~
        'Response' is declared here.
    test/unit/handlers/odata-query.handler.test.ts:363:7 - error TS2353: Object literal may only specify known properties, and 'handler' does not exist in type 'ToolConfig'.

    363       handler: handleODataQuery
              ~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:367:43 - error TS2349: This expression is not callable.
      Type '{ describe(: any): any; }' has no call signatures.

    367       const mockResponse: ODataResponse = {
                                                  ~
    368   describe('Query Type Execution', () => {
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:368:12 - error TS7006: Parameter '(Missing)' implicitly has an 'any' type.

    368   describe('Query Type Execution', () => {
                   
    test/unit/handlers/odata-query.handler.test.ts:432:13 - error TS2322: Type '{ UserName: string; }' is not assignable to type 'string | number | boolean | null | undefined'.

    432           { AssignedTo: { UserName: 'john@example.com' }, Count: 8 },
                    ~~~~~~~~~~

      src/types/queries.ts:55:3
        55   [key: string]: string | number | boolean | null | undefined;
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        The expected type comes from this index signature.
    test/unit/handlers/odata-query.handler.test.ts:433:13 - error TS2322: Type '{ UserName: string; }' is not assignable to type 'string | number | boolean | null | undefined'.

    433           { AssignedTo: { UserName: 'jane@example.com' }, Count: 12 }
                    ~~~~~~~~~~

      src/types/queries.ts:55:3
        55   [key: string]: string | number | boolean | null | undefined;
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        The expected type comes from this index signature.
    test/unit/handlers/odata-query.handler.test.ts:579:32 - error TS2349: This expression is not callable.
      Type '{ name: string; description: string; schema: ZodObject<{ organization: ZodOptional<ZodString>; project: ZodOptional<ZodString>; description: ZodOptional<...>; ... 23 more ...; iterationPath: ZodOptional<...>; }, "strip", ZodTypeAny, { ...; }, { ...; }>; describe(: any): any; }' has no call signatures.

    579     const config: ToolConfig = {
                                       ~
    580       name: 'query-odata',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    ... 
    582       schema: odataQuerySchema,
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    583   describe('Query Handle Lifecycle', () => {
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:583:12 - error TS7006: Parameter '(Missing)' implicitly has an 'any' type.

    583   describe('Query Handle Lifecycle', () => {
                   
    test/unit/handlers/odata-query.handler.test.ts:591:27 - error TS2552: Cannot find name 'mockResponse'. Did you mean 'Response'?

    591         json: async () => mockResponse
                                  ~~~~~~~~~~~~

      node_modules/typescript/lib/lib.dom.d.ts:26367:13
        26367 declare var Response: {
                          ~~~~~~~~
        'Response' is declared here.
    test/unit/handlers/odata-query.handler.test.ts:699:32 - error TS2349: This expression is not callable.
      Type '{ name: string; description: string; schema: ZodObject<{ organization: ZodOptional<ZodString>; project: ZodOptional<ZodString>; description: ZodOptional<...>; ... 23 more ...; iterationPath: ZodOptional<...>; }, "strip", ZodTypeAny, { ...; }, { ...; }>; describe(: any): any; }' has no call signatures.

    699     const config: ToolConfig = {
                                       ~
    700       name: 'query-odata',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    ... 
    702       schema: odataQuerySchema,
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    703   describe('Pagination', () => {
        ~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:703:12 - error TS7006: Parameter '(Missing)' implicitly has an 'any' type.

    703   describe('Pagination', () => {
                   
    test/unit/handlers/odata-query.handler.test.ts:710:27 - error TS2552: Cannot find name 'mockResponse'. Did you mean 'Response'?

    710         json: async () => mockResponse
                                  ~~~~~~~~~~~~

      node_modules/typescript/lib/lib.dom.d.ts:26367:13
        26367 declare var Response: {
                          ~~~~~~~~
        'Response' is declared here.
    test/unit/handlers/odata-query.handler.test.ts:776:7 - error TS2353: Object literal may only specify known properties, and 'handler' does not exist in type 'ToolConfig'.

    776       handler: handleODataQuery
              ~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:780:41 - error TS2349: This expression is not callable.
      Type '{ describe(: any): any; }' has no call signatures.

    780       const cachedData: ODataResponse = {
                                                ~
    781   describe('Cache Behavior', () => {
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:781:12 - error TS7006: Parameter '(Missing)' implicitly has an 'any' type.

    781   describe('Cache Behavior', () => {
                   
    test/unit/handlers/odata-query.handler.test.ts:786:14 - error TS2304: Cannot find name 'result'.

    786       expect(result.success).toBe(true);
                     ~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:787:15 - error TS2304: Cannot find name 'result'.

    787       expect((result.data as any).results[0].Count).toBe(42);
                      ~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:826:7 - error TS2353: Object literal may only specify known properties, and 'handler' does not exist in type 'ToolConfig'.

    826       handler: handleODataQuery
              ~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:887:81 - error TS2352: Conversion of type '{ ok: true; json: () => Promise<never>; }' to type 'Response' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type '{ ok: true; json: () => Promise<never>; }' is missing the following properties from type 'Response': headers, redirected, status, statusText, and 10 more.

    887       (global.fetch as jest.MockedFunction<typeof fetch>).mockResolvedValueOnce({
                                                                                        ~
    888         ok: true,
        ~~~~~~~~~~~~~~~~~
    ... 
    891         }
        ~~~~~~~~~
    892       } as Response);
        ~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:937:58 - error TS2345: Argument of type '{ role: string; content: { type: string; text: string; }; usage: { inputTokens: number; outputTokens: number; totalTokens: number; }; }' is not assignable to parameter of type 'never'.

    937       mockSamplingClient.createMessage.mockResolvedValue({
                                                                 ~
    938         role: 'assistant',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    ... 
    940         usage: { inputTokens: 100, outputTokens: 50, totalTokens: 150 }
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    941       });
        ~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:969:58 - error TS2345: Argument of type '{ role: string; content: { type: string; text: string; }; }' is not assignable to parameter of type 'never'.

    969       mockSamplingClient.createMessage.mockResolvedValue({
                                                                 ~
    970         role: 'assistant',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    971         content: { type: 'text', text: 'Invalid query syntax' }
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    972       });
        ~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:998:32 - error TS2345: Argument of type '{ role: string; content: { type: string; text: string; }; }' is not assignable to parameter of type 'never'.

     998         .mockResolvedValueOnce({
                                        ~
     999           role: 'assistant',
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    1000           content: { type: 'text', text: 'bad query' }
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    1001         })
         ~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:1002:32 - error TS2345: Argument of type '{ role: string; content: { type: string; text: string; }; }' is not assignable to parameter of type 'never'.

    1002         .mockResolvedValueOnce({
                                        ~
    1003           role: 'assistant',
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    1004           content: { type: 'text', text: "$filter=State eq 'Active'" }
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    1005         });
         ~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:1037:32 - error TS2349: This expression is not callable.
      Type '{ name: string; description: string; schema: ZodObject<{ organization: ZodOptional<ZodString>; project: ZodOptional<ZodString>; description: ZodOptional<...>; ... 23 more ...; iterationPath: ZodOptional<...>; }, "strip", ZodTypeAny, { ...; }, { ...; }>; describe(: any): any; }' has no call signatures.

    1037     const config: ToolConfig = {
                                        ~
    1038       name: 'query-odata',
         ~~~~~~~~~~~~~~~~~~~~~~~~~~
     ... 
    1040       schema: odataQuerySchema,
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    1041   describe('Metadata Options', () => {
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:1041:12 - error TS7006: Parameter '(Missing)' implicitly has an 'any' type.

    1041   describe('Metadata Options', () => {
                    
    test/unit/handlers/odata-query.handler.test.ts:1048:27 - error TS2552: Cannot find name 'mockResponse'. Did you mean 'Response'?

    1048         json: async () => mockResponse
                                   ~~~~~~~~~~~~

      node_modules/typescript/lib/lib.dom.d.ts:26367:13
        26367 declare var Response: {
                          ~~~~~~~~
        'Response' is declared here.
    test/unit/handlers/odata-query.handler.test.ts:1109:32 - error TS2349: This expression is not callable.
      Type '{ name: string; description: string; schema: ZodObject<{ organization: ZodOptional<ZodString>; project: ZodOptional<ZodString>; description: ZodOptional<...>; ... 23 more ...; iterationPath: ZodOptional<...>; }, "strip", ZodTypeAny, { ...; }, { ...; }>; describe(: any): any; }' has no call signatures.

    1109     const config: ToolConfig = {
                                        ~
    1110       name: 'query-odata',
         ~~~~~~~~~~~~~~~~~~~~~~~~~~
     ... 
    1112       schema: odataQuerySchema,
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    1113   describe('Edge Cases', () => {
         ~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:1113:12 - error TS7006: Parameter '(Missing)' implicitly has an 'any' type.

    1113   describe('Edge Cases', () => {
                    
    test/unit/handlers/odata-query.handler.test.ts:1119:27 - error TS2552: Cannot find name 'mockResponse'. Did you mean 'Response'?

    1119         json: async () => mockResponse
                                   ~~~~~~~~~~~~

      node_modules/typescript/lib/lib.dom.d.ts:26367:13
        26367 declare var Response: {
                          ~~~~~~~~
        'Response' is declared here.
    test/unit/handlers/odata-query.handler.test.ts:1258:7 - error TS2353: Object literal may only specify known properties, and 'handler' does not exist in type 'ToolConfig'.

    1258       handler: handleODataQuery
               ~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:1262:43 - error TS2349: This expression is not callable.
      Type '{ describe(: any): any; }' has no call signatures.

    1262       const mockResponse: ODataResponse = {
                                                   ~
    1263   describe('Query Building', () => {
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:1263:12 - error TS7006: Parameter '(Missing)' implicitly has an 'any' type.

    1263   describe('Query Building', () => {
                    
    test/unit/handlers/odata-query.handler.test.ts:1339:21 - error TS2339: Property 'azureDevOps' does not exist on type 'ToolConfig'.

    1339           ...config.azureDevOps,
                             ~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:209:12 - error TS1003: Identifier expected.

    209   describe('Input Validation', () => {
                   ~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:209:30 - error TS1138: Parameter declaration expected.

    209   describe('Input Validation', () => {
                                     ~
    test/unit/handlers/odata-query.handler.test.ts:209:32 - error TS1138: Parameter declaration expected.

    209   describe('Input Validation', () => {
                                       ~
    test/unit/handlers/odata-query.handler.test.ts:209:35 - error TS1005: ';' expected.

    209   describe('Input Validation', () => {
                                          ~~
    test/unit/handlers/odata-query.handler.test.ts:240:4 - error TS1128: Declaration or statement expected.

    240   });
           ~
    test/unit/handlers/odata-query.handler.test.ts:251:12 - error TS1003: Identifier expected.

    251   describe('Area Path Filtering', () => {
                   ~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:251:33 - error TS1138: Parameter declaration expected.

    251   describe('Area Path Filtering', () => {
                                        ~
    test/unit/handlers/odata-query.handler.test.ts:251:35 - error TS1138: Parameter declaration expected.

    251   describe('Area Path Filtering', () => {
                                          ~
    test/unit/handlers/odata-query.handler.test.ts:251:38 - error TS1005: ';' expected.

    251   describe('Area Path Filtering', () => {
                                             ~~
    test/unit/handlers/odata-query.handler.test.ts:352:4 - error TS1128: Declaration or statement expected.

    352   });
           ~
    test/unit/handlers/odata-query.handler.test.ts:368:12 - error TS1003: Identifier expected.

    368   describe('Query Type Execution', () => {
                   ~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:368:34 - error TS1138: Parameter declaration expected.

    368   describe('Query Type Execution', () => {
                                         ~
    test/unit/handlers/odata-query.handler.test.ts:368:36 - error TS1138: Parameter declaration expected.

    368   describe('Query Type Execution', () => {
                                           ~
    test/unit/handlers/odata-query.handler.test.ts:368:39 - error TS1005: ';' expected.

    368   describe('Query Type Execution', () => {
                                              ~~
    test/unit/handlers/odata-query.handler.test.ts:491:4 - error TS1128: Declaration or statement expected.

    491   });
           ~
    test/unit/handlers/odata-query.handler.test.ts:583:12 - error TS1003: Identifier expected.

    583   describe('Query Handle Lifecycle', () => {
                   ~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:583:36 - error TS1138: Parameter declaration expected.

    583   describe('Query Handle Lifecycle', () => {
                                           ~
    test/unit/handlers/odata-query.handler.test.ts:583:38 - error TS1138: Parameter declaration expected.

    583   describe('Query Handle Lifecycle', () => {
                                             ~
    test/unit/handlers/odata-query.handler.test.ts:583:41 - error TS1005: ';' expected.

    583   describe('Query Handle Lifecycle', () => {
                                                ~~
    test/unit/handlers/odata-query.handler.test.ts:587:8 - error TS1005: ')' expected.

    587       };
               ~
    test/unit/handlers/odata-query.handler.test.ts:611:6 - error TS1128: Declaration or statement expected.

    611     });
             ~
    test/unit/handlers/odata-query.handler.test.ts:703:12 - error TS1003: Identifier expected.

    703   describe('Pagination', () => {
                   ~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:703:24 - error TS1138: Parameter declaration expected.

    703   describe('Pagination', () => {
                               ~
    test/unit/handlers/odata-query.handler.test.ts:703:26 - error TS1138: Parameter declaration expected.

    703   describe('Pagination', () => {
                                 ~
    test/unit/handlers/odata-query.handler.test.ts:703:29 - error TS1005: ';' expected.

    703   describe('Pagination', () => {
                                    ~~
    test/unit/handlers/odata-query.handler.test.ts:765:4 - error TS1128: Declaration or statement expected.

    765   });
           ~
    test/unit/handlers/odata-query.handler.test.ts:781:12 - error TS1003: Identifier expected.

    781   describe('Cache Behavior', () => {
                   ~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:781:28 - error TS1138: Parameter declaration expected.

    781   describe('Cache Behavior', () => {
                                   ~
    test/unit/handlers/odata-query.handler.test.ts:781:30 - error TS1138: Parameter declaration expected.

    781   describe('Cache Behavior', () => {
                                     ~
    test/unit/handlers/odata-query.handler.test.ts:781:33 - error TS1005: ';' expected.

    781   describe('Cache Behavior', () => {
                                        ~~
    test/unit/handlers/odata-query.handler.test.ts:815:4 - error TS1128: Declaration or statement expected.

    815   });
           ~
    test/unit/handlers/odata-query.handler.test.ts:1041:12 - error TS1003: Identifier expected.

    1041   describe('Metadata Options', () => {
                    ~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:1041:30 - error TS1138: Parameter declaration expected.

    1041   describe('Metadata Options', () => {
                                      ~
    test/unit/handlers/odata-query.handler.test.ts:1041:32 - error TS1138: Parameter declaration expected.

    1041   describe('Metadata Options', () => {
                                        ~
    test/unit/handlers/odata-query.handler.test.ts:1041:35 - error TS1005: ';' expected.

    1041   describe('Metadata Options', () => {
                                           ~~
    test/unit/handlers/odata-query.handler.test.ts:1102:4 - error TS1128: Declaration or statement expected.

    1102   });
            ~
    test/unit/handlers/odata-query.handler.test.ts:1113:12 - error TS1003: Identifier expected.

    1113   describe('Edge Cases', () => {
                    ~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:1113:24 - error TS1138: Parameter declaration expected.

    1113   describe('Edge Cases', () => {
                                ~
    test/unit/handlers/odata-query.handler.test.ts:1113:26 - error TS1138: Parameter declaration expected.

    1113   describe('Edge Cases', () => {
                                  ~
    test/unit/handlers/odata-query.handler.test.ts:1113:29 - error TS1005: ';' expected.

    1113   describe('Edge Cases', () => {
                                     ~~
    test/unit/handlers/odata-query.handler.test.ts:1247:4 - error TS1128: Declaration or statement expected.

    1247   });
            ~
    test/unit/handlers/odata-query.handler.test.ts:1263:12 - error TS1003: Identifier expected.

    1263   describe('Query Building', () => {
                    ~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:1263:28 - error TS1138: Parameter declaration expected.

    1263   describe('Query Building', () => {
                                    ~
    test/unit/handlers/odata-query.handler.test.ts:1263:30 - error TS1138: Parameter declaration expected.

    1263   describe('Query Building', () => {
                                      ~
    test/unit/handlers/odata-query.handler.test.ts:1263:33 - error TS1005: ';' expected.

    1263   describe('Query Building', () => {
                                         ~~
    test/unit/handlers/odata-query.handler.test.ts:1370:4 - error TS1128: Declaration or statement expected.

    1370   });
            ~
    test/unit/handlers/odata-query.handler.test.ts:1372:1 - error TS1005: '}' expected.

    1372 
         

      test/unit/handlers/odata-query.handler.test.ts:836:36
        836   describe('Error Handling', () => {
                                               ~
        The parser expected to find a '}' to match the '{' token here.

FAIL test/unit/handlers/export-work-items.handler.test.ts
  Î“Ã¹Ã… Test suite failed to run

    test/unit/handlers/export-work-items.handler.test.ts:82:85 - error TS2345: Argument of type '"test-token"' is not assignable to parameter of type 'never'.

    82     mockGetTokenProvider.mockReturnValue((jest.fn() as jest.Mock).mockResolvedValue('test-token'));
                                                                                           ~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:224:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    224         new Error('EACCES: permission denied, open \'/root/protected/export.csv\'')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:250:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    250         new Error('ENOSPC: no space left on device')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:276:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    276         new Error('ENOENT: no such file or directory')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:302:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    302         new Error('EROFS: read-only file system')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:334:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    334         new Error('Worksheet name exceeds 31 character limit')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:361:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    361         new Error('Excel row limit (1,048,576) exceeded')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:386:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    386         new Error('Failed to create workbook: Internal library error')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:413:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    413         new Error('Request timeout after 30000ms while fetching work items')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:438:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    438         new Error('HTTP 429: Too Many Requests. Rate limit exceeded.')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:464:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    464         new Error('Work item 999 not found or access denied')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:493:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    493         new Error('JavaScript heap out of memory')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:519:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    519         new Error('Stream write error: Connection closed')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:547:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    547         new Error('Field "NonExistent.Field" not found in work item type definition')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:574:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    574         new Error('Circular relationship detected at depth 3')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:600:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    600         new Error('Comments API unavailable or access denied')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:627:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    627         new Error('History API timeout after fetching 30 revisions')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:661:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    661         new Error('Missing required configuration: organization')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:693:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    693         new Error('Missing required configuration: project')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

FAIL test/unit/handlers/create-new-item.handler.test.ts
  Î“Ã¹Ã… Test suite failed to run

    test/unit/handlers/create-new-item.handler.test.ts:103:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    103         new Error('Template "non-existent-template" not found')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:122:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    122         new Error('Invalid template syntax at line 5')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:141:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    141         new Error('Missing required variable: {projectName}')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:209:44 - error TS2345: Argument of type '{ id: number; title: string; state: string; type: string; parent_linked: boolean; }' is not assignable to parameter of type 'never'.

    209       mockCreateWorkItem.mockResolvedValue({
                                                   ~
    210         id: 123,
        ~~~~~~~~~~~~~~~~
    ... 
    214         parent_linked: false
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    215       });
        ~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:233:44 - error TS2345: Argument of type '{ id: number; title: string; state: string; type: string; parent_linked: boolean; }' is not assignable to parameter of type 'never'.

    233       mockCreateWorkItem.mockResolvedValue({
                                                   ~
    234         id: 124,
        ~~~~~~~~~~~~~~~~
    ... 
    238         parent_linked: false
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    239       });
        ~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:316:44 - error TS2345: Argument of type '{ id: number; title: string; state: string; type: string; parent_linked: boolean; }' is not assignable to parameter of type 'never'.

    316       mockCreateWorkItem.mockResolvedValue({
                                                   ~
    317         id: 125,
        ~~~~~~~~~~~~~~~~
    ... 
    321         parent_linked: false
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    322       });
        ~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:342:44 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    342       mockCreateWorkItem.mockRejectedValue(new Error('TF400898: An Internal Error Occurred'));
                                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:361:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    361         new Error('Parent work item 999999 not found')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:381:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    381         new Error('Cannot create parent-child link between Task and Bug')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:399:44 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    399       mockCreateWorkItem.mockRejectedValue(new Error('HTTP 401: Unauthorized'));
                                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:417:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    417         new Error('TF400813: The user does not have permissions')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:435:44 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    435       mockCreateWorkItem.mockRejectedValue(new Error('Request timeout after 30000ms'));
                                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:510:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    510         new Error('Title cannot be empty')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:528:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    528         new Error('Title cannot contain only whitespace')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

FAIL test/unit/generate-wiql-query-handle.test.ts
  Î“Ã¹Ã… Test suite failed to run

    test/unit/generate-wiql-query-handle.test.ts:146:77 - error TS2345: Argument of type '{ content: { type: string; text: string; }[]; usage: { inputTokens: number; outputTokens: number; }; }' is not assignable to parameter of type 'never'.

    146       (mockSamplingClient.createMessage as jest.Mock).mockResolvedValueOnce({
                                                                                    ~
    147         content: [{ type: 'text', text: 'SELECT [System.Id], [System.Title] FROM WorkItems WHERE [System.State] = \'Active\'' }],
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    148         usage: { inputTokens: 100, outputTokens: 50 }
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    149       });
        ~~~~~~~
    test/unit/generate-wiql-query-handle.test.ts:185:77 - error TS2345: Argument of type '{ content: { type: string; text: string; }[]; usage: { inputTokens: number; outputTokens: number; }; }' is not assignable to parameter of type 'never'.

    185       (mockSamplingClient.createMessage as jest.Mock).mockResolvedValueOnce({
                                                                                    ~
    186         content: [{ type: 'text', text: 'SELECT [System.Id] FROM WorkItems WHERE [System.State] = \'Active\'' }],
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    187         usage: { inputTokens: 100, outputTokens: 50 }
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    188       });
        ~~~~~~~
    test/unit/generate-wiql-query-handle.test.ts:278:77 - error TS2345: Argument of type '{ content: { type: string; text: string; }[]; usage: { inputTokens: number; outputTokens: number; }; }' is not assignable to parameter of type 'never'.

    278       (mockSamplingClient.createMessage as jest.Mock).mockResolvedValueOnce({
                                                                                    ~
    279         content: [{ type: 'text', text: 'SELECT [System.Id] FROM WorkItems WHERE [System.State] = \'NonExistent\'' }],
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    280         usage: { inputTokens: 100, outputTokens: 50 }
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    281       });
        ~~~~~~~
    test/unit/generate-wiql-query-handle.test.ts:326:77 - error TS2345: Argument of type '{ content: { type: string; text: string; }[]; usage: { inputTokens: number; outputTokens: number; }; }' is not assignable to parameter of type 'never'.

    326       (mockSamplingClient.createMessage as jest.Mock).mockResolvedValueOnce({
                                                                                    ~
    327         content: [{ type: 'text', text: 'SELECT [System.Id] FROM WorkItems WHERE [System.State] = \'Active\'' }],
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    328         usage: { inputTokens: 100, outputTokens: 50 }
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    329       });
        ~~~~~~~
    test/unit/generate-wiql-query-handle.test.ts:398:77 - error TS2345: Argument of type '{ content: { type: string; text: string; }[]; usage: { inputTokens: number; outputTokens: number; }; }' is not assignable to parameter of type 'never'.

    398       (mockSamplingClient.createMessage as jest.Mock).mockResolvedValueOnce({
                                                                                    ~
    399         content: [{ type: 'text', text: 'SELECT [System.Id] FROM WorkItems WHERE [System.State] = \'Active\'' }],
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    400         usage: { inputTokens: 100, outputTokens: 50 }
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    401       });
        ~~~~~~~
    test/unit/generate-wiql-query-handle.test.ts:440:77 - error TS2345: Argument of type '{ content: { type: string; text: string; }[]; usage: { inputTokens: number; outputTokens: number; }; }' is not assignable to parameter of type 'never'.

    440       (mockSamplingClient.createMessage as jest.Mock).mockResolvedValueOnce({
                                                                                    ~
    441         content: [{ type: 'text', text: 'SELECT [System.Id] FROM WorkItems WHERE [System.State] = \'Active\'' }],
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    442         usage: { inputTokens: 100, outputTokens: 50 }
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    443       });
        ~~~~~~~
    test/unit/generate-wiql-query-handle.test.ts:510:77 - error TS2345: Argument of type '{ role: string; content: { type: string; text: string; }[]; }' is not assignable to parameter of type 'never'.

    510       (mockSamplingClient.createMessage as jest.Mock).mockResolvedValueOnce({
                                                                                    ~
    511         role: 'assistant',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    ... 
    515         }]
        ~~~~~~~~~~
    516       });
        ~~~~~~~

FAIL test/e2e/workflow-tests.test.ts
  Î“Ã¹Ã… Test suite failed to run

    src/services/handlers/query/wiql-query.handler.ts:211:9 - error TS2322: Type '{ workItems: WiqlWorkItemResult[]; count: number; query: string; totalCount: number; skip: number; top: number; hasMore: boolean; }' is not assignable to type '{ workItems: ADOWorkItem[]; count: number; query: string; totalCount: number; skip: number; top: number; hasMore: boolean; }'.
      Types of property 'workItems' are incompatible.
        Type 'WiqlWorkItemResult[]' is not assignable to type 'ADOWorkItem[]'.
          Type 'WiqlWorkItemResult' is missing the following properties from type 'ADOWorkItem': rev, fields

    211         result = await queryWorkItemsByWiql(queryArgs);
                ~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:316:30 - error TS2339: Property 'additionalFields' does not exist on type 'ADOWorkItem'.

    316         const tagsValue = wi.additionalFields?.['System.Tags'];
                                     ~~~~~~~~~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:320:21 - error TS2339: Property 'title' does not exist on type 'ADOWorkItem'.

    320           title: wi.title,
                            ~~~~~
    src/services/handlers/query/wiql-query.handler.ts:321:21 - error TS2339: Property 'state' does not exist on type 'ADOWorkItem'.

    321           state: wi.state,
                            ~~~~~
    src/services/handlers/query/wiql-query.handler.ts:322:20 - error TS2339: Property 'type' does not exist on type 'ADOWorkItem'.

    322           type: wi.type,
                           ~~~~
    src/services/handlers/query/wiql-query.handler.ts:323:27 - error TS2339: Property 'createdDate' does not exist on type 'ADOWorkItem'.

    323           createdDate: wi.createdDate,
                                  ~~~~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:324:26 - error TS2339: Property 'assignedTo' does not exist on type 'ADOWorkItem'.

    324           assignedTo: wi.assignedTo,
                                 ~~~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:325:24 - error TS2339: Property 'areaPath' does not exist on type 'ADOWorkItem'.

    325           areaPath: wi.areaPath,
                               ~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:326:29 - error TS2339: Property 'iterationPath' does not exist on type 'ADOWorkItem'.

    326           iterationPath: wi.iterationPath,
                                    ~~~~~~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:327:27 - error TS2339: Property 'changedDate' does not exist on type 'ADOWorkItem'.

    327           changedDate: wi.changedDate,
                                  ~~~~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:329:18 - error TS2339: Property 'lastSubstantiveChangeDate' does not exist on type 'ADOWorkItem'.

    329           ...(wi.lastSubstantiveChangeDate && { lastSubstantiveChangeDate: wi.lastSubstantiveChangeDate }),
                         ~~~~~~~~~~~~~~~~~~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:329:79 - error TS2339: Property 'lastSubstantiveChangeDate' does not exist on type 'ADOWorkItem'.

    329           ...(wi.lastSubstantiveChangeDate && { lastSubstantiveChangeDate: wi.lastSubstantiveChangeDate }),
                                                                                      ~~~~~~~~~~~~~~~~~~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:330:18 - error TS2339: Property 'daysInactive' does not exist on type 'ADOWorkItem'.

    330           ...(wi.daysInactive !== undefined && { daysInactive: wi.daysInactive }),
                         ~~~~~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:330:67 - error TS2339: Property 'daysInactive' does not exist on type 'ADOWorkItem'.

    330           ...(wi.daysInactive !== undefined && { daysInactive: wi.daysInactive }),
                                                                          ~~~~~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:331:18 - error TS2339: Property 'additionalFields' does not exist on type 'ADOWorkItem'.

    331           ...(wi.additionalFields && wi.additionalFields)
                         ~~~~~~~~~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:331:41 - error TS2339: Property 'additionalFields' does not exist on type 'ADOWorkItem'.

    331           ...(wi.additionalFields && wi.additionalFields)
                                                ~~~~~~~~~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:340:58 - error TS2339: Property 'lastSubstantiveChangeDate' does not exist on type 'ADOWorkItem'.

    340         successCount: result.workItems.filter((wi) => wi.lastSubstantiveChangeDate !== undefined).length,
                                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:341:84 - error TS2339: Property 'lastSubstantiveChangeDate' does not exist on type 'ADOWorkItem'.

    341         failureCount: result.workItems.length - result.workItems.filter((wi) => wi.lastSubstantiveChangeDate !== undefined).length
                                                                                           ~~~~~~~~~~~~~~~~~~~~~~~~~

  console.error
    [2025-12-06T00:27:30.312Z] [INFO] Undoing 1 operation(s) on query handle qh_5eda4d99c77831bde04386e21fd11a40

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkUndoByQueryHandle (src/services/handlers/bulk-operations/bulk-undo-by-query-handle.handler.ts:68:12)
      at Object.<anonymous> (test/integration/bulk-undo-real.test.ts:108:55)

  console.error
    [2025-12-06T00:27:34.840Z] [INFO] Query Handle Service initialized at 2025-12-06T00:27:34.840Z

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:120:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:35.019Z] [INFO] Query handle expiration: 1440 minutes (max: 2880 minutes)

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at new QueryHandleService (src/services/query-handle-service.ts:121:12)
      at Object.<anonymous> (src/services/query-handle-service.ts:835:35)
      at test/setup.ts:49:36
      at Object.<anonymous> (test/setup.ts:49:36)

  console.error
    [2025-12-06T00:27:35.027Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

FAIL test/unit/hybridTransport.test.ts (37.152 s)
  HybridStdioServerTransport
    Transport Initialization
      Î“ÃªÃœ should create transport with default streams (32 ms)
      Î“ÃªÃœ should create transport with custom streams (1 ms)
      Î“ÃªÃœ should start successfully (1 ms)
      Î“ÃªÃœ should throw error when starting already started transport (23 ms)
      Î“ÃªÃœ should close successfully (1 ms)
      Î“ÃªÃœ should trigger onclose callback when closed (1 ms)
    Message Sending
      Î“ÃªÃœ should send message with Content-Length framing by default (2 ms)
      Î“ÃªÃœ should send message with newline framing when MCP_FORCE_NEWLINE=1 (2 ms)
      Î“ÃªÃœ should send message with Content-Length framing when MCP_FORCE_CONTENT_LENGTH=1 (3 ms)
      Î“ÃªÃœ should calculate correct Content-Length for UTF-8 strings (1 ms)
      Î“ÃªÃœ should handle backpressure with drain event (3 ms)
    Message Receiving - Content-Length Framing
      Î“ÃªÃœ should receive complete Content-Length framed message (9 ms)
      Î“ÃªÃœ should handle message arriving in multiple chunks (17 ms)
      Î“ÃªÃœ should handle multiple messages in one chunk (58 ms)
      Î“ÃªÃœ should handle UTF-8 characters in Content-Length framed messages (5 ms)
      Î“ÃªÃœ should wait for complete message body before parsing (55 ms)
    Message Receiving - Newline Framing
      Î“ÃªÃœ should receive newline-delimited JSON message (1 ms)
      Î“ÃªÃœ should handle multiple newline-delimited messages (57 ms)
      â”œÃ¹ should ignore empty lines in newline-delimited mode (68 ms)
      Î“ÃªÃœ should handle CRLF line endings in newline mode (1 ms)
    Error Handling
      â”œÃ¹ should trigger onerror callback for invalid JSON in message body (30005 ms)
      Î“ÃªÃœ should trigger onerror callback for invalid newline-delimited JSON (2 ms)
      Î“ÃªÃœ should handle stdin error events (1 ms)
      Î“ÃªÃœ should skip malformed Content-Length header and continue (62 ms)
      â”œÃ¹ should not crash on data processing errors (94 ms)
    Connection Lifecycle
      â”œÃ¹ should handle start -> send -> receive -> close lifecycle (62 ms)
      Î“ÃªÃœ should not accept messages after close (66 ms)
    Buffer Management
      Î“ÃªÃœ should handle large messages without buffer issues (2 ms)
      Î“ÃªÃœ should correctly accumulate partial messages in buffer (231 ms)
    Auto-Detection of Framing Mode
      Î“ÃªÃœ should detect Content-Length framing when header present (1 ms)
      Î“ÃªÃœ should detect newline framing when message starts with brace
      Î“ÃªÃœ should handle mixed framing modes in sequence (123 ms)

  Î“Ã¹Ã… HybridStdioServerTransport Î“Ã‡â•‘ Message Receiving - Newline Framing Î“Ã‡â•‘ should ignore empty lines in newline-delimited mode

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 0
    Received array:  []

      344 |       await new Promise(resolve => setTimeout(resolve, 50));
      345 |       
    > 346 |       expect(messages).toHaveLength(1);
          |                        ^
      347 |       expect(messages[0]).toEqual(message);
      348 |     });
      349 |     

      at Object.<anonymous> (test/unit/hybridTransport.test.ts:346:24)

  Î“Ã¹Ã… HybridStdioServerTransport Î“Ã‡â•‘ Error Handling Î“Ã‡â•‘ should trigger onerror callback for invalid JSON in message body

    thrown: "Exceeded timeout of 30000 ms for a test while waiting for `done()` to be called.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

      366 |     });
      367 |     
    > 368 |     it('should trigger onerror callback for invalid JSON in message body', (done) => {
          |       ^
      369 |       const invalidJson = 'Content-Length: 10\r\n\r\n{invalid}';
      370 |       
      371 |       transport.onerror = (err) => {

      at test/unit/hybridTransport.test.ts:368:7
      at test/unit/hybridTransport.test.ts:363:11
      at Object.<anonymous> (test/unit/hybridTransport.test.ts:14:9)

  Î“Ã¹Ã… HybridStdioServerTransport Î“Ã‡â•‘ Error Handling Î“Ã‡â•‘ should not crash on data processing errors

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 1
    Received:    0

      447 |       await new Promise(resolve => setTimeout(resolve, 50));
      448 |       // Should have received the valid message despite earlier errors
    > 449 |       expect(messages.length).toBeGreaterThanOrEqual(1);
          |                               ^
      450 |     });
      451 |   });
      452 |   

      at Object.<anonymous> (test/unit/hybridTransport.test.ts:449:31)

  Î“Ã¹Ã… HybridStdioServerTransport Î“Ã‡â•‘ Connection Lifecycle Î“Ã‡â•‘ should handle start -> send -> receive -> close lifecycle

    expect(received).toContain(expected) // indexOf

    Expected value: {"id": 1, "jsonrpc": "2.0", "result": {"initialized": true}}
    Received array: [{"id": 1, "jsonrpc": "2.0", "result": {"initialized": true}}]

    Looks like you wanted to test for object/array equality with the stricter `toContain` matcher. You probably need to use `toContainEqual` instead.

      500 |       // Verify lifecycle
      501 |       expect(sentMessages.length).toBeGreaterThan(0);
    > 502 |       expect(receivedMessages).toContain(incomingMessage);
          |                                ^
      503 |       expect(closeCalled).toBe(true);
      504 |     });
      505 |     

      at Object.<anonymous> (test/unit/hybridTransport.test.ts:502:32)

  console.error
    [2025-12-06T00:27:36.452Z] [INFO] Undoing 1 operation(s) on query handle qh_fdb0b5ae089118799517a973488aa574

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkUndoByQueryHandle (src/services/handlers/bulk-operations/bulk-undo-by-query-handle.handler.ts:68:12)
      at Object.<anonymous> (test/integration/bulk-undo-real.test.ts:137:55)

  console.error
    [2025-12-06T00:27:43.165Z] [INFO] Undoing 1 operation(s) on query handle qh_e1647ee67b70611304a5325d8e372bff

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkUndoByQueryHandle (src/services/handlers/bulk-operations/bulk-undo-by-query-handle.handler.ts:68:12)
      at Object.<anonymous> (test/integration/bulk-undo-real.test.ts:166:55)

FAIL test/unit/bulk-preview-limits.test.ts (45.539 s)
  Bulk Operation Preview Limits
    â”œÃ¹ should respect maxPreviewItems in dry-run mode for comment action (6094 ms)
    â”œÃ¹ should respect maxPreviewItems in dry-run mode for update action (6034 ms)
    â”œÃ¹ should respect maxPreviewItems in dry-run mode for assign action (7044 ms)
    â”œÃ¹ should respect maxPreviewItems in dry-run mode for multiple actions (6325 ms)
    â”œÃ¹ should use default maxPreviewItems when not specified (7230 ms)
    â”œÃ¹ should handle maxPreviewItems larger than item count (6694 ms)

  Î“Ã¹Ã… Bulk Operation Preview Limits Î“Ã‡â•‘ should respect maxPreviewItems in dry-run mode for comment action

    TypeError: (0 , logger_js_1.errorToContext) is not a function

      239 |
      240 |   } catch (error) {
    > 241 |     logger.error("Unified bulk operations error:", errorToContext(error));
          |                                                                  ^
      242 |     return {
      243 |       success: false,
      244 |       data: null,

      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:66)
      at Object.<anonymous> (test/unit/bulk-preview-limits.test.ts:85:53)

  Î“Ã¹Ã… Bulk Operation Preview Limits Î“Ã‡â•‘ should respect maxPreviewItems in dry-run mode for update action

    TypeError: (0 , logger_js_1.errorToContext) is not a function

      239 |
      240 |   } catch (error) {
    > 241 |     logger.error("Unified bulk operations error:", errorToContext(error));
          |                                                                  ^
      242 |     return {
      243 |       success: false,
      244 |       data: null,

      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:66)
      at Object.<anonymous> (test/unit/bulk-preview-limits.test.ts:110:53)

  Î“Ã¹Ã… Bulk Operation Preview Limits Î“Ã‡â•‘ should respect maxPreviewItems in dry-run mode for assign action

    TypeError: (0 , logger_js_1.errorToContext) is not a function

      239 |
      240 |   } catch (error) {
    > 241 |     logger.error("Unified bulk operations error:", errorToContext(error));
          |                                                                  ^
      242 |     return {
      243 |       success: false,
      244 |       data: null,

      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:66)
      at Object.<anonymous> (test/unit/bulk-preview-limits.test.ts:132:53)

  Î“Ã¹Ã… Bulk Operation Preview Limits Î“Ã‡â•‘ should respect maxPreviewItems in dry-run mode for multiple actions

    TypeError: (0 , logger_js_1.errorToContext) is not a function

      239 |
      240 |   } catch (error) {
    > 241 |     logger.error("Unified bulk operations error:", errorToContext(error));
          |                                                                  ^
      242 |     return {
      243 |       success: false,
      244 |       data: null,

      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:66)
      at Object.<anonymous> (test/unit/bulk-preview-limits.test.ts:158:53)

  Î“Ã¹Ã… Bulk Operation Preview Limits Î“Ã‡â•‘ should use default maxPreviewItems when not specified

    TypeError: (0 , logger_js_1.errorToContext) is not a function

      239 |
      240 |   } catch (error) {
    > 241 |     logger.error("Unified bulk operations error:", errorToContext(error));
          |                                                                  ^
      242 |     return {
      243 |       success: false,
      244 |       data: null,

      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:66)
      at Object.<anonymous> (test/unit/bulk-preview-limits.test.ts:181:53)

  Î“Ã¹Ã… Bulk Operation Preview Limits Î“Ã‡â•‘ should handle maxPreviewItems larger than item count

    TypeError: (0 , logger_js_1.errorToContext) is not a function

      239 |
      240 |   } catch (error) {
    > 241 |     logger.error("Unified bulk operations error:", errorToContext(error));
          |                                                                  ^
      242 |     return {
      243 |       success: false,
      244 |       data: null,

      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:66)
      at Object.<anonymous> (test/unit/bulk-preview-limits.test.ts:203:53)

FAIL test/integration/bulk-operations-integration.test.ts (50.045 s)
  Bulk Operations Integration
    â”œÃ¹ should execute comment action in dry-run mode (6196 ms)
    â”œÃ¹ should execute update action in dry-run mode (6034 ms)
    â”œÃ¹ should execute multiple actions in sequence (dry-run) (6176 ms)
    Î“ÃªÃœ should handle invalid query handle gracefully (5739 ms)
    â”œÃ¹ should support item selector with indices (6421 ms)
    â”œÃ¹ should handle stopOnError parameter (6731 ms)
    Î“ÃªÃœ should validate required action parameters (6618 ms)

  Î“Ã¹Ã… Bulk Operations Integration Î“Ã‡â•‘ should execute comment action in dry-run mode

    TypeError: (0 , logger_js_1.errorToContext) is not a function

      239 |
      240 |   } catch (error) {
    > 241 |     logger.error("Unified bulk operations error:", errorToContext(error));
          |                                                                  ^
      242 |     return {
      243 |       success: false,
      244 |       data: null,

      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:66)
      at Object.<anonymous> (test/integration/bulk-operations-integration.test.ts:110:53)

  Î“Ã¹Ã… Bulk Operations Integration Î“Ã‡â•‘ should execute update action in dry-run mode

    TypeError: (0 , logger_js_1.errorToContext) is not a function

      239 |
      240 |   } catch (error) {
    > 241 |     logger.error("Unified bulk operations error:", errorToContext(error));
          |                                                                  ^
      242 |     return {
      243 |       success: false,
      244 |       data: null,

      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:66)
      at Object.<anonymous> (test/integration/bulk-operations-integration.test.ts:134:53)

  Î“Ã¹Ã… Bulk Operations Integration Î“Ã‡â•‘ should execute multiple actions in sequence (dry-run)

    TypeError: (0 , logger_js_1.errorToContext) is not a function

      239 |
      240 |   } catch (error) {
    > 241 |     logger.error("Unified bulk operations error:", errorToContext(error));
          |                                                                  ^
      242 |     return {
      243 |       success: false,
      244 |       data: null,

      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:66)
      at Object.<anonymous> (test/integration/bulk-operations-integration.test.ts:165:53)

  Î“Ã¹Ã… Bulk Operations Integration Î“Ã‡â•‘ should support item selector with indices

    TypeError: (0 , logger_js_1.errorToContext) is not a function

      239 |
      240 |   } catch (error) {
    > 241 |     logger.error("Unified bulk operations error:", errorToContext(error));
          |                                                                  ^
      242 |     return {
      243 |       success: false,
      244 |       data: null,

      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:66)
      at Object.<anonymous> (test/integration/bulk-operations-integration.test.ts:208:53)

  Î“Ã¹Ã… Bulk Operations Integration Î“Ã‡â•‘ should handle stopOnError parameter

    TypeError: (0 , logger_js_1.errorToContext) is not a function

      239 |
      240 |   } catch (error) {
    > 241 |     logger.error("Unified bulk operations error:", errorToContext(error));
          |                                                                  ^
      242 |     return {
      243 |       success: false,
      244 |       data: null,

      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:66)
      at Object.<anonymous> (test/integration/bulk-operations-integration.test.ts:235:53)

  console.error
    [2025-12-06T00:27:49.701Z] [INFO] Undoing 1 operation(s) on query handle qh_88fe847542b1215d6e7ba42cd492105c

    [0m [90m 27 |[39m       [36mreturn[39m[33m;[39m
     [90m 28 |[39m     }
    [31m[1m>[22m[39m[90m 29 |[39m     originalConsoleError([33m...[39margs)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 30 |[39m   })[33m;[39m
     [90m 31 |[39m   
     [90m 32 |[39m   console[33m.[39mwarn [33m=[39m jest[33m.[39mfn(([33m...[39margs) [33m=>[39m {[0m

      at console.<anonymous> (test/setup.ts:29:5)
      at Logger.info (src/utils/logger.ts:127:15)
      at handleBulkUndoByQueryHandle (src/services/handlers/bulk-operations/bulk-undo-by-query-handle.handler.ts:68:12)
      at Object.<anonymous> (test/integration/bulk-undo-real.test.ts:207:55)

  console.error
    [2025-12-06T00:27:59.870Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/integration/bulk-undo-real.test.ts (61.976 s)
  Bulk Undo Integration Tests
    Query handle validation
      Î“ÃªÃœ should return error if query handle not found (5924 ms)
      Î“ÃªÃœ should return error if no operation history exists (6334 ms)
    Dry run validation
      Î“ÃªÃœ should preview undo without making changes when dryRun is true (6331 ms)
      Î“ÃªÃœ should limit preview items to maxPreviewItems (6453 ms)
      Î“ÃªÃœ should include warning for bulk-comment operations (6138 ms)
    Default behavior
      Î“ÃªÃœ should default to dryRun=true (6713 ms)
    Multiple operations in history
      Î“ÃªÃœ should undo only the last operation (6537 ms)
    Error handling
      Î“ÃªÃœ should handle invalid arguments gracefully (5399 ms)
      Î“ÃªÃœ should handle empty query handle (4745 ms)

PASS test/unit/create-work-item-parent-validation.test.ts (78.988 s)
  Create Work Item - Parent Validation
    Root-level work item types (no parent required)
      Î“ÃªÃœ should allow creating an Epic without a parent (6588 ms)
      Î“ÃªÃœ should allow creating a Key Result without a parent (6334 ms)
    Non-root work item types (parent required)
      Î“ÃªÃœ should reject creating a Feature without a parent (6283 ms)
      Î“ÃªÃœ should reject creating a User Story without a parent (7605 ms)
      Î“ÃªÃœ should reject creating a Task without a parent (6747 ms)
      Î“ÃªÃœ should reject creating a Bug without a parent (6915 ms)
      Î“ÃªÃœ should reject creating a Product Backlog Item without a parent (6167 ms)
      Î“ÃªÃœ should reject using default work item type (User Story) without a parent (5291 ms)
    Work items with parents
      Î“ÃªÃœ should allow creating a Feature with a parent (4950 ms)
      Î“ÃªÃœ should allow creating a User Story with a parent (5352 ms)
    Schema validation
      Î“ÃªÃœ should validate at schema level when explicit work item type provided (1 ms)
      Î“ÃªÃœ should pass schema validation for Epic without parent
      Î“ÃªÃœ should pass schema validation for Key Result without parent (1 ms)
      Î“ÃªÃœ should pass schema validation when parent is provided
      Î“ÃªÃœ should pass schema validation when no workItemType specified (default will be checked at runtime)
    Edge cases
      Î“ÃªÃœ should handle whitespace in work item type names (5195 ms)
      Î“ÃªÃœ should be case-sensitive for work item type names (4897 ms)

  console.error
    [2025-12-06T00:28:29.492Z] [INFO] [Telemetry] Shutdown complete

    [0m [90m 125 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39mmcpConnected) {
     [90m 126 |[39m       [36mconst[39m contextStr [33m=[39m context [33m?[39m [32m` ${JSON.stringify(context)}`[39m [33m:[39m [32m''[39m[33m;[39m
    [31m[1m>[22m[39m[90m 127 |[39m       console[33m.[39merror([32m`[${timestamp}] [INFO] ${message}${contextStr}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 128 |[39m     }
     [90m 129 |[39m     
     [90m 130 |[39m     [90m// Always write to file if configured[39m[0m

      at Logger.info (src/utils/logger.ts:127:15)
      at TelemetryService.shutdown (src/services/telemetry-service.ts:639:12)
      at Object.<anonymous> (test/setup.ts:64:28)

PASS test/unit/bulk-undo.test.ts (91.566 s)
  Bulk Undo by Query Handle Handler
    Input validation
      Î“ÃªÃœ should return error for empty query handle (5968 ms)
      Î“ÃªÃœ should return error for invalid maxPreviewItems (too high) (6318 ms)
      Î“ÃªÃœ should return error for invalid maxPreviewItems (too low) (6591 ms)
      Î“ÃªÃœ should accept valid parameters (7648 ms)
    Non-existent query handle
      Î“ÃªÃœ should return error for non-existent query handle (6615 ms)
      Î“ÃªÃœ should handle very long query handle names (6987 ms)
    Configuration defaults
      Î“ÃªÃœ should use default dryRun when not specified (6230 ms)
      Î“ÃªÃœ should use default maxPreviewItems when not specified (5317 ms)
      Î“ÃªÃœ should accept custom organization and project (4979 ms)
    Error handling
      Î“ÃªÃœ should handle unexpected errors gracefully (5274 ms)
      Î“ÃªÃœ should return structured error response (5235 ms)
    Schema validation edge cases
      Î“ÃªÃœ should reject negative maxPreviewItems (4974 ms)
      Î“ÃªÃœ should accept valid range for maxPreviewItems (4384 ms)
      Î“ÃªÃœ should handle boolean values for dryRun (8294 ms)

Summary of all failing tests
FAIL test/unit/selection-integration.test.ts (6.771 s)
  Î“Ã¹Ã… Selection Integration Tests Î“Ã‡â•‘ Scenario 1: Full Workflow - Query to Bulk Comment Î“Ã‡â•‘ should complete full workflow: query Î“Ã¥Ã† select Î“Ã¥Ã† bulk comment

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      162 |       });
      163 |       
    > 164 |       expect(commentResult.success).toBe(true);
          |                                     ^
      165 |       const data = commentResult.data as any;
      166 |       expect(data.items_selected).toBe(2);
      167 |     });

      at Object.<anonymous> (test/unit/selection-integration.test.ts:164:37)

  Î“Ã¹Ã… Selection Integration Tests Î“Ã‡â•‘ Scenario 2: Single Item Selection (Index-Based) Î“Ã‡â•‘ should select and update a single item by index

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      204 |       });
      205 |       
    > 206 |       expect(updateResult.success).toBe(true);
          |                                    ^
      207 |       const data = updateResult.data as any;
      208 |       expect(data.items_selected).toBe(1);
      209 |     });

      at Object.<anonymous> (test/unit/selection-integration.test.ts:206:36)

  Î“Ã¹Ã… Selection Integration Tests Î“Ã‡â•‘ Scenario 3: Multiple Item Selection (Index Array) Î“Ã‡â•‘ should select and assign multiple items by indices

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      241 |       });
      242 |       
    > 243 |       expect(assignResult.success).toBe(true);
          |                                    ^
      244 |       const data = assignResult.data as any;
      245 |       expect(data.items_selected).toBe(4);
      246 |     });

      at Object.<anonymous> (test/unit/selection-integration.test.ts:243:36)

  Î“Ã¹Ã… Selection Integration Tests Î“Ã‡â•‘ Scenario 4: Criteria-Based Selection (States + Tags) Î“Ã‡â•‘ should select items matching multiple criteria

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      297 |       });
      298 |       
    > 299 |       expect(commentResult.success).toBe(true);
          |                                     ^
      300 |       const data = commentResult.data as any;
      301 |       expect(data.items_selected).toBe(2);
      302 |     });

      at Object.<anonymous> (test/unit/selection-integration.test.ts:299:37)

  Î“Ã¹Ã… Selection Integration Tests Î“Ã‡â•‘ Scenario 5: Selection by Staleness Î“Ã‡â•‘ should select stale items for followup

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      351 |       });
      352 |       
    > 353 |       expect(result.success).toBe(true);
          |                              ^
      354 |       const data = result.data as any;
      355 |       expect(data.items_selected).toBe(2);
      356 |     });

      at Object.<anonymous> (test/unit/selection-integration.test.ts:353:30)

FAIL test/unit/unified-bulk-operations.test.ts (7.002 s)
  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Dry Run Mode Î“Ã‡â•‘ should preview operations without executing in dry-run mode

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      101 |
      102 |       // Assert
    > 103 |       expect(result.success).toBe(true);
          |                              ^
      104 |       expect((result.data as any).dry_run).toBe(true);
      105 |       expect((result.data as any).actions_completed).toBe(2);
      106 |       expect((result.data as any).actions_failed).toBe(0);

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:103:30)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Comment Action Î“Ã‡â•‘ should add comments to all work items

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      132 |
      133 |       // Assert
    > 134 |       expect(result.success).toBe(true);
          |                              ^
      135 |       expect(mockPostFn).toHaveBeenCalledTimes(2);
      136 |       expect(mockPostFn).toHaveBeenCalledWith(
      137 |         expect.stringContaining('wit/workItems/101/comments'),

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:134:30)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Comment Action Î“Ã‡â•‘ should handle comment failures gracefully

    TypeError: Cannot read properties of null (reading 'action_results')

      168 |       // Assert
      169 |       expect(result.success).toBe(false);
    > 170 |       expect((result.data as any).action_results[0].items_succeeded).toBe(1);
          |                                   ^
      171 |       expect((result.data as any).action_results[0].items_failed).toBe(1);
      172 |     });
      173 |   });

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:170:35)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Update Action Î“Ã‡â•‘ should update work item fields

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      200 |
      201 |       // Assert
    > 202 |       expect(result.success).toBe(true);
          |                              ^
      203 |       expect(mockPatchFn).toHaveBeenCalledWith(
      204 |         expect.stringContaining('wit/workItems/101'),
      205 |         expect.arrayContaining([

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:202:30)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Assign Action Î“Ã‡â•‘ should assign work items to user

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      239 |
      240 |       // Assert
    > 241 |       expect(result.success).toBe(true);
          |                              ^
      242 |       expect(mockPatchFn).toHaveBeenCalledTimes(2);
      243 |       expect(mockPatchFn).toHaveBeenCalledWith(
      244 |         expect.stringContaining('wit/workItems/101'),

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:241:30)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Assign Action Î“Ã‡â•‘ should add comment when assigning with comment

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      279 |
      280 |       // Assert
    > 281 |       expect(result.success).toBe(true);
          |                              ^
      282 |       expect(mockPatchFn).toHaveBeenCalledTimes(1); // Assignment
      283 |       expect(mockPostFn).toHaveBeenCalledTimes(1); // Comment
      284 |     });

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:281:30)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Remove Action Î“Ã‡â•‘ should move work items to Removed state

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      310 |
      311 |       // Assert
    > 312 |       expect(result.success).toBe(true);
          |                              ^
      313 |       expect(mockPostFn).toHaveBeenCalledWith(
      314 |         expect.stringContaining('wit/workItems/101/comments'),
      315 |         expect.objectContaining({

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:312:30)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Transition State Action Î“Ã‡â•‘ should transition work items to new state

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      356 |
      357 |       // Assert
    > 358 |       expect(result.success).toBe(true);
          |                              ^
      359 |       expect(mockPatchFn).toHaveBeenCalledWith(
      360 |         expect.stringContaining('wit/workItems/101'),
      361 |         expect.arrayContaining([

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:358:30)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Move Iteration Action Î“Ã‡â•‘ should move work items to new iteration

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      400 |
      401 |       // Assert
    > 402 |       expect(result.success).toBe(true);
          |                              ^
      403 |       expect(mockPatchFn).toHaveBeenCalledWith(
      404 |         expect.stringContaining('wit/workItems/101'),
      405 |         expect.arrayContaining([

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:402:30)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Add Tag Action Î“Ã‡â•‘ should add tags to work items

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      451 |
      452 |       // Assert
    > 453 |       expect(result.success).toBe(true);
          |                              ^
      454 |       expect(mockGetFn).toHaveBeenCalledWith(
      455 |         expect.stringContaining('wit/workitems?ids=101&fields=System.Tags')
      456 |       );

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:453:30)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Remove Tag Action Î“Ã‡â•‘ should remove tags from work items

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      500 |
      501 |       // Assert
    > 502 |       expect(result.success).toBe(true);
          |                              ^
      503 |       expect(mockPatchFn).toHaveBeenCalledWith(
      504 |         expect.stringContaining('wit/workItems/101'),
      505 |         expect.arrayContaining([

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:502:30)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Sequential Execution Î“Ã‡â•‘ should execute multiple actions sequentially

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      544 |
      545 |       // Assert
    > 546 |       expect(result.success).toBe(true);
          |                              ^
      547 |       expect((result.data as any).actions_completed).toBe(3);
      548 |       expect((result.data as any).actions_failed).toBe(0);
      549 |       expect(mockPostFn).toHaveBeenCalledTimes(1); // Comment

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:546:30)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Sequential Execution Î“Ã‡â•‘ should stop on error when stopOnError is true

    TypeError: Cannot read properties of null (reading 'actions_completed')

      575 |       // Assert
      576 |       expect(result.success).toBe(false);
    > 577 |       expect((result.data as any).actions_completed).toBe(0);
          |                                   ^
      578 |       expect((result.data as any).actions_failed).toBe(1);
      579 |       expect(mockPatchFn).not.toHaveBeenCalled(); // Second action not executed
      580 |     });

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:577:35)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Sequential Execution Î“Ã‡â•‘ should continue on error when stopOnError is false

    TypeError: Cannot read properties of null (reading 'actions_completed')

      605 |       // Assert
      606 |       expect(result.success).toBe(false);
    > 607 |       expect((result.data as any).actions_completed).toBe(1);
          |                                   ^
      608 |       expect((result.data as any).actions_failed).toBe(1);
      609 |       expect(mockPatchFn).toHaveBeenCalled(); // Second action executed
      610 |     });

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:607:35)

  Î“Ã¹Ã… Unified Bulk Operations Handler Î“Ã‡â•‘ Item Selector Support Î“Ã‡â•‘ should support itemSelector with indices

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      671 |
      672 |       // Assert
    > 673 |       expect(result.success).toBe(true);
          |                              ^
      674 |       expect((result.data as any).items_selected).toBe(2);
      675 |       expect(mockPostFn).toHaveBeenCalledTimes(2);
      676 |     });

      at Object.<anonymous> (test/unit/unified-bulk-operations.test.ts:673:30)

FAIL test/unit/handlers/get-work-item-context-package.handler.test.ts
  Î“Ã¹Ã… Test suite failed to run

    test/unit/handlers/get-work-item-context-package.handler.test.ts:70:85 - error TS2345: Argument of type '"test-token"' is not assignable to parameter of type 'never'.

    70     mockGetTokenProvider.mockReturnValue((jest.fn() as jest.Mock).mockResolvedValue('test-token'));
                                                                                           ~~~~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:95:44 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    95       mockHttpClient.get.mockRejectedValue(new Error('Work item not found'));
                                                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:113:44 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    113       mockHttpClient.get.mockRejectedValue(new Error('Invalid work item ID'));
                                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:130:44 - error TS2345: Argument of type '{ status: number; message: string; }' is not assignable to parameter of type 'never'.

    130       mockHttpClient.get.mockRejectedValue({ status: 404, message: 'Not found' });
                                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:152:44 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    152       mockHttpClient.get.mockRejectedValue(timeoutError);
                                                   ~~~~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:171:44 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    171       mockHttpClient.get.mockRejectedValue(new Error('ECONNREFUSED'));
                                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:190:44 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    190       mockHttpClient.get.mockRejectedValue(new Error('ENOTFOUND dev.azure.com'));
                                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:208:44 - error TS2345: Argument of type '{ status: number; message: string; statusText: string; }' is not assignable to parameter of type 'never'.

    208       mockHttpClient.get.mockRejectedValue({
                                                   ~
    209         status: 500,
        ~~~~~~~~~~~~~~~~~~~~
    ... 
    211         statusText: 'Internal Server Error'
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    212       });
        ~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:230:44 - error TS2345: Argument of type '{ status: number; message: string; statusText: string; }' is not assignable to parameter of type 'never'.

    230       mockHttpClient.get.mockRejectedValue({
                                                   ~
    231         status: 401,
        ~~~~~~~~~~~~~~~~~~~~
    ... 
    233         statusText: 'Unauthorized'
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    234       });
        ~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:253:44 - error TS2345: Argument of type '{ status: number; message: string; statusText: string; }' is not assignable to parameter of type 'never'.

    253       mockHttpClient.get.mockRejectedValue({
                                                   ~
    254         status: 403,
        ~~~~~~~~~~~~~~~~~~~~
    ... 
    256         statusText: 'Forbidden'
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    257       });
        ~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:278:44 - error TS2345: Argument of type '{ data: { id: number; }; status: number; }' is not assignable to parameter of type 'never'.

    278       mockHttpClient.get.mockResolvedValue({
                                                   ~
    279         data: {
        ~~~~~~~~~~~~~~~
    ... 
    283         status: 200
        ~~~~~~~~~~~~~~~~~~~
    284       });
        ~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:294:44 - error TS2345: Argument of type '{ data: null; status: number; }' is not assignable to parameter of type 'never'.

    294       mockHttpClient.get.mockResolvedValue({
                                                   ~
    295         data: null,
        ~~~~~~~~~~~~~~~~~~~
    296         status: 200
        ~~~~~~~~~~~~~~~~~~~
    297       });
        ~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:315:44 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    315       mockHttpClient.get.mockRejectedValue(new Error('Unexpected token < in JSON at position 0'));
                                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:340:32 - error TS2345: Argument of type '{ data: { id: number; fields: { 'System.Title': string; 'System.State': string; }; }; status: number; }' is not assignable to parameter of type 'never'.

    340         .mockResolvedValueOnce({
                                       ~
    341           data: {
        ~~~~~~~~~~~~~~~~~
    ... 
    345           status: 200
        ~~~~~~~~~~~~~~~~~~~~~
    346         })
        ~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:348:32 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    348         .mockRejectedValueOnce(new Error('Comments API unavailable'));
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:371:32 - error TS2345: Argument of type '{ data: { id: number; fields: { 'System.Title': string; 'System.State': string; }; }; status: number; }' is not assignable to parameter of type 'never'.

    371         .mockResolvedValueOnce({
                                       ~
    372           data: {
        ~~~~~~~~~~~~~~~~~
    ... 
    376           status: 200
        ~~~~~~~~~~~~~~~~~~~~~
    377         })
        ~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:378:32 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    378         .mockRejectedValueOnce(new Error('History API timeout'));
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:400:32 - error TS2345: Argument of type '{ data: { id: number; fields: { 'System.Title': string; 'System.WorkItemType': string; }; relations: { rel: string; url: string; }[]; }; status: number; }' is not assignable to parameter of type 'never'.

    400         .mockResolvedValueOnce({
                                       ~
    401           data: {
        ~~~~~~~~~~~~~~~~~
    ... 
    406           status: 200
        ~~~~~~~~~~~~~~~~~~~~~
    407         })
        ~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:408:32 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    408         .mockRejectedValueOnce(new Error('Child work item not found'));
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/get-work-item-context-package.handler.test.ts:429:44 - error TS2345: Argument of type '{ data: { id: number; fields: { 'System.Title': string; }; relations: ({ rel: string; url: string; } | { rel: string; url: null; })[]; }; status: number; }' is not assignable to parameter of type 'never'.

    429       mockHttpClient.get.mockResolvedValue({
                                                   ~
    430         data: {
        ~~~~~~~~~~~~~~~
    ... 
    438         status: 200
        ~~~~~~~~~~~~~~~~~~~
    439       });
        ~~~~~~~

FAIL test/unit/handlers/odata-query.handler.test.ts
  Î“Ã¹Ã… Test suite failed to run

    test/unit/handlers/odata-query.handler.test.ts:120:68 - error TS2345: Argument of type '"mock-token"' is not assignable to parameter of type 'never'.

    120     const mockTokenFn = (jest.fn() as jest.Mock).mockResolvedValue('mock-token');
                                                                           ~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:124:51 - error TS2345: Argument of type '(path: string) => string' is not assignable to parameter of type 'UnknownFunction'.
      Types of parameters 'path' and 'args' are incompatible.
        Type 'unknown' is not assignable to type 'string'.

    124     mockEscapeAreaPathForOData.mockImplementation((path: string) => {
                                                          ~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:205:32 - error TS2349: This expression is not callable.
      Type '{ name: string; description: string; schema: ZodObject<{ organization: ZodOptional<ZodString>; project: ZodOptional<ZodString>; description: ZodOptional<...>; ... 23 more ...; iterationPath: ZodOptional<...>; }, "strip", ZodTypeAny, { ...; }, { ...; }>; describe(: any): any; }' has no call signatures.

    205     const config: ToolConfig = {
                                       ~
    206       name: 'query-odata',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    ... 
    208       schema: odataQuerySchema,
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    209   describe('Input Validation', () => {
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:209:12 - error TS7006: Parameter '(Missing)' implicitly has an 'any' type.

    209   describe('Input Validation', () => {
                   
    test/unit/handlers/odata-query.handler.test.ts:213:14 - error TS2304: Cannot find name 'result'.

    213       expect(result.success).toBe(false);
                     ~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:214:14 - error TS2304: Cannot find name 'result'.

    214       expect(result.errors).toBeDefined();
                     ~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:247:32 - error TS2349: This expression is not callable.
      Type '{ name: string; description: string; schema: ZodObject<{ organization: ZodOptional<ZodString>; project: ZodOptional<ZodString>; description: ZodOptional<...>; ... 23 more ...; iterationPath: ZodOptional<...>; }, "strip", ZodTypeAny, { ...; }, { ...; }>; describe(: any): any; }' has no call signatures.

    247     const config: ToolConfig = {
                                       ~
    248       name: 'query-odata',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    ... 
    250       schema: odataQuerySchema,
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    251   describe('Area Path Filtering', () => {
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:251:12 - error TS7006: Parameter '(Missing)' implicitly has an 'any' type.

    251   describe('Area Path Filtering', () => {
                   
    test/unit/handlers/odata-query.handler.test.ts:257:27 - error TS2552: Cannot find name 'mockResponse'. Did you mean 'Response'?

    257         json: async () => mockResponse,
                                  ~~~~~~~~~~~~

      node_modules/typescript/lib/lib.dom.d.ts:26367:13
        26367 declare var Response: {
                          ~~~~~~~~
        'Response' is declared here.
    test/unit/handlers/odata-query.handler.test.ts:258:42 - error TS2552: Cannot find name 'mockResponse'. Did you mean 'Response'?

    258         text: async () => JSON.stringify(mockResponse)
                                                 ~~~~~~~~~~~~

      node_modules/typescript/lib/lib.dom.d.ts:26367:13
        26367 declare var Response: {
                          ~~~~~~~~
        'Response' is declared here.
    test/unit/handlers/odata-query.handler.test.ts:363:7 - error TS2353: Object literal may only specify known properties, and 'handler' does not exist in type 'ToolConfig'.

    363       handler: handleODataQuery
              ~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:367:43 - error TS2349: This expression is not callable.
      Type '{ describe(: any): any; }' has no call signatures.

    367       const mockResponse: ODataResponse = {
                                                  ~
    368   describe('Query Type Execution', () => {
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:368:12 - error TS7006: Parameter '(Missing)' implicitly has an 'any' type.

    368   describe('Query Type Execution', () => {
                   
    test/unit/handlers/odata-query.handler.test.ts:432:13 - error TS2322: Type '{ UserName: string; }' is not assignable to type 'string | number | boolean | null | undefined'.

    432           { AssignedTo: { UserName: 'john@example.com' }, Count: 8 },
                    ~~~~~~~~~~

      src/types/queries.ts:55:3
        55   [key: string]: string | number | boolean | null | undefined;
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        The expected type comes from this index signature.
    test/unit/handlers/odata-query.handler.test.ts:433:13 - error TS2322: Type '{ UserName: string; }' is not assignable to type 'string | number | boolean | null | undefined'.

    433           { AssignedTo: { UserName: 'jane@example.com' }, Count: 12 }
                    ~~~~~~~~~~

      src/types/queries.ts:55:3
        55   [key: string]: string | number | boolean | null | undefined;
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        The expected type comes from this index signature.
    test/unit/handlers/odata-query.handler.test.ts:579:32 - error TS2349: This expression is not callable.
      Type '{ name: string; description: string; schema: ZodObject<{ organization: ZodOptional<ZodString>; project: ZodOptional<ZodString>; description: ZodOptional<...>; ... 23 more ...; iterationPath: ZodOptional<...>; }, "strip", ZodTypeAny, { ...; }, { ...; }>; describe(: any): any; }' has no call signatures.

    579     const config: ToolConfig = {
                                       ~
    580       name: 'query-odata',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    ... 
    582       schema: odataQuerySchema,
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    583   describe('Query Handle Lifecycle', () => {
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:583:12 - error TS7006: Parameter '(Missing)' implicitly has an 'any' type.

    583   describe('Query Handle Lifecycle', () => {
                   
    test/unit/handlers/odata-query.handler.test.ts:591:27 - error TS2552: Cannot find name 'mockResponse'. Did you mean 'Response'?

    591         json: async () => mockResponse
                                  ~~~~~~~~~~~~

      node_modules/typescript/lib/lib.dom.d.ts:26367:13
        26367 declare var Response: {
                          ~~~~~~~~
        'Response' is declared here.
    test/unit/handlers/odata-query.handler.test.ts:699:32 - error TS2349: This expression is not callable.
      Type '{ name: string; description: string; schema: ZodObject<{ organization: ZodOptional<ZodString>; project: ZodOptional<ZodString>; description: ZodOptional<...>; ... 23 more ...; iterationPath: ZodOptional<...>; }, "strip", ZodTypeAny, { ...; }, { ...; }>; describe(: any): any; }' has no call signatures.

    699     const config: ToolConfig = {
                                       ~
    700       name: 'query-odata',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    ... 
    702       schema: odataQuerySchema,
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    703   describe('Pagination', () => {
        ~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:703:12 - error TS7006: Parameter '(Missing)' implicitly has an 'any' type.

    703   describe('Pagination', () => {
                   
    test/unit/handlers/odata-query.handler.test.ts:710:27 - error TS2552: Cannot find name 'mockResponse'. Did you mean 'Response'?

    710         json: async () => mockResponse
                                  ~~~~~~~~~~~~

      node_modules/typescript/lib/lib.dom.d.ts:26367:13
        26367 declare var Response: {
                          ~~~~~~~~
        'Response' is declared here.
    test/unit/handlers/odata-query.handler.test.ts:776:7 - error TS2353: Object literal may only specify known properties, and 'handler' does not exist in type 'ToolConfig'.

    776       handler: handleODataQuery
              ~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:780:41 - error TS2349: This expression is not callable.
      Type '{ describe(: any): any; }' has no call signatures.

    780       const cachedData: ODataResponse = {
                                                ~
    781   describe('Cache Behavior', () => {
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:781:12 - error TS7006: Parameter '(Missing)' implicitly has an 'any' type.

    781   describe('Cache Behavior', () => {
                   
    test/unit/handlers/odata-query.handler.test.ts:786:14 - error TS2304: Cannot find name 'result'.

    786       expect(result.success).toBe(true);
                     ~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:787:15 - error TS2304: Cannot find name 'result'.

    787       expect((result.data as any).results[0].Count).toBe(42);
                      ~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:826:7 - error TS2353: Object literal may only specify known properties, and 'handler' does not exist in type 'ToolConfig'.

    826       handler: handleODataQuery
              ~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:887:81 - error TS2352: Conversion of type '{ ok: true; json: () => Promise<never>; }' to type 'Response' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type '{ ok: true; json: () => Promise<never>; }' is missing the following properties from type 'Response': headers, redirected, status, statusText, and 10 more.

    887       (global.fetch as jest.MockedFunction<typeof fetch>).mockResolvedValueOnce({
                                                                                        ~
    888         ok: true,
        ~~~~~~~~~~~~~~~~~
    ... 
    891         }
        ~~~~~~~~~
    892       } as Response);
        ~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:937:58 - error TS2345: Argument of type '{ role: string; content: { type: string; text: string; }; usage: { inputTokens: number; outputTokens: number; totalTokens: number; }; }' is not assignable to parameter of type 'never'.

    937       mockSamplingClient.createMessage.mockResolvedValue({
                                                                 ~
    938         role: 'assistant',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    ... 
    940         usage: { inputTokens: 100, outputTokens: 50, totalTokens: 150 }
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    941       });
        ~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:969:58 - error TS2345: Argument of type '{ role: string; content: { type: string; text: string; }; }' is not assignable to parameter of type 'never'.

    969       mockSamplingClient.createMessage.mockResolvedValue({
                                                                 ~
    970         role: 'assistant',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    971         content: { type: 'text', text: 'Invalid query syntax' }
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    972       });
        ~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:998:32 - error TS2345: Argument of type '{ role: string; content: { type: string; text: string; }; }' is not assignable to parameter of type 'never'.

     998         .mockResolvedValueOnce({
                                        ~
     999           role: 'assistant',
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    1000           content: { type: 'text', text: 'bad query' }
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    1001         })
         ~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:1002:32 - error TS2345: Argument of type '{ role: string; content: { type: string; text: string; }; }' is not assignable to parameter of type 'never'.

    1002         .mockResolvedValueOnce({
                                        ~
    1003           role: 'assistant',
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    1004           content: { type: 'text', text: "$filter=State eq 'Active'" }
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    1005         });
         ~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:1037:32 - error TS2349: This expression is not callable.
      Type '{ name: string; description: string; schema: ZodObject<{ organization: ZodOptional<ZodString>; project: ZodOptional<ZodString>; description: ZodOptional<...>; ... 23 more ...; iterationPath: ZodOptional<...>; }, "strip", ZodTypeAny, { ...; }, { ...; }>; describe(: any): any; }' has no call signatures.

    1037     const config: ToolConfig = {
                                        ~
    1038       name: 'query-odata',
         ~~~~~~~~~~~~~~~~~~~~~~~~~~
     ... 
    1040       schema: odataQuerySchema,
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    1041   describe('Metadata Options', () => {
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:1041:12 - error TS7006: Parameter '(Missing)' implicitly has an 'any' type.

    1041   describe('Metadata Options', () => {
                    
    test/unit/handlers/odata-query.handler.test.ts:1048:27 - error TS2552: Cannot find name 'mockResponse'. Did you mean 'Response'?

    1048         json: async () => mockResponse
                                   ~~~~~~~~~~~~

      node_modules/typescript/lib/lib.dom.d.ts:26367:13
        26367 declare var Response: {
                          ~~~~~~~~
        'Response' is declared here.
    test/unit/handlers/odata-query.handler.test.ts:1109:32 - error TS2349: This expression is not callable.
      Type '{ name: string; description: string; schema: ZodObject<{ organization: ZodOptional<ZodString>; project: ZodOptional<ZodString>; description: ZodOptional<...>; ... 23 more ...; iterationPath: ZodOptional<...>; }, "strip", ZodTypeAny, { ...; }, { ...; }>; describe(: any): any; }' has no call signatures.

    1109     const config: ToolConfig = {
                                        ~
    1110       name: 'query-odata',
         ~~~~~~~~~~~~~~~~~~~~~~~~~~
     ... 
    1112       schema: odataQuerySchema,
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    1113   describe('Edge Cases', () => {
         ~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:1113:12 - error TS7006: Parameter '(Missing)' implicitly has an 'any' type.

    1113   describe('Edge Cases', () => {
                    
    test/unit/handlers/odata-query.handler.test.ts:1119:27 - error TS2552: Cannot find name 'mockResponse'. Did you mean 'Response'?

    1119         json: async () => mockResponse
                                   ~~~~~~~~~~~~

      node_modules/typescript/lib/lib.dom.d.ts:26367:13
        26367 declare var Response: {
                          ~~~~~~~~
        'Response' is declared here.
    test/unit/handlers/odata-query.handler.test.ts:1258:7 - error TS2353: Object literal may only specify known properties, and 'handler' does not exist in type 'ToolConfig'.

    1258       handler: handleODataQuery
               ~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:1262:43 - error TS2349: This expression is not callable.
      Type '{ describe(: any): any; }' has no call signatures.

    1262       const mockResponse: ODataResponse = {
                                                   ~
    1263   describe('Query Building', () => {
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:1263:12 - error TS7006: Parameter '(Missing)' implicitly has an 'any' type.

    1263   describe('Query Building', () => {
                    
    test/unit/handlers/odata-query.handler.test.ts:1339:21 - error TS2339: Property 'azureDevOps' does not exist on type 'ToolConfig'.

    1339           ...config.azureDevOps,
                             ~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:209:12 - error TS1003: Identifier expected.

    209   describe('Input Validation', () => {
                   ~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:209:30 - error TS1138: Parameter declaration expected.

    209   describe('Input Validation', () => {
                                     ~
    test/unit/handlers/odata-query.handler.test.ts:209:32 - error TS1138: Parameter declaration expected.

    209   describe('Input Validation', () => {
                                       ~
    test/unit/handlers/odata-query.handler.test.ts:209:35 - error TS1005: ';' expected.

    209   describe('Input Validation', () => {
                                          ~~
    test/unit/handlers/odata-query.handler.test.ts:240:4 - error TS1128: Declaration or statement expected.

    240   });
           ~
    test/unit/handlers/odata-query.handler.test.ts:251:12 - error TS1003: Identifier expected.

    251   describe('Area Path Filtering', () => {
                   ~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:251:33 - error TS1138: Parameter declaration expected.

    251   describe('Area Path Filtering', () => {
                                        ~
    test/unit/handlers/odata-query.handler.test.ts:251:35 - error TS1138: Parameter declaration expected.

    251   describe('Area Path Filtering', () => {
                                          ~
    test/unit/handlers/odata-query.handler.test.ts:251:38 - error TS1005: ';' expected.

    251   describe('Area Path Filtering', () => {
                                             ~~
    test/unit/handlers/odata-query.handler.test.ts:352:4 - error TS1128: Declaration or statement expected.

    352   });
           ~
    test/unit/handlers/odata-query.handler.test.ts:368:12 - error TS1003: Identifier expected.

    368   describe('Query Type Execution', () => {
                   ~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:368:34 - error TS1138: Parameter declaration expected.

    368   describe('Query Type Execution', () => {
                                         ~
    test/unit/handlers/odata-query.handler.test.ts:368:36 - error TS1138: Parameter declaration expected.

    368   describe('Query Type Execution', () => {
                                           ~
    test/unit/handlers/odata-query.handler.test.ts:368:39 - error TS1005: ';' expected.

    368   describe('Query Type Execution', () => {
                                              ~~
    test/unit/handlers/odata-query.handler.test.ts:491:4 - error TS1128: Declaration or statement expected.

    491   });
           ~
    test/unit/handlers/odata-query.handler.test.ts:583:12 - error TS1003: Identifier expected.

    583   describe('Query Handle Lifecycle', () => {
                   ~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:583:36 - error TS1138: Parameter declaration expected.

    583   describe('Query Handle Lifecycle', () => {
                                           ~
    test/unit/handlers/odata-query.handler.test.ts:583:38 - error TS1138: Parameter declaration expected.

    583   describe('Query Handle Lifecycle', () => {
                                             ~
    test/unit/handlers/odata-query.handler.test.ts:583:41 - error TS1005: ';' expected.

    583   describe('Query Handle Lifecycle', () => {
                                                ~~
    test/unit/handlers/odata-query.handler.test.ts:587:8 - error TS1005: ')' expected.

    587       };
               ~
    test/unit/handlers/odata-query.handler.test.ts:611:6 - error TS1128: Declaration or statement expected.

    611     });
             ~
    test/unit/handlers/odata-query.handler.test.ts:703:12 - error TS1003: Identifier expected.

    703   describe('Pagination', () => {
                   ~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:703:24 - error TS1138: Parameter declaration expected.

    703   describe('Pagination', () => {
                               ~
    test/unit/handlers/odata-query.handler.test.ts:703:26 - error TS1138: Parameter declaration expected.

    703   describe('Pagination', () => {
                                 ~
    test/unit/handlers/odata-query.handler.test.ts:703:29 - error TS1005: ';' expected.

    703   describe('Pagination', () => {
                                    ~~
    test/unit/handlers/odata-query.handler.test.ts:765:4 - error TS1128: Declaration or statement expected.

    765   });
           ~
    test/unit/handlers/odata-query.handler.test.ts:781:12 - error TS1003: Identifier expected.

    781   describe('Cache Behavior', () => {
                   ~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:781:28 - error TS1138: Parameter declaration expected.

    781   describe('Cache Behavior', () => {
                                   ~
    test/unit/handlers/odata-query.handler.test.ts:781:30 - error TS1138: Parameter declaration expected.

    781   describe('Cache Behavior', () => {
                                     ~
    test/unit/handlers/odata-query.handler.test.ts:781:33 - error TS1005: ';' expected.

    781   describe('Cache Behavior', () => {
                                        ~~
    test/unit/handlers/odata-query.handler.test.ts:815:4 - error TS1128: Declaration or statement expected.

    815   });
           ~
    test/unit/handlers/odata-query.handler.test.ts:1041:12 - error TS1003: Identifier expected.

    1041   describe('Metadata Options', () => {
                    ~~~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:1041:30 - error TS1138: Parameter declaration expected.

    1041   describe('Metadata Options', () => {
                                      ~
    test/unit/handlers/odata-query.handler.test.ts:1041:32 - error TS1138: Parameter declaration expected.

    1041   describe('Metadata Options', () => {
                                        ~
    test/unit/handlers/odata-query.handler.test.ts:1041:35 - error TS1005: ';' expected.

    1041   describe('Metadata Options', () => {
                                           ~~
    test/unit/handlers/odata-query.handler.test.ts:1102:4 - error TS1128: Declaration or statement expected.

    1102   });
            ~
    test/unit/handlers/odata-query.handler.test.ts:1113:12 - error TS1003: Identifier expected.

    1113   describe('Edge Cases', () => {
                    ~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:1113:24 - error TS1138: Parameter declaration expected.

    1113   describe('Edge Cases', () => {
                                ~
    test/unit/handlers/odata-query.handler.test.ts:1113:26 - error TS1138: Parameter declaration expected.

    1113   describe('Edge Cases', () => {
                                  ~
    test/unit/handlers/odata-query.handler.test.ts:1113:29 - error TS1005: ';' expected.

    1113   describe('Edge Cases', () => {
                                     ~~
    test/unit/handlers/odata-query.handler.test.ts:1247:4 - error TS1128: Declaration or statement expected.

    1247   });
            ~
    test/unit/handlers/odata-query.handler.test.ts:1263:12 - error TS1003: Identifier expected.

    1263   describe('Query Building', () => {
                    ~~~~~~~~~~~~~~~~
    test/unit/handlers/odata-query.handler.test.ts:1263:28 - error TS1138: Parameter declaration expected.

    1263   describe('Query Building', () => {
                                    ~
    test/unit/handlers/odata-query.handler.test.ts:1263:30 - error TS1138: Parameter declaration expected.

    1263   describe('Query Building', () => {
                                      ~
    test/unit/handlers/odata-query.handler.test.ts:1263:33 - error TS1005: ';' expected.

    1263   describe('Query Building', () => {
                                         ~~
    test/unit/handlers/odata-query.handler.test.ts:1370:4 - error TS1128: Declaration or statement expected.

    1370   });
            ~
    test/unit/handlers/odata-query.handler.test.ts:1372:1 - error TS1005: '}' expected.

    1372 
         

      test/unit/handlers/odata-query.handler.test.ts:836:36
        836   describe('Error Handling', () => {
                                               ~
        The parser expected to find a '}' to match the '{' token here.

FAIL test/unit/handlers/export-work-items.handler.test.ts
  Î“Ã¹Ã… Test suite failed to run

    test/unit/handlers/export-work-items.handler.test.ts:82:85 - error TS2345: Argument of type '"test-token"' is not assignable to parameter of type 'never'.

    82     mockGetTokenProvider.mockReturnValue((jest.fn() as jest.Mock).mockResolvedValue('test-token'));
                                                                                           ~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:224:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    224         new Error('EACCES: permission denied, open \'/root/protected/export.csv\'')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:250:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    250         new Error('ENOSPC: no space left on device')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:276:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    276         new Error('ENOENT: no such file or directory')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:302:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    302         new Error('EROFS: read-only file system')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:334:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    334         new Error('Worksheet name exceeds 31 character limit')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:361:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    361         new Error('Excel row limit (1,048,576) exceeded')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:386:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    386         new Error('Failed to create workbook: Internal library error')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:413:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    413         new Error('Request timeout after 30000ms while fetching work items')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:438:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    438         new Error('HTTP 429: Too Many Requests. Rate limit exceeded.')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:464:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    464         new Error('Work item 999 not found or access denied')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:493:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    493         new Error('JavaScript heap out of memory')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:519:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    519         new Error('Stream write error: Connection closed')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:547:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    547         new Error('Field "NonExistent.Field" not found in work item type definition')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:574:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    574         new Error('Circular relationship detected at depth 3')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:600:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    600         new Error('Comments API unavailable or access denied')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:627:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    627         new Error('History API timeout after fetching 30 revisions')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:661:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    661         new Error('Missing required configuration: organization')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/export-work-items.handler.test.ts:693:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    693         new Error('Missing required configuration: project')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

FAIL test/unit/handlers/create-new-item.handler.test.ts
  Î“Ã¹Ã… Test suite failed to run

    test/unit/handlers/create-new-item.handler.test.ts:103:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    103         new Error('Template "non-existent-template" not found')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:122:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    122         new Error('Invalid template syntax at line 5')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:141:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    141         new Error('Missing required variable: {projectName}')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:209:44 - error TS2345: Argument of type '{ id: number; title: string; state: string; type: string; parent_linked: boolean; }' is not assignable to parameter of type 'never'.

    209       mockCreateWorkItem.mockResolvedValue({
                                                   ~
    210         id: 123,
        ~~~~~~~~~~~~~~~~
    ... 
    214         parent_linked: false
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    215       });
        ~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:233:44 - error TS2345: Argument of type '{ id: number; title: string; state: string; type: string; parent_linked: boolean; }' is not assignable to parameter of type 'never'.

    233       mockCreateWorkItem.mockResolvedValue({
                                                   ~
    234         id: 124,
        ~~~~~~~~~~~~~~~~
    ... 
    238         parent_linked: false
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    239       });
        ~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:316:44 - error TS2345: Argument of type '{ id: number; title: string; state: string; type: string; parent_linked: boolean; }' is not assignable to parameter of type 'never'.

    316       mockCreateWorkItem.mockResolvedValue({
                                                   ~
    317         id: 125,
        ~~~~~~~~~~~~~~~~
    ... 
    321         parent_linked: false
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    322       });
        ~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:342:44 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    342       mockCreateWorkItem.mockRejectedValue(new Error('TF400898: An Internal Error Occurred'));
                                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:361:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    361         new Error('Parent work item 999999 not found')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:381:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    381         new Error('Cannot create parent-child link between Task and Bug')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:399:44 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    399       mockCreateWorkItem.mockRejectedValue(new Error('HTTP 401: Unauthorized'));
                                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:417:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    417         new Error('TF400813: The user does not have permissions')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:435:44 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    435       mockCreateWorkItem.mockRejectedValue(new Error('Request timeout after 30000ms'));
                                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:510:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    510         new Error('Title cannot be empty')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    test/unit/handlers/create-new-item.handler.test.ts:528:9 - error TS2345: Argument of type 'Error' is not assignable to parameter of type 'never'.

    528         new Error('Title cannot contain only whitespace')
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

FAIL test/unit/generate-wiql-query-handle.test.ts
  Î“Ã¹Ã… Test suite failed to run

    test/unit/generate-wiql-query-handle.test.ts:146:77 - error TS2345: Argument of type '{ content: { type: string; text: string; }[]; usage: { inputTokens: number; outputTokens: number; }; }' is not assignable to parameter of type 'never'.

    146       (mockSamplingClient.createMessage as jest.Mock).mockResolvedValueOnce({
                                                                                    ~
    147         content: [{ type: 'text', text: 'SELECT [System.Id], [System.Title] FROM WorkItems WHERE [System.State] = \'Active\'' }],
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    148         usage: { inputTokens: 100, outputTokens: 50 }
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    149       });
        ~~~~~~~
    test/unit/generate-wiql-query-handle.test.ts:185:77 - error TS2345: Argument of type '{ content: { type: string; text: string; }[]; usage: { inputTokens: number; outputTokens: number; }; }' is not assignable to parameter of type 'never'.

    185       (mockSamplingClient.createMessage as jest.Mock).mockResolvedValueOnce({
                                                                                    ~
    186         content: [{ type: 'text', text: 'SELECT [System.Id] FROM WorkItems WHERE [System.State] = \'Active\'' }],
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    187         usage: { inputTokens: 100, outputTokens: 50 }
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    188       });
        ~~~~~~~
    test/unit/generate-wiql-query-handle.test.ts:278:77 - error TS2345: Argument of type '{ content: { type: string; text: string; }[]; usage: { inputTokens: number; outputTokens: number; }; }' is not assignable to parameter of type 'never'.

    278       (mockSamplingClient.createMessage as jest.Mock).mockResolvedValueOnce({
                                                                                    ~
    279         content: [{ type: 'text', text: 'SELECT [System.Id] FROM WorkItems WHERE [System.State] = \'NonExistent\'' }],
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    280         usage: { inputTokens: 100, outputTokens: 50 }
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    281       });
        ~~~~~~~
    test/unit/generate-wiql-query-handle.test.ts:326:77 - error TS2345: Argument of type '{ content: { type: string; text: string; }[]; usage: { inputTokens: number; outputTokens: number; }; }' is not assignable to parameter of type 'never'.

    326       (mockSamplingClient.createMessage as jest.Mock).mockResolvedValueOnce({
                                                                                    ~
    327         content: [{ type: 'text', text: 'SELECT [System.Id] FROM WorkItems WHERE [System.State] = \'Active\'' }],
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    328         usage: { inputTokens: 100, outputTokens: 50 }
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    329       });
        ~~~~~~~
    test/unit/generate-wiql-query-handle.test.ts:398:77 - error TS2345: Argument of type '{ content: { type: string; text: string; }[]; usage: { inputTokens: number; outputTokens: number; }; }' is not assignable to parameter of type 'never'.

    398       (mockSamplingClient.createMessage as jest.Mock).mockResolvedValueOnce({
                                                                                    ~
    399         content: [{ type: 'text', text: 'SELECT [System.Id] FROM WorkItems WHERE [System.State] = \'Active\'' }],
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    400         usage: { inputTokens: 100, outputTokens: 50 }
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    401       });
        ~~~~~~~
    test/unit/generate-wiql-query-handle.test.ts:440:77 - error TS2345: Argument of type '{ content: { type: string; text: string; }[]; usage: { inputTokens: number; outputTokens: number; }; }' is not assignable to parameter of type 'never'.

    440       (mockSamplingClient.createMessage as jest.Mock).mockResolvedValueOnce({
                                                                                    ~
    441         content: [{ type: 'text', text: 'SELECT [System.Id] FROM WorkItems WHERE [System.State] = \'Active\'' }],
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    442         usage: { inputTokens: 100, outputTokens: 50 }
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    443       });
        ~~~~~~~
    test/unit/generate-wiql-query-handle.test.ts:510:77 - error TS2345: Argument of type '{ role: string; content: { type: string; text: string; }[]; }' is not assignable to parameter of type 'never'.

    510       (mockSamplingClient.createMessage as jest.Mock).mockResolvedValueOnce({
                                                                                    ~
    511         role: 'assistant',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~
    ... 
    515         }]
        ~~~~~~~~~~
    516       });
        ~~~~~~~

FAIL test/e2e/workflow-tests.test.ts
  Î“Ã¹Ã… Test suite failed to run

    src/services/handlers/query/wiql-query.handler.ts:211:9 - error TS2322: Type '{ workItems: WiqlWorkItemResult[]; count: number; query: string; totalCount: number; skip: number; top: number; hasMore: boolean; }' is not assignable to type '{ workItems: ADOWorkItem[]; count: number; query: string; totalCount: number; skip: number; top: number; hasMore: boolean; }'.
      Types of property 'workItems' are incompatible.
        Type 'WiqlWorkItemResult[]' is not assignable to type 'ADOWorkItem[]'.
          Type 'WiqlWorkItemResult' is missing the following properties from type 'ADOWorkItem': rev, fields

    211         result = await queryWorkItemsByWiql(queryArgs);
                ~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:316:30 - error TS2339: Property 'additionalFields' does not exist on type 'ADOWorkItem'.

    316         const tagsValue = wi.additionalFields?.['System.Tags'];
                                     ~~~~~~~~~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:320:21 - error TS2339: Property 'title' does not exist on type 'ADOWorkItem'.

    320           title: wi.title,
                            ~~~~~
    src/services/handlers/query/wiql-query.handler.ts:321:21 - error TS2339: Property 'state' does not exist on type 'ADOWorkItem'.

    321           state: wi.state,
                            ~~~~~
    src/services/handlers/query/wiql-query.handler.ts:322:20 - error TS2339: Property 'type' does not exist on type 'ADOWorkItem'.

    322           type: wi.type,
                           ~~~~
    src/services/handlers/query/wiql-query.handler.ts:323:27 - error TS2339: Property 'createdDate' does not exist on type 'ADOWorkItem'.

    323           createdDate: wi.createdDate,
                                  ~~~~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:324:26 - error TS2339: Property 'assignedTo' does not exist on type 'ADOWorkItem'.

    324           assignedTo: wi.assignedTo,
                                 ~~~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:325:24 - error TS2339: Property 'areaPath' does not exist on type 'ADOWorkItem'.

    325           areaPath: wi.areaPath,
                               ~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:326:29 - error TS2339: Property 'iterationPath' does not exist on type 'ADOWorkItem'.

    326           iterationPath: wi.iterationPath,
                                    ~~~~~~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:327:27 - error TS2339: Property 'changedDate' does not exist on type 'ADOWorkItem'.

    327           changedDate: wi.changedDate,
                                  ~~~~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:329:18 - error TS2339: Property 'lastSubstantiveChangeDate' does not exist on type 'ADOWorkItem'.

    329           ...(wi.lastSubstantiveChangeDate && { lastSubstantiveChangeDate: wi.lastSubstantiveChangeDate }),
                         ~~~~~~~~~~~~~~~~~~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:329:79 - error TS2339: Property 'lastSubstantiveChangeDate' does not exist on type 'ADOWorkItem'.

    329           ...(wi.lastSubstantiveChangeDate && { lastSubstantiveChangeDate: wi.lastSubstantiveChangeDate }),
                                                                                      ~~~~~~~~~~~~~~~~~~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:330:18 - error TS2339: Property 'daysInactive' does not exist on type 'ADOWorkItem'.

    330           ...(wi.daysInactive !== undefined && { daysInactive: wi.daysInactive }),
                         ~~~~~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:330:67 - error TS2339: Property 'daysInactive' does not exist on type 'ADOWorkItem'.

    330           ...(wi.daysInactive !== undefined && { daysInactive: wi.daysInactive }),
                                                                          ~~~~~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:331:18 - error TS2339: Property 'additionalFields' does not exist on type 'ADOWorkItem'.

    331           ...(wi.additionalFields && wi.additionalFields)
                         ~~~~~~~~~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:331:41 - error TS2339: Property 'additionalFields' does not exist on type 'ADOWorkItem'.

    331           ...(wi.additionalFields && wi.additionalFields)
                                                ~~~~~~~~~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:340:58 - error TS2339: Property 'lastSubstantiveChangeDate' does not exist on type 'ADOWorkItem'.

    340         successCount: result.workItems.filter((wi) => wi.lastSubstantiveChangeDate !== undefined).length,
                                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~
    src/services/handlers/query/wiql-query.handler.ts:341:84 - error TS2339: Property 'lastSubstantiveChangeDate' does not exist on type 'ADOWorkItem'.

    341         failureCount: result.workItems.length - result.workItems.filter((wi) => wi.lastSubstantiveChangeDate !== undefined).length
                                                                                           ~~~~~~~~~~~~~~~~~~~~~~~~~

FAIL test/unit/hybridTransport.test.ts (37.152 s)
  Î“Ã¹Ã… HybridStdioServerTransport Î“Ã‡â•‘ Message Receiving - Newline Framing Î“Ã‡â•‘ should ignore empty lines in newline-delimited mode

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 0
    Received array:  []

      344 |       await new Promise(resolve => setTimeout(resolve, 50));
      345 |       
    > 346 |       expect(messages).toHaveLength(1);
          |                        ^
      347 |       expect(messages[0]).toEqual(message);
      348 |     });
      349 |     

      at Object.<anonymous> (test/unit/hybridTransport.test.ts:346:24)

  Î“Ã¹Ã… HybridStdioServerTransport Î“Ã‡â•‘ Error Handling Î“Ã‡â•‘ should trigger onerror callback for invalid JSON in message body

    thrown: "Exceeded timeout of 30000 ms for a test while waiting for `done()` to be called.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

      366 |     });
      367 |     
    > 368 |     it('should trigger onerror callback for invalid JSON in message body', (done) => {
          |       ^
      369 |       const invalidJson = 'Content-Length: 10\r\n\r\n{invalid}';
      370 |       
      371 |       transport.onerror = (err) => {

      at test/unit/hybridTransport.test.ts:368:7
      at test/unit/hybridTransport.test.ts:363:11
      at Object.<anonymous> (test/unit/hybridTransport.test.ts:14:9)

  Î“Ã¹Ã… HybridStdioServerTransport Î“Ã‡â•‘ Error Handling Î“Ã‡â•‘ should not crash on data processing errors

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 1
    Received:    0

      447 |       await new Promise(resolve => setTimeout(resolve, 50));
      448 |       // Should have received the valid message despite earlier errors
    > 449 |       expect(messages.length).toBeGreaterThanOrEqual(1);
          |                               ^
      450 |     });
      451 |   });
      452 |   

      at Object.<anonymous> (test/unit/hybridTransport.test.ts:449:31)

  Î“Ã¹Ã… HybridStdioServerTransport Î“Ã‡â•‘ Connection Lifecycle Î“Ã‡â•‘ should handle start -> send -> receive -> close lifecycle

    expect(received).toContain(expected) // indexOf

    Expected value: {"id": 1, "jsonrpc": "2.0", "result": {"initialized": true}}
    Received array: [{"id": 1, "jsonrpc": "2.0", "result": {"initialized": true}}]

    Looks like you wanted to test for object/array equality with the stricter `toContain` matcher. You probably need to use `toContainEqual` instead.

      500 |       // Verify lifecycle
      501 |       expect(sentMessages.length).toBeGreaterThan(0);
    > 502 |       expect(receivedMessages).toContain(incomingMessage);
          |                                ^
      503 |       expect(closeCalled).toBe(true);
      504 |     });
      505 |     

      at Object.<anonymous> (test/unit/hybridTransport.test.ts:502:32)

FAIL test/unit/bulk-preview-limits.test.ts (45.539 s)
  Î“Ã¹Ã… Bulk Operation Preview Limits Î“Ã‡â•‘ should respect maxPreviewItems in dry-run mode for comment action

    TypeError: (0 , logger_js_1.errorToContext) is not a function

      239 |
      240 |   } catch (error) {
    > 241 |     logger.error("Unified bulk operations error:", errorToContext(error));
          |                                                                  ^
      242 |     return {
      243 |       success: false,
      244 |       data: null,

      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:66)
      at Object.<anonymous> (test/unit/bulk-preview-limits.test.ts:85:53)

  Î“Ã¹Ã… Bulk Operation Preview Limits Î“Ã‡â•‘ should respect maxPreviewItems in dry-run mode for update action

    TypeError: (0 , logger_js_1.errorToContext) is not a function

      239 |
      240 |   } catch (error) {
    > 241 |     logger.error("Unified bulk operations error:", errorToContext(error));
          |                                                                  ^
      242 |     return {
      243 |       success: false,
      244 |       data: null,

      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:66)
      at Object.<anonymous> (test/unit/bulk-preview-limits.test.ts:110:53)

  Î“Ã¹Ã… Bulk Operation Preview Limits Î“Ã‡â•‘ should respect maxPreviewItems in dry-run mode for assign action

    TypeError: (0 , logger_js_1.errorToContext) is not a function

      239 |
      240 |   } catch (error) {
    > 241 |     logger.error("Unified bulk operations error:", errorToContext(error));
          |                                                                  ^
      242 |     return {
      243 |       success: false,
      244 |       data: null,

      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:66)
      at Object.<anonymous> (test/unit/bulk-preview-limits.test.ts:132:53)

  Î“Ã¹Ã… Bulk Operation Preview Limits Î“Ã‡â•‘ should respect maxPreviewItems in dry-run mode for multiple actions

    TypeError: (0 , logger_js_1.errorToContext) is not a function

      239 |
      240 |   } catch (error) {
    > 241 |     logger.error("Unified bulk operations error:", errorToContext(error));
          |                                                                  ^
      242 |     return {
      243 |       success: false,
      244 |       data: null,

      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:66)
      at Object.<anonymous> (test/unit/bulk-preview-limits.test.ts:158:53)

  Î“Ã¹Ã… Bulk Operation Preview Limits Î“Ã‡â•‘ should use default maxPreviewItems when not specified

    TypeError: (0 , logger_js_1.errorToContext) is not a function

      239 |
      240 |   } catch (error) {
    > 241 |     logger.error("Unified bulk operations error:", errorToContext(error));
          |                                                                  ^
      242 |     return {
      243 |       success: false,
      244 |       data: null,

      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:66)
      at Object.<anonymous> (test/unit/bulk-preview-limits.test.ts:181:53)

  Î“Ã¹Ã… Bulk Operation Preview Limits Î“Ã‡â•‘ should handle maxPreviewItems larger than item count

    TypeError: (0 , logger_js_1.errorToContext) is not a function

      239 |
      240 |   } catch (error) {
    > 241 |     logger.error("Unified bulk operations error:", errorToContext(error));
          |                                                                  ^
      242 |     return {
      243 |       success: false,
      244 |       data: null,

      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:66)
      at Object.<anonymous> (test/unit/bulk-preview-limits.test.ts:203:53)

FAIL test/integration/bulk-operations-integration.test.ts (50.045 s)
  Î“Ã¹Ã… Bulk Operations Integration Î“Ã‡â•‘ should execute comment action in dry-run mode

    TypeError: (0 , logger_js_1.errorToContext) is not a function

      239 |
      240 |   } catch (error) {
    > 241 |     logger.error("Unified bulk operations error:", errorToContext(error));
          |                                                                  ^
      242 |     return {
      243 |       success: false,
      244 |       data: null,

      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:66)
      at Object.<anonymous> (test/integration/bulk-operations-integration.test.ts:110:53)

  Î“Ã¹Ã… Bulk Operations Integration Î“Ã‡â•‘ should execute update action in dry-run mode

    TypeError: (0 , logger_js_1.errorToContext) is not a function

      239 |
      240 |   } catch (error) {
    > 241 |     logger.error("Unified bulk operations error:", errorToContext(error));
          |                                                                  ^
      242 |     return {
      243 |       success: false,
      244 |       data: null,

      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:66)
      at Object.<anonymous> (test/integration/bulk-operations-integration.test.ts:134:53)

  Î“Ã¹Ã… Bulk Operations Integration Î“Ã‡â•‘ should execute multiple actions in sequence (dry-run)

    TypeError: (0 , logger_js_1.errorToContext) is not a function

      239 |
      240 |   } catch (error) {
    > 241 |     logger.error("Unified bulk operations error:", errorToContext(error));
          |                                                                  ^
      242 |     return {
      243 |       success: false,
      244 |       data: null,

      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:66)
      at Object.<anonymous> (test/integration/bulk-operations-integration.test.ts:165:53)

  Î“Ã¹Ã… Bulk Operations Integration Î“Ã‡â•‘ should support item selector with indices

    TypeError: (0 , logger_js_1.errorToContext) is not a function

      239 |
      240 |   } catch (error) {
    > 241 |     logger.error("Unified bulk operations error:", errorToContext(error));
          |                                                                  ^
      242 |     return {
      243 |       success: false,
      244 |       data: null,

      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:66)
      at Object.<anonymous> (test/integration/bulk-operations-integration.test.ts:208:53)

  Î“Ã¹Ã… Bulk Operations Integration Î“Ã‡â•‘ should handle stopOnError parameter

    TypeError: (0 , logger_js_1.errorToContext) is not a function

      239 |
      240 |   } catch (error) {
    > 241 |     logger.error("Unified bulk operations error:", errorToContext(error));
          |                                                                  ^
      242 |     return {
      243 |       success: false,
      244 |       data: null,

      at handleUnifiedBulkOperations (src/services/handlers/bulk-operations/unified-bulk-operations.handler.ts:241:66)
      at Object.<anonymous> (test/integration/bulk-operations-integration.test.ts:235:53)


Test Suites: 11 failed, 47 passed, 58 total
Tests:       35 failed, 822 passed, 857 total
Snapshots:   0 total
Time:        93.168 s
Ran all test suites.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
