
> enhanced-ado-mcp-server@2.1.0 pretest
> npm run generate-openapi


> enhanced-ado-mcp-server@2.1.0 generate-openapi
> tsx scripts/generate-openapi.ts

≡ƒÜÇ Generating OpenAPI specification...

≡ƒôü Creating output directory: C:\Users\ameliapayne\ADO-Work-Item-MSP\docs\api
≡ƒô¥ Generating OpenAPI 3.0 specification...
Γ£ô Generated OpenAPI spec: C:\Users\ameliapayne\ADO-Work-Item-MSP\docs\api\openapi.json

≡ƒôª Generating individual JSON schemas...
Γ£ô Generated schema: create-workitem.json
Γ£ô Generated schema: assign-copilot.json
Γ£ô Generated schema: get-context.json
Γ£ô Generated schema: extract-security-links.json
Γ£ô Generated schema: query-wiql.json
Γ£ô Generated schema: query-odata.json
Γ£ô Generated schema: execute-bulk-operations.json
Γ£ô Generated schema: link-workitems.json
Γ£ô Generated schema: undo-bulk.json
Γ£ô Generated schema: undo-forensic.json
Γ£ô Generated schema: export-work-items.json
Γ£ô Generated schema: analyze-workload.json
Γ£ô Generated schema: discover-tools.json
Γ£ô Generated schema: analyze-query-handle.json
Γ£ô Generated schema: analyze-bulk.json
Γ£ô Generated schema: list-handles.json
Γ£ô Generated schema: inspect-handle.json
Γ£ô Generated schema: get-context-bulk.json
Γ£ô Generated schema: get-config.json
Γ£ô Generated schema: get-team-members.json
Γ£ô Generated schema: get-prompts.json
Γ£ô Generated schema: list-agents.json
Γ£ô Generated schema: discover-custom-fields.json
Γ£ô Generated schema: export-field-schema.json
Γ£ô Generated schema: get-pr-diff.json
Γ£ô Generated schema: get-pr-comments.json
Γ£ô Generated schema: add-pr-comment.json
Γ£ô Generated schema index: index.json (27 schemas)

Γ£à OpenAPI generation complete!

Generated files:
  - docs/api/openapi.json (27 endpoints)
  - docs/api/schemas/*.json (27 schemas)

Output directory: C:\Users\ameliapayne\ADO-Work-Item-MSP\docs\api

You can now use these files to:
  - Generate API clients
  - Create API documentation
  - Validate requests/responses
  - Import into tools like Swagger UI, Postman, etc.

> enhanced-ado-mcp-server@2.1.0 test
> jest test/unit/handlers/get-work-item-context-package.handler.test.ts

FAIL test/unit/handlers/get-work-item-context-package.handler.test.ts
  Get Work Item Context Package Handler - Error Scenarios
    Input Validation Errors
      ΓêÜ should handle missing workItemId parameter (5 ms)
      ΓêÜ should handle invalid workItemId (negative number) (1 ms)
      ΓêÜ should handle invalid workItemId (zero) (1 ms)
      ΓêÜ should handle non-existent workItemId (1 ms)
    Network and API Errors
      ΓêÜ should handle network timeout errors (1 ms)
      ΓêÜ should handle connection refused errors (1 ms)
      ΓêÜ should handle DNS resolution errors
      ΓêÜ should handle HTTP 500 internal server errors (1 ms)
      ΓêÜ should handle HTTP 401 unauthorized errors
      ΓêÜ should handle HTTP 403 forbidden errors
    Malformed API Response Errors
      ├ù should handle missing fields in API response (1 ms)
      ΓêÜ should handle null/undefined in nested API response (1 ms)
      ΓêÜ should handle invalid JSON in API response
    Optional Feature Errors
      ΓêÜ should handle comments fetch failure gracefully (1 ms)
      ΓêÜ should handle history fetch failure gracefully
      ├ù should handle children fetch failure gracefully (1 ms)
      ├ù should handle relations with invalid URLs (1 ms)
    Configuration Errors
      ΓêÜ should handle missing organization in config (1 ms)
      ΓêÜ should handle missing project in config

  ΓùÅ Get Work Item Context Package Handler - Error Scenarios ΓÇ║ Malformed API Response Errors ΓÇ║ should handle missing fields in API response

    expect(jest.fn()).toHaveBeenCalled()

    Expected number of calls: >= 1
    Received number of calls:    0

      291 |       const result = await handleGetWorkItemContextPackage(args);
      292 |
    > 293 |       expect(mockLogger.warn).toHaveBeenCalled();
          |                               ^
      294 |     });
      295 |
      296 |     it('should handle null/undefined in nested API response', async () => {

      at Object.<anonymous> (test/unit/handlers/get-work-item-context-package.handler.test.ts:293:31)

  ΓùÅ Get Work Item Context Package Handler - Error Scenarios ΓÇ║ Optional Feature Errors ΓÇ║ should handle children fetch failure gracefully

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

      423 |       const result = await handleGetWorkItemContextPackage(args);
      424 |
    > 425 |       expect(result.warnings?.length).toBeGreaterThan(0);
          |                                       ^
      426 |     });
      427 |
      428 |     it('should handle relations with invalid URLs', async () => {

      at Object.<anonymous> (test/unit/handlers/get-work-item-context-package.handler.test.ts:425:39)

  ΓùÅ Get Work Item Context Package Handler - Error Scenarios ΓÇ║ Optional Feature Errors ΓÇ║ should handle relations with invalid URLs

    expect(jest.fn()).toHaveBeenCalled()

    Expected number of calls: >= 1
    Received number of calls:    0

      446 |       const result = await handleGetWorkItemContextPackage(args);
      447 |
    > 448 |       expect(mockLogger.warn).toHaveBeenCalled();
          |                               ^
      449 |     });
      450 |   });
      451 |

      at Object.<anonymous> (test/unit/handlers/get-work-item-context-package.handler.test.ts:448:31)

Test Suites: 1 failed, 1 total
Tests:       3 failed, 16 passed, 19 total
Snapshots:   0 total
Time:        3.907 s, estimated 4 s
Ran all test suites matching /test\\unit\\handlers\\get-work-item-context-package.handler.test.ts/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
